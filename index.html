<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
    <title>utm web manager demo</title>
    <script type="text/javascript" src="js/yui-min.js"></script>
    <script type="text/javascript" src="js/combo_1.js"></script>
    <script type="text/javascript" src="js/combo_2.js"></script>
    <script type="text/javascript" src="js/combo_3.js"></script>
    <link rel="stylesheet" href="css/cssreset-min.css" />
    <link rel="stylesheet" href="css/widget-base.css" />
    <link rel="stylesheet" href="css/widget-stack-skin.css" />
    <link rel="stylesheet" href="css/widget-stack.css" />
    <link rel="stylesheet" href="css/widget-stack-core.css" />
<!-- jquery -->

    <script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.8.23.custom.min.js"></script>
    <script type="text/javascript" src="js/jquery.ui.core.js"></script>
    <script type="text/javascript" src="js/jquery.ui.widget.js"></script>
    <script type="text/javascript" src="js/jquery.ui.tabs.js"></script>
    <script type="text/javascript" src="js/jquery.ui.datepicker.js"></script>
    <script type="text/javascript" src="js/jquery.ui.accordion.js"></script>
    <script type="text/javascript" src="js/jquery.ui.button.js"></script>
    <script type="text/javascript" src="js/jquery.ui.mouse.js"></script>
    <script type="text/javascript" src="js/jquery.ui.position.js"></script>
    <script type="text/javascript" src="js/jquery.ui.draggable.js"></script>
    <script type="text/javascript" src="js/jquery.ui.resizable.js"></script>
    <script type="text/javascript" src="js/jquery.ui.dialog.js"></script>
    <script type="text/javascript" src="js/jquery.ui.autocomplete.js"></script>

    <script type="text/javascript" src="js/jquery.effects.core.js"></script>
    <script type="text/javascript" src="js/jquery.effects.blind.js"></script>
    <script type="text/javascript" src="js/jquery.effects.bounce.js"></script>
    <script type="text/javascript" src="js/jquery.effects.clip.js"></script>
    <script type="text/javascript" src="js/jquery.effects.drop.js"></script>
    <script type="text/javascript" src="js/jquery.effects.explode.js"></script>
    <script type="text/javascript" src="js/jquery.effects.fold.js"></script>
    <script type="text/javascript" src="js/jquery.effects.highlight.js"></script>
    <script type="text/javascript" src="js/jquery.effects.pulsate.js"></script>
    <script type="text/javascript" src="js/jquery.effects.scale.js"></script>
    <script type="text/javascript" src="js/jquery.effects.shake.js"></script>
    <script type="text/javascript" src="js/jquery.effects.slide.js"></script>

<!-- plugin -->
    <script type="text/javascript" src="js/jquery-ui.js"></script>
    <script type="text/javascript" src="js/jquery.validate.js"></script>
    <script type="text/javascript" src="js/jquery.tmpl.min.js"></script>
    <script type="text/javascript" src="js/jquery.tooltip.js"></script>

<!-- style -->
    <link rel="stylesheet" href="css/demos.css" /> 
    <link rel="stylesheet" href="css/jquery.ui.all.css" />
    <link rel="stylesheet" href="css/jquery-ui.css" /> 
    <link rel="stylesheet" href="css/jquery-ui-1.8.23.custom.css" />
    <link rel="stylesheet" href="css/jquery.ui.accordion.css" />
    <link rel="stylesheet" href="css/jquery.ui.autocomplete.css" />
    <link rel="stylesheet" href="css/jquery.ui.base.css" />
    <link rel="stylesheet" href="css/jquery.ui.button.css" />
    <link rel="stylesheet" href="css/jquery.ui.core.css" />
    <link rel="stylesheet" href="css/jquery.ui.datepicker.css" />
    <link rel="stylesheet" href="css/jquery.ui.dialog.css" />
    <link rel="stylesheet" href="css/jquery.ui.progressbar.css" />
    <link rel="stylesheet" href="css/jquery.ui.resizable.css" />
    <link rel="stylesheet" href="css/jquery.ui.selectable.css" />
    <link rel="stylesheet" href="css/jquery.ui.slider.css" />
    <link rel="stylesheet" href="css/jquery.ui.tabs.css" />
    <link rel="stylesheet" href="css/jquery.ui.theme.css" />
    <link rel="stylesheet" href="css/jquery.tooltip.css" />

<style>
html {
    background: url('css/images/bg_main.jpg');
}
#layout {
    position: relative;
    margin: 0 auto; /* center in viewport */
    width: 1024px; /* fix page width */
    height: 768px;
    letter-spacing: 0;
    word-spacing: 0;
}
/* arbitrary content styling */
/* header */
#hd {
    position: absolute;
    width: 1024px;
    height: 115px;
}

#hd_header {
    width: 1024px;
    height: 92px;
    background: url('css/images/header.jpg') top left no-repeat;
}

#hd_navigator {
    position: relative;
    width: 1024px;
    height: 23px;
    margin: 0;
    padding: 0;
    background: url('css/images/status_bar.jpg');
}

#hd_navigator h4 {
    color: white;
    padding: 0;
    letter-spacing: 0;
    word-spacing: 0;
    border: none;
    margin: 4px 0;
}

#hd_navigator a {
    color: white;
}

#hd_timer {
    position: absolute;
    left: 10px;
}

#hd_user {
    position: absolute;
    left: 550px;
}

#hd_ip {
    position: absolute;
    left: 710px;
}

#hd_manual {
    position: absolute;
    left: 875px;
}

#hd_logout {
    position: absolute;
    left: 975px;
}

/* content */
#bd {
    position: absolute;
    top: 115px;    
}

#menu {
    position: absolute;
    width: 199px;
    height: 653px;
    padding: 0;
    background: url('css/images/bg_menu.jpg');
}

#main {
    position: absolute;
    left: 221px;
    width: 803px;
    height: 653px;
}

#nav {
    width: 803px;
    height: 39px;
    margin: 0;
    padding: 0;
    background: url('css/images/Tab_bar.jpg') top left no-repeat;
}

#board {
    position: relative;
    width: 803px;
    height: 589px;
    background: url('css/images/bg_content.jpg');
    margin: 0;
    padding: 0;
    border: none;
    z-index: 9;
}

/* footer */
#ft {
    position: absolute;
}
#ft div {
    letter-spacing: normal;
    text-align: center;
}

/* nomalize */
ul { list-style-type: none; }
ul { margin: 0; padding: 0; }
ul li { margin: 0; padding: 0}
a:link { text-decoration: none;}

/* login */

#form-login {
    width: 361px;
    height: 229px;
    margin: 100px auto;
    background: url('css/images/cookie_01.png') top left no-repeat;
    font-size: 120%;
    letter-spacing: normal;
    word-spacing: normal;
    padding: 40px 0 0 60px;
}

#loginDiv legend {
    margin: 0 0 20px 40px;
}

#loginDiv table tr {
    height: 25px;
}

#loginDiv table th {
    width: 80px;
    text-align: right;
    padding: 0 10px 0 0;
    border: none;
}

#loginDiv table td {
    text-align: left;
    padding: 0 0 0 10px;
    border: none;
}

#loginButton {
    margin: 15px 0 0 100px;
    width: 63px;
    height: 17px;
    border: none;
    background: url('css/images/login_0817_00.png') top left no-repeat;
    cursor: pointer;
}

#loginButton:hover {
    background: url('css/images/login_0817_01.png') top left no-repeat;
}

b.activeLang {
    color: white;
}
/* menu */
#menu h3, #menu h4, #menu h5 {
    position:relative;
    cursor: pointer;
}

#menu li {
    display: block;
    padding: 0;
    margin: 0;
    border: none;
}

#menu a {
    color: white;
    letter-spacing: normal;
    word-spacing: normal;
}

#menu ul {
    background: transparent;
    border: none;
    padding: 0;
    margin: 0;
}

.accordion-ul.ui-accordion-content, .accordion-ul-ul.ui-accordion-content, .accordion-ul-ul-ul.ui-accordion-content {
    width: 199px;
    background: transparent;    
    border: none;
}

.accordion-ul-li.ui-accordion-li-fix, .accordion-ul-ul-li.ui-accordion-li-fix, .accordion-ul-ul-ul-li.ui-accordion-li-fix {
    width: 199px;
    height: 100%;
    background: transparent;    
    border: none;
}

.accordion-ul-li h3.ui-state-default {
    background: url('css/images/MainMenu_0827_0_0.jpg');
    border: none;
    width: 199px;
    height: 30px;
}

.accordion-ul-li h3.ui-state-default a {
    padding: .7em 2.2em;
}

.accordion-ul-li h3.ui-state-active {
    background: url('css/images/MainMenu_0827_0_2.jpg');
    border: none;
    height: 39px;
}

.accordion-ul-li h3:hover {
    background: url('css/images/MainMenu_0827_0_1.jpg');
    border: none;
    height: 30px;
}

.accordion-ul-li h3.ui-state-active:hover {
    background: url('css/images/MainMenu_0827_0_3.jpg');
    border: none;
    height: 39px;
}

.accordion-ul-li h3.ui-state-active a {
    padding: 1.1em 2.2em;
}

.accordion-ul-ul-li h4, .accordion-ul-ul-ul-li h4.ui-state-default {
    background: url('css/images/MainMenu_0827_1_0.jpg');
    border: none;
    width: 199px;
    height: 30px;
}

.accordion-ul-ul-li h4:hover, .accordion-ul-ul-ul-li h4:hover {
    border: none;
    background: url('css/images/MainMenu_0827_1_1.jpg');
}

.accordion-ul-ul-ul-li h4.ui-state-active {
    border: none;
    background: url('css/images/MainMenu_0827_1_2.jpg');
}

.accordion-ul-ul-ul-ul-li h5 {
    background: url('css/images/MainMenu_0827_2_0.jpg');
    border: none;
    width: 199px;
    height: 30px;
}

.accordion-ul-ul-ul-ul-li h5:hover {
    border: none;
    background: url('css/images/MainMenu_0827_2_1.jpg');
}

.accordion-ul-ul-li h4 a {
    position: absolute;
    top: .8em;
    left: 2.2em;
}

.accordion-ul-ul-ul-ul-li h5 a {
    position: absolute;
    top: .8em;
    left: 3.0em;
}

.accordion-ul-ul-li h4.ui-actived {
    border: none;
    background: url('css/images/MainMenu_0827_1_2.jpg');
}

.accordion-ul-ul-ul-ul-li h5.ui-actived {
    border: none;
    background: url('css/images/MainMenu_0827_2_2.jpg');
}

/* nav */
#nav {
    padding: 0 40px;
    height: 39px;
}

#nav h3 {
    height: 39px;
    border: none;
    padding: 10px 0 0 0;
    margin: 0;
}

#nav h3 b {
    position: relative;
    color: white;
/*    font: 18px arial, sans-serif; */
    height: 39px;
    margin: 0 0 0 20px;
    padding: 0 10px;
    border: none;
}

#nav h3 b span{
    background: url('css/images/Tab_arrow.png') top left no-repeat;
    width: 19px;
    height: 39px;
    position:absolute;
    top: -10px;
    left: -19px;
}

#navSetter {
    position: absolute;
    top: 7px;
    left: 780px;
    border: none;
}

#navSetter:hover {
    cursor: pointer;
    opacity: 0.8;
}

/* template style */
.templateDiv {
    position: relative;
    width: 783px;
    height: 569px;
    padding: 5px;
    margin: 5px;
    border: none;
}

.labelDiv div{
    padding: 1px 0 1px 5px;
}

.labelDiv .tableDiv {
    padding: 5px;
}

.inlineDiv.Fixed {
    width: 350px;
    margin: 5px 0;
}

.Fixed40 {
    width: 40px;
}

.Fixed80 {
    width: 80px;
}

.Fixed100 {
    width: 100px;
}

.Fixed125 {
    width: 125px;
}

.Fixed150 {
    width: 150px;
}

.Fixed200 {
    width: 200px;
}

.Fixed250 {
    width: 250px;
}

.Fixed300 {
    width: 300px;
}

.Fixed350 {
    width: 350px;
}

.Fixed500 {
    width: 500px; 
}

.Fixed550 {
    width: 550px; 
}

.MH5 {
    margin: 0 5px;
}

.MH10 {
    margin: 0 10px;
}

.MH15 {
    margin: 0 15px;
}

.PH5 {
    padding: 0 5px;
}

.PH10 {
    padding: 0 10px;
}

.PH15 {
    padding: 0 15px;
}

.PH10-5 {
    padding: 0 5px 0 10px;
}

.Bold {
    font-weight: bold;
    font-size: 110%;
}

.Border{
    border: 1px solid gray;
}

.noneTD {
    border: none; 
}

.width200 {
    width: 200px;
}

.width100 {
    width: 100px;
}

/* progressbar */
.ui-progressbar .ui-progressbar-value { background-image: url('css/images/percentage.png'); } 

.progressDiv {
    position: relative;
    margin: 0 0 1px 0;
}

.progressDiv .ui-progressbar-value {
    position: absolute;
    left: 0;
}

.progressMsg {
    z-index: 99;
    position: absolute;
    left: 40%;
}
/* accordion */
.accordions {
    width: 750px;
    display: -moz-inline-stack ; 
    display:inline-block ; 
    *display:inline ; 
    zoom:1 ; 
    vertical-align:top 
}

.accordions.Halfs {
    width: 370px;
}

.accordions.Trios {
    width: 250px;
}

.Link {
    position: absolute;
    right: 2em;
    top: 50%;
    margin-top: -8px;
}

.Link:hover {
    opacity: 0.6;
}

.Close {
    position: absolute;
    right: .5em;
    top: 50%;
    margin-top: -8px;
}

.Close:hover {
    opacity: 0.6;
}
/* table */
table {
    margin: 0;
    padding: 0;
    width: 100%;
}

table caption {
    font-weight: bold;
    font-size: 105%;
}

table tr {
    height: 30px;
}

table th {
    white-space: nowrap;
}

table thead th {
    padding: 1px 3px;
    text-align: center;
} 

table tbody td {
    padding: 1px;
    text-align: center;
}

table tbody tr.odd {
    background-color: white;
}

table tbody tr.even {
    background-color: Snow;
}

table tr th.alignLeft {
    text-align: left;
}

table tr th.alignCenter {
    text-align: center;
}

table tr th.alignRight {
    text-align: right;
}

table tr td.alignLeft {
    text-align: left;
}

table tr td.alignCenter {
    text-align: center;
}

table tr td.alignRight {
    text-align: right;
}

table th.BT1 {
    width: 40px;
}

table th.BT2 {
    width: 80px;

}

table th.BT3 {
    width: 120px;

}

table th.BT4 {
    width: 160px;

}

table th.checkboxCol {
    width: 60px;
}

table th.selectCol {
    width: 60px;
}

table.List tr {
    height: 18px;
}

table.DualList tr {
    height: 18px;
}

table.DualList th {
    width: 40%;
    text-align: left;
    padding: 1px 5px;
    border: none;
}

table.DualList td {
    width: 60%;
    text-align: left;
    padding: 1px 5px;
    border: none;
}

table.Query th {
    text-align: right;
    border: none;
    padding: 1px 5px;
}

table.Query td {
    text-align: left;
    border: none;
    padding: 1px 5px;
}

table.DualList.Halfs {
    width: 300px;
}

table.DualInput th {
    width: 40%;
    text-align: left;
    padding: 1px 5px;
}

table.DualInput td{
    text-align: left;
    padding: 1px 5px;
}

table.TrioInput th {
    text-align: center;
}

table.TrioInput td {
    text-align: center;
}

table.TrioInput th.leftCol, table.TrioInput th.rightCol {
    width: 200px;
}

table.Complex tr {
    height: 20px;
    border: 1px solid lightGray;
    border-style: none none solid none;
}

table.Complex th {
    border: none;
    padding: 1px 3px;
}

table.Complex td {
    border: none;
    padding: 1px 3px;
}

table.Complex th.TH1 {
    width: 180px;
    text-align: left;
}

table.Complex th.TH2 {
    width: 180px;
    text-align: left;
}

table.Complex td.TD1 {
    width: 60px;
    text-align: center;
}

table.Complex td.TD2 {
    text-align: left;
}

/* dialog form */
.dialogForm div.Fixed {
    width:320px;
    height:150px;
    padding: 0;
    margin: 0;
    overflow: auto;
}

table.Fixed {
    width: 300px;
}

table.Fixed th {
    width: 50%;
}

table.Fixed td {
    width: 50%;
}

/* specific table */

#table-rules {
    width: 1200px;
}

#table-advanced_nat {
    width: 1024px;
}

#table-group_service tr {
    height: auto;
}

#table-group_service th {
    height: 30px;
}

#table-group_address tr {
    height: auto;
}

#table-group_address th {
    height: 30px;
}

#table-group_service th.tooltipCol {
    width: 120px;
}

#table-group_address th.tooltipCol {
    width: 160px;
}

#table-ip_alias {
    width: 480px;
}

table.group_services tr {
    border: 1px solid lightgray;
    border-style: solid none none none;
}

table.group_services td {
    width: 25%;
}

table.group_address tr {
    border: 1px solid lightgray;
    border-style: solid none none none;
}

table.group_address td {
    width: 33%;
}

#sub-div-access_control{
    height: 200px;
    overflow: auto;
}
/* form */

.formDiv {
    background: #F8F8F8;
}

.formAction {
    width: 200px;
    margin: 5px auto;
}

.tableAction {
    margin: 0 5px 5px 0;
}

.rowAction {

}

/* buttons */

button:hover {
    cursor: pointer;
    opacity: 0.6;
}

button:disabled {
    opacity: 0.2;
}

button.Query {
    margin: 5px auto;
}

button.Save, button.Cancel, button.Create, button.Remove {
    margin: 0 10px;
}

button.Move span.ui-icon {
    background-position: -80px -96px;
}

button.MoveUp span.ui-icon {
    background-position: 0 -16px;
}

button.MoveDown span.ui-icon {
    background-position: -64px -16px;
}

button.Add span.ui-icon {
    background-position: -16px -128px;
}

button.Connect span.ui-icon {
    background-position: -16px -176px;
}

button.Disconnect span.ui-icon {
    background-position: 0 -176px;
}

button.Delete span.ui-icon {
    background-position: -176px -96px;
}

button.Edit span.ui-icon {
    background-position: -176px -112px;
}

button.Mod span.ui-icon {
    background-position: -176px -112px;
}

button.Force span.ui-icon {
    background-position: 0 -176px;
}

button.Move2Add span.ui-icon {
    background-position: 0 -192px;
}

button.Move2Del span.ui-icon {
    background-position: -16px -192px;
}

/* template */

/* error */


span.error    {
    color: red;
    padding: 0 0 0 5px;
}
/* tabs */

/* multiple select */
select[multiple="multiple"] {
    
}

.Multiples {
    width: 200px;
    padding: 0;
    margin: 0;
}

.inlineDiv {
    display: -moz-inline-stack ;
    display:inline-block ;
    *display:inline ;
    zoom:1 ;
    vertical-align:center;
}

.inlineDiv.Halfs {
    width: 370px;
    vertical-align:top;
}

.inlineDiv.Trios {
}

.inlineDiv.Quats {
}
/* dialog */

.dialogForm {

}

.dialogForm div {
    padding: 3px 10px;
}
/* chart */

#chart-cpu_utilization, #chart-memory_utilization {
    width: 600px;
    height: 400px;
}

#chart-wan1, #chart-wan2, #chart-wan3, #chart-wan4, #chart-wan5, #chart-wan6 {
    width: 600px;
    height: 400px;
}
/* overflows */
#layout, #menu, #nav {
    overflow: hidden;
}

#menu ul {
    overflow: hidden;
}

#board {
    overflow: hidden;
}

.templateDiv {
    overflow: auto;
}

.tabs .ui-tabs-panel {
    overflow: auto;
}

</style>

<!-- CSS Stop -->
<!-- JS Start -->
<script type="text/javascript">
/* language */
var lang;
/* template */
var tmpl_ul     = '<ul id="${id}" class="${ul-class}"></ul>';
var tmpl_li     = '<li id="${id}" class="${li-class}"><a href="#" class="${a-class}">${label}</a></li>';
    
/* renders    */
function renderTemplate( container, template, data ) {
    clearTemplate( container );
    appendTemplate( container, template, data );
}

function clearTemplate( container ) {
    $( container ).empty();
}

function appendTemplate( container, template, data ) {
    $.tmpl( template, data ).appendTo( container );
}

/* timer */
var timer;
var counter;
var refresher;
var user = "";

function timerRender() {
    counter = new Date();
    $('#hd_timer').html('<h4>Date : ' + counter + '</h4>');
}

function timerStart() {
    timer = setInterval(function(){ timerRender() }, 1000);    
}

function timerStop() {
    clearInterval(timer);
}

function getVisitor() {
    $.getJSON("http://jsonip.appspot.com?callback=?", function(data){
        $('#hd_ip').html('<h4>Appliance IP : ' + data.ip + '</h4>');
    });
}

/* document ready */
/* define global vars */
/* check login */
/* menu & nav */
var menu
var actived;
var navSetter       = '<img id="navSetter" class="NavSetter" src="css/images/navSetter.png" alt="navSetter" />';
var html;

/* regexp */
/* try to reg per elmt instead of obj, for solve ie issues */
var regDigit        = /\d/;
var regIndex        = new RegExp(/index-(\d)-(\d)(-)?(\d)?/);
var regColspan      = /Colspans/;
var regJoin         = /\&/;
var regSemicolon    = /;/;
var regDash         = /-/;
var regComma        = /,/g;
var regDelimiter    = / |\s|\/|-/g;
var regBracket      = / |\s]?\(.*\)/;
var regUnder        = /_/;
var regDot          = /\./;
var regRowAction    = /(Add|Edit|Mod|Delete|MoveUp|MoveDown|Force|Active|Connect|Disconnect)/g;
var regTableAction  = /(Create|Save|Remove|Refresh|Query|Forces|Clear|Export|Disconnects)/g;
var regSelect       = /selectCol/;
var regRadio        = /radioCol/;
var regCheckbox     = /checkboxCol/;
var regTooltip      = /tooltipCol/;
var regIpAlias      = /^\d.*\d$/;
var regDomain       = /.*\.\w{2,4}$/;

var regChain        = /chain-/;

var regIpv4         = /^\d+\.\d+\.\d+\.\d+$/;
var regMac          = /^[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}\:[0-9a-fA-F]{2}$/;

var dialogTag       = false;

/* data obj */
var menuObj;

var dataObj;

var cacheObj;
var checkObj;

var formObj;
var jsonObj;

/* node */
var tmplTabs;
var popTabs;

/* yui chart */
var theChart;         
var chartID;
var hasChart;         
var chartData;        

/* yui3 */
var yui3;             

/* cgi vars */
var cgiList     = {};

var cgiVar      = {};

var cgiIpAlias  = [];

var addrType    = {};

// for gid & name
var cgiHash     = {};

var cgiGids     = {};

var cgiTypes    = {};

var selID       = "";

// ref
var cgiRef                      = {};

cgiRef.routing                  = {};

cgiRef.port                     = {};
cgiRef.port.speed               = {"0": "auto", "10": "10", "100": "100", "1000": "1000"};
cgiRef.port.duplex              = {"0": "full", "1": "half"};
cgiRef.port.type                = {"0": "LAN", "1": "WAN", "2": "Bridged"};
cgiRef.port.linkStatus          = {"0": "Down", "1": "Up"};
cgiRef.port.dhcpType            = {"0": "Disable", "1": "DHCP Server", "2": "DHCP Relay"};

cgiRef.lan                      = {};
cgiRef.lan.type                 = {"0": "Disable", "1": "DHCP Server", "2": "DHCP Relay"};
cgiRef.lan.stp                  = {"0": "Disabled", "1": "Enabled"};

cgiRef.vlan                     = {};
cgiRef.vlan.dhcpType            = {"0": "disable", "1": "dhcp server", "2": "dhcp relay"};
cgiRef.vlan.type                = {"0": "LAN", "1": "WAN", "2": "Bridged"};
cgiRef.vlan.interface           = ['GE1', 'GE2', 'GE3', 'GE4', 'GE5', 'GE6', 'GE7', 'GE8'];

cgiRef.wan                      = {};
cgiRef.wan.free                 = {'WAN1': true, 'WAN2': true, 'WAN3': true, 'WAN4': true, 'WAN5': true, 'WAN6': true};
cgiRef.wan.wan                  = [];
cgiRef.wan.weightVal            = [10,30,50,70,90];
cgiRef.wan.weight               = ['Very Low', 'Low', 'Average', 'High', 'Very High'];
cgiRef.wan.wanProto             = ["Static", "DHCP", "PPPoE", "L2TP", "PPTP"];
cgiRef.wan.interfaces           = { "0": "All", "1": "WAN1", "2": "WAN2", "3": "WAN3", "4": "WAN4", "5": "WAN5", "6": "WAN6" };

cgiRef.zone                     = {};
cgiRef.zone.free                = [];

cgiRef.s2svpn                   = {};
cgiRef.s2svpn.enable            = {"0": "Disable", "1": "Enable"};
cgiRef.s2svpn.infoStatus        = {"0": "Down", "1": "Up", "2": "Down"};
cgiRef.s2svpn.remoteGwType      = {"0": "Dynamic IP", "1": "Static IP", "2": "FQDN"};
cgiRef.s2svpn.phase1AuthType    = {"0": "Preshare Key", "1": "Certification"};
cgiRef.s2svpn.dpdaction         = {"0": "disable", "1": "hold", "2": "clear", "3": "restart"};
cgiRef.s2svpn.free              = [];
cgiRef.s2svpn.freez             = [];

cgiRef.ipsectransform           = {};
cgiRef.ipsectransform.cipher    = {"3des" : "ESP_3DES", "aes128" : "ESP_AES_128", "aes192" : "ESP_AES_192", "aes256" : "ESP_AES_256"};
cgiRef.ipsectransform.hash      = {"sha1" : "SHA_1", "md5" : "MD5"};
cgiRef.ipsectransform.pfsgroup  = {"modp1024" : "Group 2 (1024 bits)", "modp1536" : "Group 5 (1536 bits)", "modp2048" : "Group 14 (2048 bits)", "modp3072" : "Group 15 (3072 bits)", "modp4096" : "Group 16 (4096 bits)", "modp6144" : "Group 17 (6144 bits)", "modp8192" : "Group 18 (8192 bits)"};

cgiRef.ipsecike                 = {};    
cgiRef.ipsecike.cipher          = {"des" : "ESP_DES", "3des" : "ESP_3DES", "aes128" : "ESP_AES_128", "aes192" : "ESP_AES_192", "aes256" : "ESP_AES_256"};
cgiRef.ipsecike.hash            = {"sha1" : "SHA_1", "md5" : "MD5"};
cgiRef.ipsecike.dhgroup         = {"modp1024" : "Group 2 (1024 bits)", "modp1536" : "Group 5 (1536 bits)", "modp2048" : "Group 14 (2048 bits)", "modp3072" : "Group 15 (3072 bits)", "modp4096" : "Group 16 (4096 bits)", "modp6144" : "Group 17 (6144 bits)", "modp8192" : "Group 18 (8192 bits)"};

cgiRef.rules                    = {};
cgiRef.rules.enabled            = {"0": "disabled", "1": "enabled" };
cgiRef.rules.log                = {"0": "disabled", "1": "enabled" };
cgiRef.rules.matchAction        = { "0": "Deny", "1": "Permit", "2": "Accounting" };
cgiRef.rules.query              = false;
cgiRef.rules.move               = [];

cgiRef.dynamicPat               = {};
cgiRef.dynamicPat.mode          = { "0": "Auto", "1": "Manual" };

cgiRef.advancedNat              = {};
cgiRef.advancedNat.enabled      = {"0": "disabled", "1": "enabled" };

cgiRef.portForwarding           = {};
cgiRef.portForwarding.wan       = { "0": "All", "1": "WAN1", "2": "WAN2", "3": "WAN3", "4": "WAN4", "5": "WAN5", "6": "WAN6" };

cgiRef.staticNat                = {};
cgiRef.staticNat.wanInterface   = { "WAN1": "WAN1", "WAN2": "WAN2", "WAN3": "WAN3", "WAN4": "WAN4", "WAN5": "WAN5", "WAN6": "WAN6" };

cgiRef.dynamicPat               = {};
cgiRef.dynamicPat.mode          = {"0": "Auto", "1": "Manual"};

cgiRef.systime = {};
cgiRef.systime.tzName     = [
    "Edinburgh, London",
    "Eniwetok, Kwajalein",
    "Midway Island, Samoa",
    "Hawaii",
    "Marquesas Is.",
    "Alaska",
    "Pitcairn Is.",
    "Pacific Time(Canada); Tijuana",
    "Pacific Time(US); Tijuana",
    "Mountain Time, Arizona(Canada)",
    "Mountain Time, Arizona(US)",
    "Mexico City(US, Canada)",
    "CentralTime(USA)",
    "EasternTime",
    "EasternTime(USA), Lima, Indiana East",
    "Caracas",
    "Atlantic Time(Canada)",
    "Newfoundland",
    "Brasilia, Buenos Aires",
    "Mid-Atlantic",
    "Azores, Cape Verde Is.",
    "Europe",
    "Athens, Istanbul, Minsk, Cairo",
    "Baghdad, Kuwait",
    "Tehran",
    "Abu Dhabi, Muscat, Baku, Moscow",
    "Kabul",
    "Ekaterinburg, Islamabad, Karachi",
    "Bombay, Calcutta, Madras, Delhi",
    "Almaty, Dhaka, Colombo",
    "Burma",
    "Bangkok, Hanoi, Jakarta",
    "Beijing, Chongqing, Hong Kong",
    "Osaka, Sapporo, Tokyo, Seoul",
    "Adelaide, Darwin",
    "Brisbane, Guam, Port Moresby, Sydney",
    "Lord Howe Is.",
    "Magadan, Solomon Is, New Caledonia",
    "Norfolk I.",
    "Auckland, Wellington, New Zealand, Fiji",
    "Tonga",
    "Kiribati, Western Samoa"
    ];

cgiRef.systime.dstEnable = [
    "Eniwetok, Kwajalein", 
    "Midway Island, Samoa", 
    "Hawaii", 
    "Marquesas Is.", 
    "Caracas", 
    "Mid-Atlantic", 
    "Baghdad, Kuwait", 
    "Abu Dhabi, Muscat, Baku, Moscow", 
    "Kabul", 
    "Bombay, Calcutta, Madras, Delhi", 
    "Almaty, Dhaka, Colombo", 
    "Burma", "Bangkok, Hanoi, Jakarta", 
    "Beijing, Chongqing, Hong Kong", 
    "Osaka, Sapporo, Tokyo, Seoul", 
    "Brisbane, Guam, Port Moresby, Sydney", 
    "Norfolk I.", 
    "Tonga", 
    "Kiribati, Western Samoa"
    ];

cgiRef.group                    = {};
cgiRef.group.defaultGroup       = 'default';
cgiRef.group.defaultGroupGid    = 0;
cgiRef.group.webLoginPriv       = { "0": "Disable", "1": "Read Only", "2": "Report Only", "3": "Administrator" };
cgiRef.group.portalPriv         = { "0": "Disable", "1": "Enable" }; 

cgiRef.service                  = {};
cgiRef.service.type             = { "0": "both (tcp/udp)", "1": "tcp", "2": "udp", "3": "icmp", "4": "ip" };
cgiRef.service.type2            = { "0": "both (tcp/udp)", "1": "tcp", "2": "udp"};

cgiRef.antivirus = {};
cgiRef.antivirus.addressType    = { "0": "address", "1": "group address" };
cgiRef.antivirus.Log            = { "0": "disable", "1": "enable" };
cgiRef.antivirus.licensed       = { "0": "not licensed", "1": "licnesed" };

cgiRef.schedule                 = {};
cgiRef.schedule.type            = { "1": "all days + all time", "2": "all days + spec time", "3": "spec days + all time", "4": "spec days + spec time" };
cgiRef.schedule.day             = { "0": "All days", "1": "Monday", "2": "Tuesday", "4": "Wednesday", "8": "Thursday", "16": "Friday", "32": "Saturday", "64": "Sunday" };    
cgiRef.schedule.days            = [ "day1", "day2", "day4", "day8", "day16", "day32", "day64" ];

cgiRef.address                  = {};
cgiRef.address.type             = { "1": "Host", "2": "Network", "3": "Range", "4": "Mac" };
cgiRef.address.type2            = { "1": "Host", "2": "Network", "3": "Range" };
cgiRef.address.type3            = { "1": "Host", "2": "Network" };


// cgi tmpl
cgiRef.tmpl                 = {};

// interfaces
cgiRef.tmpl.wan             = {};
cgiRef.tmpl.wan.wanIpIfT    = {
    "gid"               : "0",
    "name"              : "",
    "wanProto"          : "0",
    "wanProto_v6"       : "0",
    "address"           : "",
    "portId"            : "",
    "zoneId"            : "",
    "macCloneEnable"    : "0",
    "macClone"          : "",
    "weight"            : "50",
    "netDetectEnable"   : "0",
    "netDetectMethod"   : "0",
    "netDetectPingIpId" : "0",
    "netDetectDnsIpId"  : "0",
    "failoverEnable"    : "0",
    "backupWanName"     : "0",
    "cgiAction"         : "0"
}

cgiRef.tmpl.wan.ipAliasT    = {
    "address" : "",
    "netmask" : ""
}

cgiRef.tmpl.wan.staticipT   = {
    "gid"       : "0",
    "ip"        : "",
    "netmask"   : "",
    "gateway"   : "",
    "mtuMode"   : "0",
    "mtu"       : "1500",
    "dnsMode"   : "0",
    "userDns1"  : "",
    "userDns2"  : ""
}

cgiRef.tmpl.wan.dhcpcT      = {
    "gid"       : "0",
    "mtuMode"   : "0",
    "mtu"       : "1500",
    "dnsMode"   : "0",
    "userDns1"  : "",
    "userDns2"  : ""
}

cgiRef.tmpl.wan.staticip6T  = {
    "gid"       : "0",
    "ip"        : "::",
    "prefix"    : "",
    "gateway"   : "::",
    "userDns1"  : "::",
    "userDns2"  : "::"
}

cgiRef.tmpl.lan = {};
cgiRef.tmpl.lan.guiLanIfT   = {
    "gid"               : "0",
    "name"              : "",
    "address"           : "",
    "netmask"           : "",
    "portId"            : "",
    "zoneId"            : "",
    "stp"               : "0",
    "dhcpPool"          : "",
    "interfaces"        : "",
    "zone"              : "0",
    "ipv6Address"       : "0",
    "ipv6PrefixLength"  : "0",
    "cgiAction"         : "0"
}

cgiRef.tmpl.lan.guiIpAliasT = {
    "ipAliasCnt"    : "0",
    "address"       : "",
    "netmask"       : ""
}

cgiRef.tmpl.lan.guiDhcpsT   = {
    "gid"           : "0",
    "type"          : "0",
    "startIp"       : "",
    "endIp"         : "",
    "relayIp"       : "",
    "leaseTime"     : "0",
    "gateway"       : "",
    "dns1"          : "0",
    "dns2"          : "",
    "wins1"         : "",
    "wins2"         : "",
    "domainName"    : ""
}

cgiRef.tmpl.vlan                = {};
cgiRef.tmpl.vlan.guiVlanIpIfT   = {
    "gid"               : "0",
    "name"              : "",
    "address"           : "",
    "netmask"           : "",
    "portId"            : "",
    "zoneId"            : "",
    "stp"               : "0",
    "dchpPool"          : "",
    "interfaces"        : "",
    "zone"              : "0",
    "ipv6Address"       : "0",
    "ipv6PrefixLength"  : "0",
    "cgiAction"         : "0"
}

cgiRef.tmpl.vlan.guiIpAliasT    = {
    "ipAliasCnt"    : "0",
    "address"       : "",
    "netmask"       : ""
}

cgiRef.tmpl.vlan.guiDhcpsT      = {
    "gid"           : "0",
    "type"          : "0",
    "startIp"       : "",
    "endIp"         : "",
    "relayIp"       : "",
    "leaseTime"     : "0",
    "gateway"       : "",
    "dns1"          : "0",
    "dns2"          : "",
    "wins1"         : "",
    "wins2"         : "",
    "domainName"    : ""
}

cgiRef.tmpl.zone                = {};
cgiRef.tmpl.zone.guiZoneIfT     = {
    "gid"           : "0",
    "name"          : "",
    "memberCnt"     : "0",
    "member"        : "",
    "securityLevel" : "",
    "cgiAction"     : "0"
}

// networking
cgiRef.tmpl.s2svpn              = {};
cgiRef.tmpl.s2svpn.guiS2svpnT   = {
    "gid"               : "0",
    "name"              : "",
    "type"              : "",
    "enable"            : "",
    "remoteGwType"      : "",
    "remoteGw"          : "",
    "wanId"             : "",
    "localNetworkId"    : "",
    "remoteNetworkId"   : "",
    "phase1AuthType"    : "",
    "presharedkey"      : "",
    "ikePolicyId"       : "",
    "transformPolicyId" : "",
    "pfsEnable"         : "",
    "dpdEnable"         : "",
    "dpdaction"         : "",
    "dpddelay"          : "",
    "dpdtimeout"        : "",
    "vpnaclTNum"        : "0",
    "vpnaclT"           : [],
    "wanFailoverEnable" : "",
    "backupPolicyEnable": "",
    "backupPolicyName"  : "",
    "fallbackTime"      : "",
    "infoStatus"        : "",
    "cgiAction"         : "0"

}

// firewall
cgiRef.tmpl.advancedNat                 = {};
cgiRef.tmpl.advancedNat.guiAdvancedNatT = {
    "gid"               : "0",
    "enabled"           : "0",
    "fromIf"            : "",
    "toIf"              : "",
    "originalSrc"       : "",
    "originalDst"       : "",
    "originalService"   : "",
    "translatedSrc"     : "",
    "translatedDst"     : "",
    "translatedService" : "",
    "cgiAction"         : ""
}

cgiRef.tmpl.schedule                = {
    "gid"           : "0",
    "name"          : "",
    "type"          : "",
    "userDefined"   : "1",
    "day"           : "",
    "startHour"     : "",
    "startMin"      : "",
    "endHour"       : "",
    "endMin"        : ""
};

cgiRef.tmpl.common_updateTime       = {
    "gid"           : "0",
    "name"          : "",
    "type"          : "",
    "userDefined"   : "1",
    "day"           : "",
    "startHour"     : "",
    "startMin"      : "",
    "endHour"       : "",
    "endMin"        : "",
    "action"        : "0"
};

cgiRef.tmpl.service                 = {
    "gid"           : "0",
    "name"          : "",
    "type"          : "0",
    "userDefined"   : "1",
    "param1"        : "0",
    "param2"        : "0"
};

cgiRef.tmpl.common_updateService    = {
    "gid"           : "0",
    "name"          : "",
    "type"          : "0",
    "userDefined"   : "1",
    "param1"        : "0",
    "param2"        : "0",
    "action"        : "0"
};

cgiRef.tmpl.group_service = {
    "gid"           : "0",
    "name"          : "",
    "userDefined"   : "1",
    "num"           : "0",
    "idList"        : ""
};

cgiRef.tmpl.common_updateGService   = {
    "gid"           : "0",
    "name"          : "",
    "userDefined"   : "1",
    "num"           : "0",
    "idList"        : "",
    "action"        : "0"
};

cgiRef.tmpl.address                 = {
    "gid"           : "0",
    "name"          : "",
    "userDefined"   : "1",
    "type"          : "",
    "startIp"       : "",
    "endIp"         : "",
    "netmask"       : "",
    "mac"           : ""
};

cgiRef.tmpl.common_updateAddr       = {
    "gid"           : "0",
    "name"          : "",
    "userDefined"   : "1",
    "type"          : "",
    "startIp"       : "",
    "endIp"         : "",
    "netmask"       : "",
    "mac"           : "",
    "action"        : "0"
}

cgiRef.tmpl.group_address           = {
    "gid"           : "0",
    "name"          : "",
    "userDefined"   : "1",
    "num"           : "0",
    "idList"        : ""
}

cgiRef.tmpl.common_updateGAddr      = {
    "gid"           : "0",
    "name"          : "",
    "userDefined"   : "1",
    "num"           : "0",
    "idList"        : "",
    "action"        : "0"
}

cgiRef.tmpl.ip_alias = { 
    "address"       : "",
    "netmask"       : ""
};

/* ip calc */
var calcObj         = {};

/* validator */

var validator       = {};

validator.lifetime  = {"min" : 180, "max" : 86400, "default": 86400};

validator.year      = {"min" : 2012, "max" : 2025};
validator.month     = {"min" : 1, "max" : 12};
validator.day       = {"min" : 1, "max" : 31};
validator.hour      = {"min" : 0, "max" : 23};
validator.minute    = {"min" : 0, "max" : 59};
validator.second    = {"min" : 0, "max" : 59};

$(document).ready(function () {

function ifLogin() {
    $('body').load('templates/login.html #loginDiv', function() {
        $('#loginButton').on('click', function(e) {
            e.preventDefault();
            user = $('#userName').val();
            lang = $('#guiLang').find('option:selected').val();
            menu = 'data/' + lang + '-menu.txt';
            $('body').empty();
            $('body').load('templates/layout.html #layout', function() {
                $('#hd').load('templates/hd.html .content', function() {
                    $('#logoutBtn').on('click', function(e) {
                        e.preventDefault();
                        timerStop();
                        $('body').empty();
                        ifLogin();
                    });
                    $('#hd_user').html('<h4>Welcome : ' + user + '</h4>');
                });

                $('#bd').load('templates/bd.html .content', function() {
                    // menu
                    /* bd loaded */
                    $.ajax({url:menu, dataType:'json', success:function(data) {
                        menuObj = data.menu;
                        actived    = new Object;
                        actived.index = null;
                        actived.h3Arr = [];
                        actived.h4Arr = [];
                        actived.h4Arrs = [];
                        html = '<ul class="accordion-ul">';
                        for (var i in data.menu) {
                            actived.h3Arr.push(data.menu[i].tab);
                            html += '<li id="'+data.menu[i].tab+'" class="accordion-ul-li"><h3><a href="#">'+data.menu[i].label+'</a></h3>';
                            html += '<ul class="accordion-ul-ul">';
                            for (var j in data.menu[i].panel) {
                                switch(typeof(data.menu[i].panel[j].panel) == 'object')
                                {
                                case true:
                                    actived.h4Arr.push(data.menu[i].panel[j].tab);
                                    actived.h4Arrs.push(j);
                                    html += '<ul class="accordion-ul-ul-ul">';
                                    html += '<li id="'+data.menu[i].panel[j].tab+'" class="accordion-ul-ul-ul-li"><h4><a href="#">'+data.menu[i].panel[j].label+'</a></h4>';
                                    html += '<ul class="accordion-ul-ul-ul-ul">';
                                    for (var k in data.menu[i].panel[j].panel) 
                                        html += '<li id="'+data.menu[i].panel[j].panel[k].tab+'" class="accordion-ul-ul-ul-ul-li index-'+i+'-'+j+'-'+k+'"><h5><a href="#">'+data.menu[i].panel[j].panel[k].label+'</a></h5></li>';
                                    html += '</ul>';
                                    html += '</li>';
                                    html += '</ul>';
                                    break;
                                case false:
                                    html += '<li id="'+data.menu[i].panel[j].tab+'" class="accordion-ul-ul-li index-'+i+'-'+j+'"><h4><a href="#">'+data.menu[i].panel[j].label+'</a></h4></li>';
                                    break;
                                }
                            }
                            html += '</ul>';
                            html += '</li>';
                        }
                        html += '</ul>';
                        $('#menu').html(html);
                        $('.accordion-ul').accordion({
                            autoHeight: false

                        });
                        $('.accordion-ul-ul-ul').accordion({
                            collapsible:true, 
                            active:false, 
                            autoHeight: false
                        });

                        $('.accordion-ul-ul-li h4').on('click', function(e) {
                            if (actived.index)
                                actived.index.removeClass('ui-actived');
                            actived.index = $(this);
                            actived.index.addClass('ui-actived');
                            switch(regIndex.test($(this).parents('li').attr('class')))
                            {
                            case true:
                                actived.h3Index = RegExp.$1;
                                actived.h4Index = RegExp.$2;
                                actived.lv = true;
                                loadTemplate($(this).parents('li').attr('id'), data.menu[actived.h3Index].panel[actived.h4Index].template);
                                // navbar 
                                switch(actived.h3Index)
                                {
                                case '0':
                                    $('#nav').html('<h3><b><span></span>'+data.menu[actived.h3Index].label+'</b><b><span></span>'+data.menu[actived.h3Index].panel[actived.h4Index].label+'</b></h3>'+navSetter);
                                    break;
                                default:
                                    $('#nav').html('<h3><b><span></span>'+data.menu[actived.h3Index].label+'</b><b><span></span>'+data.menu[actived.h3Index].panel[actived.h4Index].label+'</b></h3>');
                                }
                                break;
                            }
                        });

                        $('.accordion-ul-ul-ul-ul-li h5').on('click', function(e) {
                            if (actived.index)
                                actived.index.removeClass('ui-actived');
                            actived.index = $(this);
                            actived.index.addClass('ui-actived');
                            switch(regIndex.test($(this).parents('li').attr('class')))
                            {
                            case true:
                                actived.h3Index = RegExp.$1;
                                actived.h4Index = RegExp.$2;
                                actived.h5Index = RegExp.$4;
                                actived.lv = false;
                                // navbar 
                                loadTemplate($(this).parents('li').attr('id'), data.menu[actived.h3Index].panel[actived.h4Index].panel[actived.h5Index].template );
                                $('#nav').html('<h3><b><span></span>'+data.menu[actived.h3Index].label+'</b><b><span></span>'+data.menu[actived.h3Index].panel[actived.h4Index].label+'</b><b><span></span>'+data.menu[actived.h3Index].panel[actived.h4Index].panel[actived.h5Index].label+'</b></h3>');
                                break;
                            }
                        });
                        
                        // prevent default behavior of click
                        $('button').live('click', function(e) {
                            e.preventDefault();
                            formObj = {};
                            var cgiID;
                            var btID        = $(this).attr('id');
                            var btClass = $(this).attr('class');
                            var aimID;
                            if (btID)
                                 aimID        = btID.split(regDash)[1];
                                 
                            var tableID = '#table-' + aimID;
                            var tableHD = tableID + ' > thead';
                            var tableBD = tableID + ' > tbody';
                            
                            if ($(tableBD).length == 0)
                                $(tableID).append('<tbody>');
                            
                            var pID         =    $(this).parents('.Confirm').attr('id');        
                            var formID    = '#form-' + aimID;
                            var tmp;
                            var thisNo = 0;
                            switch(btClass)
                            {
                            case 'Create':
                                var isPass = true;
                                var isValid = true;
                                var cgiGetID;
                                var cgiPostID;
                                var cgiT;
                                var cgiTNum;
                                
                                switch(aimID)
                                {
                                case 'ip_alias':
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                         $('.extraForm').dialog({
                                                width: 350,
                                                height:200,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        if ( !regIpv4.test($('#modIpAliasAddress').val()) ) {
                                                            isPass = false;
                                                            $('#modIpAliasAddress').parents('td').append('<label    class="errorLabel" for="modIpAliasAddress"><span class="error">IPv4 spec</span></label>');
                                                            $('#modIpAliasAddress').focus();
                                                        }
                                                        
                                                        if ( !regIpv4.test($('#modIpAliasNetmask').val()) ) {                                                        
                                                            $('#modIpAliasNetmask').parents('td').append('<label    class="errorLabel" for="modIpAliasNetmask"><span class="error">IPv4 spec</span></label>');
                                                            if (isPass)
                                                                $('#modIpAliasNetmask').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            cgiIpAlias.push( { 'address': $('#modIpAliasAddress').val(), 'netmask': $('#modIpAliasNetmask').val() } );
                                                            if ($(tableBD).length == 0)
                                                                $(tableID).append('<tbody>');
                                                            var cnt = ($(tableBD + ' tr').length == 0)? 0 : $(tableBD + ' tr').length;
                                                            tmp = '<tr class="' + ((cnt%2==0)? 'odd' : 'even') + '">';
                                                            tmp += '<td id="ipAliasT-address-' + cnt + '">' + $('#modIpAliasAddress').val() + '</td>';
                                                            tmp += '<td id="ipAliasT-netmask-' + cnt + '">' + $('#modIpAliasNetmask').val() + '</td>';
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-ip_alias-' + cnt + '" class="Edit"><span class="ui-icon"></span></button>';
                                                            tmp += '<button id="Delete-ip_alias-' + cnt + '" class="Delete"><span class="ui-icon"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableBD).append(tmp);
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                    });
                                    break;
                                    // device object
                                case 'schedule':
                                    cgiGetID = 'common_time_list';
                                    cgiPostID = 'common_updateTime';
                                    cgiT = 'guiTimeT';
                                    cgiTNum = 'guiTimeTNum';
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#' + aimID + '-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID +'-name"><span class="error">name required</span></label>');
                                                        $('#' + aimID + '-name').focus();
                                                    }
    
                                                    if (isPass)
                                                    {
                                                        
                                                        thisNo = dataObj[ aimID ][ cgiTNum ];
                                                        dataObj[ aimID ][ cgiTNum ]++; 
                                                        dataObj[ aimID ][ cgiT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ]);
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                        
                                                        tmp = '<tr class="' + ((thisNo % 2 == 0)? 'odd' : 'even') + '">';
                                                        
                                                        tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                        tmp += '<td id="num-' + thisNo + '">' + dataObj[ aimID ][ cgiTNum ] + '</td>';
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].userDefined = "1";
                                                        formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        tmp += '<td id="name-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].name + '</td>';
                                                        
                                                        var days;
                                                        switch($('#days option:selected').val())
                                                        {
                                                        case "0":
                                                            switch($('#times option:selected').val())
                                                            {
                                                            case "0":
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].type = "1";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startHour = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startMin = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endHour = "23";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endMin = "59";
                                                                break;
                                                            case "1":
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].type = "2";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startHour = $('#startHour').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startMin = $('#startMin').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endHour = $('#endHour').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endMin = $('#endMin').val();
                                                                break;
                                                            }
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].day = 0;
                                                            days = cgiRef[ aimID ].day[ dataObj[ aimID ][ cgiT ][ thisNo ].day ] ;
                                                            break;
                                                        case "1":
                                                            switch($('#times option:selected').val())
                                                            {
                                                            case "0":
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].type = "3";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startHour = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startMin = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endHour = "23";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endMin = "59";
                                                                break;
                                                            case "1":
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].type = "4";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startHour = $('#startHour').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startMin = $('#startMin').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endHour = $('#endHour').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endMin = $('#endMin').val();
                                                                break;
                                                            }
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].day = 0;
                                                            var arr = [];
                                                            for (var x in cgiRef[ aimID ].days)
                                                            {
                                                                switch($('#'+ cgiRef[ aimID ].days[ x ] ).is(':checked'))
                                                                {
                                                                case true:
                                                                    arr.push( cgiRef[ aimID ].day[ $('#' + cgiRef[ aimID ].days[ x ] ).val() ] );
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].day += parseInt( $('#' + cgiRef[ aimID ].days[ x ] ).val() );
                                                                    break;
                                                                }
                                                            }
                                                            days = arr.join(',');
                                                            break;
                                                        }
                                                        
                                                        
                                                        formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                                        
                                                        formObj.day = dataObj[ aimID ][ cgiT ][ thisNo ].day;
                                                        tmp += '<td id="day-' + thisNo +'">' + days + '</td>';
                                                                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].startHour = $('#startHour').val();
                                                        formObj.startHour = dataObj[ aimID ][ cgiT ][ thisNo ].startHour;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].startMin = $('#startMin').val();
                                                        formObj.startMin = dataObj[ aimID ][ cgiT ][ thisNo ].startMin;
                                                        tmp += '<td id="startTime-' + thisNo + '">' +    dataObj[ aimID ][ cgiT ][ thisNo ].startHour + ':' + dataObj[ aimID ][ cgiT ][ thisNo ].startMin + '</td>';
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].endHour = $('#endHour').val();
                                                        formObj.endHour = dataObj[ aimID ][ cgiT ][ thisNo ].endHour;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].endMin = $('#endMin').val();
                                                        formObj.endMin = dataObj[ aimID ][ cgiT ][ thisNo ].endMin;
                                                        tmp += '<td id="endTime-' + thisNo + '">' +    dataObj[ aimID ][ cgiT ][ thisNo ].endHour + ':' + dataObj[ aimID ][ cgiT ][ thisNo ].endMin + '</td>';
                                                        
                                                        formObj.action = "0";
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        /* should be move insiide callback */
                                                        
                                                        tmp +=     '<td class="buttonTD">';
                                                        tmp +=         '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                        tmp +=         '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                        tmp +=     '</td>';
                                                        tmp += '</tr>';
                                                            
                                                        $(tableID).append(tmp);
                                                        $( this ).dialog( "close" );
                                                        
                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                         
                                        });
                                        
                                        $('#days').val(0).trigger('change');
                                        $('#times').val(0).trigger('change');
                                        
                                        $('#startHour').append( genSelectOption('startHour') );
                                        $('#startMin').append( genSelectOption('startMin') );
                                        $('#endHour').append( genSelectOption('endHour') ).val(0).trigger('change');
                                        $('#endMin').append( genSelectOption('endMin') ).val(0).trigger('change');
                                    });
                                    break;
                                case 'address':
                                    cgiGetID = 'common_addr_list';
                                    cgiPostID = 'common_updateAddr';
                                    cgiT = 'guiAddrT';
                                    cgiTNum = 'guiAddrTNum';
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    
                                                    calcObj = {};
                                                    isPass = true;
                                                    isValid = false;
                                                    $('.errorLabel').remove();
                                                    if ($('#' + aimID + '-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                        $('#' + aimID + '-name').focus();
                                                    }

                                                    var types = parseInt( $('#' + aimID + '-type option:selected').val() );
                                                    var arr = [];
                                                    switch(parseInt( $('#' + aimID + '-type option:selected').val() ))
                                                    {
                                                    case 1:
                                                        
                                                        if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                            arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                            for (var i=0, ilen=arr.length; i<ilen; i++)
                                                            {
                                                                arr[i] = parseInt(arr[i]);
                                                                switch (arr[i] > 255 || arr[i] < 0) 
                                                                {
                                                                case true:
                                                                    $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case false:
                                                                    switch(i)
                                                                    {
                                                                    case 3:
                                                                        switch(arr[i] == 255 || arr[i] == 0 )
                                                                        {
                                                                        case true:
                                                                            $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                            if (isPass)
                                                                                $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                            isPass = false;
                                                                            break; 
                                                                        }
                                                                        break; 
                                                                    }
                                                                    break;
                                                                }
                                                            }
                                                            if (isPass)
                                                                $('#' + aimID + '-type-' + types + '-startIp').val( arr.join('.') );
    
                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                            isPass = false;
                                                        }
                                                        break;
                                                    case 2:
                                                        if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                            arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                            for (var i=0, ilen=arr.length; i<ilen; i++)
                                                            {
                                                                switch (arr[i] > 255 || arr[i] < 0) 
                                                                {
                                                                case true:
                                                                    $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case false:
                                                                    calcObj["ip_" + (i+1)] = parseInt(arr[i]);
                                                                    break;
                                                                }
                                                            }
                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (regIpv4.test($('#' + aimID + '-type-' + types + '-netmask').val()) && $('#' + aimID + '-type-' + types + '-netmask').val() != '255.255.255.255' ) {
                                                            arr = $('#' + aimID + '-type-' + types + '-netmask').val().split(regDot);
                                                            for (var i=0, ilen=arr.length; i<ilen; i++)
                                                            {
                                                                switch (arr[i] > 255 || arr[i] < 0) 
                                                                {
                                                                case true:
                                                                    $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case false:
                                                                    calcObj["snm_" + (i+1)] = parseInt(arr[i]);
                                                                    break;
                                                                }
                                                            }
                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            calcNWbits(calcObj);
                                                            
                                                            if (calcObj.result != 'invalid') {
                                                                calcObj.bits = calcObj.result;
                                                                calcNBFL(calcObj);
                                                                
                                                                switch(calcObj.numofaddr)
                                                                {
                                                                case 'ERR':
                                                                    $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case 'one':
                                                                case 'two':
                                                                    calcObj.startIp = calcObj.firstadr_1 + '.' + calcObj.firstadr_2 + '.' + calcObj.firstadr_3 + '.' + calcObj.firstadr_4;
                                                                    calcObj.endIp     = calcObj.lastadr_1 + '.' + calcObj.lastadr_2 + '.' + calcObj.lastadr_3 + '.' + calcObj.lastadr_4;
                                                                    break;                                                                
                                                                default:
                                                                    calcObj.startIp = calcObj.nwadr_1 + '.' + calcObj.nwadr_2 + '.' + calcObj.nwadr_3 + '.' + calcObj.nwadr_4;
                                                                    calcObj.endIp     = calcObj.bcast_1 + '.' + calcObj.bcast_2 + '.' + calcObj.bcast_3 + '.' + calcObj.bcast_4;
                                                                }
                                                                
                                                                if (isPass && calcObj.startIp != $('#' + aimID + '-type-' + types + '-startIp').val() ) {
                                                                    $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error"> match fail</span></label>');
                                                                    $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                    isPass = false;
                                                                    
                                                                }
    
                                                            }else {
                                                                $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        break;
                                                    case 3:
                                                        calcObj.start = [];
                                                        calcObj.end = [];
                                                        if ($('#' + aimID + '-type-' + types + '-startIp').val() == $('#' + aimID + '-type-' + types + '-endIp').val()) {
                                                            $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                            isPass = false;
                                                        }else {
                                                            if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                                arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                                for (var i=0, ilen=arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(arr[i]) || arr[i] > 255 || arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    case false:
                                                                        calcObj.start.push( parseInt(arr[i]) );
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                     $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                isPass = false;
                                                            }
                                                            
                                                            if (regIpv4.test($('#' + aimID + '-type-' + types + '-endIp').val())) {
                                                                arr = $('#' + aimID + '-type-' + types + '-endIp').val().split(regDot);
                                                                for (var i=0, ilen=arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(arr[i]) || arr[i] > 255 || arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    case false:
                                                                        calcObj.end.push( parseInt(arr[i]) );
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                     $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                isPass = false;
                                                            }
                                                            
                                                            if (isPass) {
                                                                if (calcObj.start[0] > calcObj.end[0]) {
                                                                    $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                        isPass = false;
                                                                }else if (calcObj.start[0]== calcObj.end[0]) {
                                                                    if (calcObj.start[1] > calcObj.end[1]) {
                                                                        $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                            isPass = false;
                                                                    }else if (calcObj.start[1] == calcObj.end[1]) {
                                                                        if (calcObj.start[2] > calcObj.end[2]) {
                                                                            $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                            if (isPass)
                                                                                $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                                isPass = false;
                                                                        }else if ( calcObj.start[2] == calcObj.end[2]) {
                                                                            if ( calcObj.start[3] > calcObj.end[3] ) {
                                                                                $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                                if (isPass)
                                                                                    $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                                    isPass = false;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        break;
                                                    case 4:
                                                        if (!regMac.test($('#' + aimID + '-type-' + types + '-mac').val())) {
                                                            $('#' + aimID + '-type-' + types + '-mac').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-mac"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-mac').focus();
                                                            isPass = false;
                                                        }
                                                        break;
                                                    }

        
                                                    if (isPass) {
                                                        thisNo = dataObj[ aimID ][ cgiTNum ];
                                                        dataObj[ aimID ][ cgiTNum ]++;
                                                        dataObj[ aimID ].guiMacTNum ++;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ]);
                                                        
                                                        tmp = '<tr class="' + ((thisNo % 2 == 0)? 'odd' : 'even') + '">';
                                                        
                                                        tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                        tmp += '<td id="num-' + thisNo + '">' + dataObj[ aimID ][ cgiTNum ] + '</td>';
                                                                                                         
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].userDefined = "1";
                                                        formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        tmp += '<td id="name-' + thisNo + '">' +    dataObj[ aimID ][ cgiT ][ thisNo ].name + '</td>';
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].type = $('#' + aimID + '-type').val();
                                                        formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                                        
                                                        switch(parseInt($('#' + aimID + '-type').val()))
                                                        {
                                                        case 1:
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].startIp = $('#' + aimID + '-type-' + types + '-startIp').val();
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].endIp     = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].netmask = '255.255.255.255';
                                                            
                                                            formObj.startIp = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                                            formObj.endIp = dataObj[ aimID ][ cgiT ][ thisNo ].endIp;
                                                            formObj.netmask = dataObj[ aimID ][ cgiT ][ thisNo ].netmask;
                                                            
                                                            tmp += '<td id="detail-' + thisNo + '">Host: ' + dataObj[ aimID ][ cgiT ][ thisNo ].startIp + '/' + dataObj[ aimID ][ cgiT ][ thisNo ].netmask + '</td>';
                                                            break;
                                                        case 2:
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].startIp = calcObj.startIp;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].endIp     = calcObj.endIp;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].netmask = $('#' + aimID + '-type-' + types + '-netmask').val();
                                                            
                                                            formObj.startIp = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                                            formObj.endIp = dataObj[ aimID ][ cgiT ][ thisNo ].endIp;
                                                            formObj.netmask = dataObj[ aimID ][ cgiT ][ thisNo ].netmask;
                                                            
                                                            tmp += '<td id="detail-' + thisNo + '">Network: ' + dataObj[ aimID ][ cgiT ][ thisNo ].startIp + '/' + dataObj[ aimID ][ cgiT ][ thisNo ].netmask + '</td>';
                                                            break;
                                                        case 3:
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].startIp = $('#' + aimID + '-type-' + types + '-startIp').val();
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].endIp     = $('#' + aimID + '-type-' + types + '-endIp').val();
                                                            
                                                            formObj.startIp = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                                            formObj.endIp = dataObj[ aimID ][ cgiT ][ thisNo ].endIp;
                                                            
                                                            tmp += '<td id="detail-' + thisNo + '">Range: ' + dataObj[ aimID ][ cgiT ][ thisNo ].startIp + '-' + dataObj[ aimID ][ cgiT ][ thisNo ].endIp + '</td>';

                                                            break;
                                                        case 4:
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].mac = $('#' + aimID + '-type-' + types + '-mac').val();
                                                            formObj.mac = dataObj[ aimID ][ cgiT ][ thisNo ].mac;
                                                            
                                                            tmp += '<td id="detail-' + thisNo + '">Mac: ' + dataObj[ aimID ][ cgiT ][ thisNo ].mac + '</td>';
                                                            break;
                                                        }
                                                        
                                                        tmp += '<td id="type-' + thisNo + '">' +    $('#' + aimID + '-type option:selected').text() + '</td>';
                                                        
                                                        formObj.action = "0";
                                                                                                                
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        
                                                        /* should be move insiide callback */
                                                        
                                                        
                                                        
                                                        tmp +=     '<td class="buttonTD">';
                                                        tmp +=         '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                        tmp +=         '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                        tmp +=     '</td>';
                                                        tmp += '</tr>';
                                                        
                                                        $(tableID).append(tmp);
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].gid = e.timeStamp;
                                                            
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        
                                                        $( this ).dialog( "close" );
                                                        
                                                        /* ---- */
                                                    }

                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                         
                                        });
                                        $('#' + aimID + '-type').append( genSelectOption('addressType1') ).val(1).trigger('change');
                                    });
                                    break;
                                case 'group_address':
                                    cgiGetID = 'common_gAddr_list';
                                    cgiPostID = 'common_updateGAddr';
                                    cgiT = 'guiGAddrT';
                                    cgiTNum = 'guiGAddrTNum';
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#' + aimID + '-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="group_address-name"><span class="error">name required</span></label>');
                                                        $('#' + aimID + '-name').focus();
                                                    }
                                                    
                                                    if (isPass) {
                                                        thisNo = dataObj[ aimID ][ cgiTNum ];
                                                        dataObj[ aimID ][ cgiTNum ]++; 
                                                        dataObj[ aimID ][ cgiT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ]);
                                                        
                                                        tmp = '<tr class="' + ((thisNo % 2 == 0)? 'odd' : 'even') + '">';
                                                        
                                                        tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                        tmp += '<td id="num-' + thisNo + '">' + dataObj[ aimID ][ cgiTNum ] + '</td>';
                                                                                                                
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                        formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].userDefined = "1";
                                                        formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name        = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        
                                                        var arr = [];
                                                        $('#' + aimID + '-idList option').each(function() {
                                                            arr.push($(this).val());
                                                        });
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].num = arr.length;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].idList = arr.join(';');
                                                        formObj.num         = dataObj[ aimID ][ cgiT ][ thisNo ].num;
                                                        formObj.idList    = dataObj[ aimID ][ cgiT ][ thisNo ].idList;
                                                        
                                                        tmp += '<td id="groupName-' + thisNo +'" colspan="3" class="alignLeft">';
                                                        tmp +=     '<div class="tooltipAccordion">';
                                                        tmp +=        '<h4><a href="#">' + dataObj[ aimID ][ cgiT ][ thisNo ].name + '</a></h4>';
                                                        tmp +=        '<div id="div-groupName-' + thisNo + '">';
                                                        tmp +=            tooltipTable( aimID, 'groupName-' + thisNo,    dataObj[ aimID ][ cgiT ][ thisNo ].idList);
                                                        tmp +=        '</div>';
                                                        tmp +=     '</div>';
                                                        tmp += '</td>';
                                                        
                                                        tmp += '<td class="buttonTD">';
                                                        tmp +=     '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                        tmp +=     '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                        tmp += '</td>';
                                                        tmp += '</tr>';
                                                        
                                                        
                                                        formObj.action    = "0";                                                        
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        /* should be move insiide callback */
                                                            
                                                        $(tableID).append(tmp);
                                                        $('.tooltipAccordion').accordion({
                                                            collapsible:true, 
                                                            active:false, 
                                                            autoHeight: false
                                                        });
                                                        
                                                        $( this ).dialog( "close" );
                                                        
                                                        /* ---- */
                                                        
                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                        });
                                        
                                        tmp = "";                                
                                        for (var i=0; i < parseInt(dataObj.address.guiAddrTNum); i++)
                                            tmp += '<option value="' + dataObj.address.guiAddrT[i].gid + '">' + dataObj.address.guiAddrT[i].name + '</option>';
                                        $('#' + aimID + '-idListPool').append(tmp);
                                    });
                                    break;
                                case 'service':
                                    cgiGetID = 'common_service_list';
                                    cgiPostID = 'common_updateService';
                                    cgiT = 'guiServiceT';
                                    cgiTNum = 'guiServiceTNum';
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {    
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#service-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#service-name').parents('td').append('<label class="errorLabel" for="service-name"><span class="error">name required</span></label>');
                                                        $('#service-name').focus();
                                                    }
                                                    
                                                    var types = parseInt($('#service-type option:selected').val());
                                                    var param;
                                                    switch(types)
                                                    {
                                                    case 0:
                                                    case 1:
                                                    case 2:
                                                        param = parseInt($('#service-type-' + types + '-param1').val());
                                                        if ( param < 1 || param > 65535 || isNaN(param)) {
                                                            $('#service-type-' + types + '-param1').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param1"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#service-type-' + types + '-parma1').focus();
                                                            isPass = false;
                                                        }
                                                        param = parseInt($('#service-type-' + types + '-param2').val());
                                                        if ( param < 1 || param > 65535 || isNaN(param)) {
                                                            $('#service-type-' + types + '-param2').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param2"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#service-type-' + types + '-parma2').focus();
                                                            isPass = false;
                                                        }
                                                        break;
                                                    case 3:
                                                    case 4:
                                                        param = parseInt($('#service-type-' + types + '-param1').val());
                                                        if ( param < 1 || param > 255 || isNaN(param)) {
                                                            $('#service-type-' + types + '-param1').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param1"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#service-type-' + types + '-parma1').focus();
                                                            isPass = false;
                                                        }
                                                        break;
                                                    }
    
                                                    if (isPass) {
                                                        formObj = $.extend({}, cgiRef.tmpl[ aimID ]);

                                                        thisNo = dataObj[ aimID ][ cgiTNum ];
                                                        dataObj[ aimID ][ cgiTNum ]++; 
                                                        dataObj[ aimID ][ cgiT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ]);
                                                        
                                                        tmp = '<tr class="' + ((thisNo % 2 == 0)? 'odd' : 'even') + '">';
                                                        
                                                        tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                        tmp += '<td id="num-' + thisNo + '">' + dataObj[ aimID ][ cgiTNum ] + '</td>';
                                                                                                                
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                        formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].userDefined = "1";
                                                        formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;

                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name        = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        tmp += '<td id="name-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].name + '</td>';
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].type = $('#' + aimID + '-type option:selected').val();
                                                        formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                                        tmp += '<td id="type-' + thisNo + '">' + cgiRef[ aimID ].type[ dataObj[ aimID ][ cgiT ][ thisNo ].type ] + '</td>';
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].param1 = $('#' + aimID + '-type-' + types + '-param1').val();
                                                        formObj.param1 = dataObj[ aimID ][ cgiT ][ thisNo ].param1;
                                                        tmp += '<td id="param1-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].param1 + '</td>';
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].param2 = ( types < 3 )? $('#' + aimID + '-type-' + types + '-param2').val() : "0";
                                                        formObj.param2 = dataObj[ aimID ][ cgiT ][ thisNo ].param2;
                                                        tmp += '<td id="param2-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].param2 + '</td>';

                                                        tmp += '<td class="buttonTD">';
                                                        tmp +=     '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                        tmp +=     '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                        tmp += '</td>';
                                                        tmp += '</tr>';
                                                        
                                                        
                                                        formObj.action    = "0";                                                        
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        /* should be move insiide callback */
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].gid = e.timeStamp;
                                                            
                                                        $(tableID).append(tmp);
                                                        
                                                        $( this ).dialog( "close" );
                                                        
                                                        /* ---- */

                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                            
                                        });
                                        $('#' + aimID + '-type').val(0).trigger('change');
                                     });
                                    break;
                                case 'group_service':
                                    cgiGetID = 'common_gService_list';
                                    cgiPostID = 'common_updateGService';
                                    cgiT = 'guiGServiceT';
                                    cgiTNum = 'guiGServiceTNum';
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#' + aimID + '-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="group_service-name"><span class="error">name required</span></label>');
                                                        $('#' + aimID + '-name').focus();
                                                    }
                                                    var arr = [];
                                                    $('#' + aimID + '-idList option').each(function() {
                                                        arr.push($(this).val());
                                                    });
                                                    
                                                    if (isPass) {
                                                        
                                                        thisNo = dataObj[ aimID ][ cgiTNum ];
                                                        dataObj[ aimID ][ cgiTNum ]++; 
                                                        dataObj[ aimID ][ cgiT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ]);
                                                        
                                                        tmp = '<tr class="' + ((thisNo % 2 == 0)? 'odd' : 'even') + '">';
                                                        
                                                        tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                        tmp += '<td id="num-' + thisNo + '">' + dataObj[ aimID ][ cgiTNum ] + '</td>';
                                                                                                                
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                        formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].userDefined = "1";
                                                        formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;

                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        
                                                        var arr = [];
                                                        $('#' + aimID + '-idList option').each(function() {
                                                            arr.push($(this).val());
                                                        });
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].num = arr.length;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].idList = arr.join(';');
                                                        formObj.num         = dataObj[ aimID ][ cgiT ][ thisNo ].num;
                                                        formObj.idList    = dataObj[ aimID ][ cgiT ][ thisNo ].idList;
                                                        
                                                        tmp += '<td id="groupName-' + thisNo +'" colspan="4" class="alignLeft">';
                                                        tmp +=     '<div class="tooltipAccordion">';
                                                        tmp +=        '<h4><a href="#">' + dataObj[ aimID ][ cgiT ][ thisNo ].name + '</a></h4>';
                                                        tmp +=        '<div id="div-groupName-' + thisNo + '">';
                                                        tmp +=            tooltipTable( aimID, 'groupName-' + thisNo,    dataObj[ aimID ][ cgiT ][ thisNo ].idList);
                                                        tmp +=        '</div>';
                                                        tmp +=     '</div>';
                                                        tmp += '</td>';
                                                        
                                                        tmp += '<td class="buttonTD">';
                                                        tmp +=     '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                        tmp +=     '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                        tmp += '</td>';
                                                        tmp += '</tr>';
                                                        
                                                        
                                                        formObj.action    = "0";                                                        
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        /* should be move insiide callback */
                                                            
                                                        $(tableID).append(tmp);
                                                        $('.tooltipAccordion').accordion({
                                                            collapsible:true, 
                                                            active:false, 
                                                            autoHeight: false
                                                        });
                                                        
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                        });
                                        
                                        tmp = "";                                
                                        for (var i=0; i < parseInt(dataObj.service.guiServiceTNum); i++)
                                            tmp += '<option value="' + dataObj.service.guiServiceT[i].gid + '">' + dataObj.service.guiServiceT[i].name + '</option>';
                                        $('#' + aimID + '-idListPool').append(tmp);
                                    });
                                    break;
                                    
                                default:
                                
                                    $('#dialog').load('forms/' + aimID + '.html .dialogForm', function() {
                                        switch(aimID)
                                        {
    
                                        // interface
                                        case 'lan':
                                            cgiPostID = 'lan';
                                            cgiT = 'guiLanIfT';
                                            cgiTNum = 'guiLanIfTNum';
                                            var dhcpsT = 'guiDhcpsT';
                                            var dhcpsTNum = 'guiDhcpsTNum';
                                            var ipAliasT = 'guiIpAliasT';
                                            var ipAliasTNum = 'guiIpAliasTNum';
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        calcObj = {};
                                                        
                                                        if ($('#' + aimID + '-name').val().length == 0) {
                                                            isPass = false;
                                                            $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#' + aimID + '-name').focus();
                                                        }
                                                        
                                                        if (isNaN(parseInt($('#' + aimID + '-ipv6PrefixLength').val())) || parseInt( $('#' + aimID + '-ipv6PrefixLength').val() ) < 0 || parseInt( $('#' + aimID + '-ipv6PrefixLength') > 64 ) ) {
                                                            $('#' + aimID + '-ipv6PrefixLength').parents('td').append('<label class="errorLabel" for="' + aimID + '-ipv6PrefixLength"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-ipv6PrefixLength').focus();
                                                            isPass = false; 
                                                        }
                                                        
                                                        if ($('#' + aimID + '-address').val().length > 0 || $('#' + aimID + '-netmask').val().length > 0) {
                                                            if (regIpv4.test($('#' + aimID + '-address').val())) {
                                                            
                                                                calcObj.arr = $('#' + aimID + '-address').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-address').parents('td').append('<label class="errorLabel" for="' + aimID + '-address"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-address').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-address').parents('td').append('<label class="errorLabel" for="' + aimID + '-address"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-address').focus();
                                                                isPass = false; 
                                                            }
                                                            if (regIpv4.test($('#' + aimID + '-netmask').val())) {
                                                                calcObj.arr = $('#' + aimID + '-netmask').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-netmask"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-netmask').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-netmask').focus();
                                                                isPass = false; 
                                                            }
                                                        }
                                                        
                                                        switch(parseInt($('#' + dhcpsT +'-type').val()))
                                                        {
                                                        case 1:
                                                            
                                                            calcObj.start = [];
                                                            calcObj.end     = [];
                                                            if (regIpv4.test($('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').val())) {
                                                                calcObj.arr = $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').parents('td').append('<label class="errorLabel" for="' +dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() +    '-startIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    case false:
                                                                        calcObj.start.push( parseInt(calcObj.arr[i]) );
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            
                                                            if (regIpv4.test($('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').val())) {
                                                                calcObj.arr = $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' +dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() +    '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    case false:
                                                                        calcObj.end.push( parseInt(calcObj.arr[i]) );
                                                                        
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                isPass = false; 
                                                            }
                                                        
                                                            if (isPass) {
                                                                if (calcObj.start[0] > calcObj.end[0]) {
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                        isPass = false;
                                                                }else if (calcObj.start[0]== calcObj.end[0]) {
                                                                    if (calcObj.start[1] > calcObj.end[1]) {
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                            isPass = false;
                                                                    }else if (calcObj.start[1] == calcObj.end[1]) {
                                                                        if (calcObj.start[2] > calcObj.end[2]) {
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                            if (isPass)
                                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                                isPass = false;
                                                                        }else if ( calcObj.start[2] == calcObj.end[2]) {
                                                                            if ( calcObj.start[3] > calcObj.end[3] ) {
                                                                                $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                                if (isPass)
                                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                                    isPass = false;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            
                                                            if (regIpv4.test($('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').val())) {
                                                                calcObj.arr = $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').parents('td').append('<label class="errorLabel" for="' +dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() +    '-gateway"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').focus();
                                                                isPass = false; 
                                                            }
                                                            break;
                                                        case 2:
                                                            if (regIpv4.test($('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').val())) {
                                                                calcObj.arr = $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').parents('td').append('<label class="errorLabel" for="' +dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() +    '-relayIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                                
                                                            }else {
                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').focus();
                                                                isPass = false; 
                                                            }
                                                            break; 
                                                        }
                                                        
                                                        if (isPass) {
                                                            
                                                            var trNo = $(tableBD + ' tr').length + 1;
        
                                                            var tmp = '<tr class="' + ((trNo % 2 == 1)? 'odd' : 'even') + '">';
                                                         
                                                            thisNo = parseInt( dataObj[ aimID ][ cgiTNum ] );
                                                                                                                    
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ][ cgiT ]) ;
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ][ ipAliasT ] );
                                                            dataObj[ aimID ][ dhcpsT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ][ dhcpsT ]);
                                                            
                                                            dataObj[ aimID ][ cgiTNum ]++;
                                                            dataObj[ aimID ][ ipAliasTNum ]++;
                                                            dataObj[ aimID ][ dhcpsTNum ]++;
                                                         
                                                            var arr = [];
                                                            var ints = [];
                                                         
                                                            for (var node in dataObj[ aimID ][ cgiT ][ thisNo ])
                                                            {
                                                                switch( node )
                                                                {
                                                                case 'gid':
                                                                case 'dhcpPool':
                                                                    break;
                                                                case 'name':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'address':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'netmask':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'stp':
                                                                    switch( $('#' + aimID + '-' + node).is(':checked') )
                                                                    {
                                                                    case true:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "1";
                                                                        break;
                                                                    case false:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "0";
                                                                        break;
                                                                    }
                                                                    break;
                                                                case 'interfaces':
                                                                    
                                                                    $('#' + aimID + '-' + node + ' option').each( function() {
                                                                        arr.push($(this).val());
                                                                        ints.push($(this).text());
                                                                    });
                                                                    
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = arr.join(';');
                                                                    
                                                                    break;
                                                                case 'zone':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'ipv6Address':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'ipv6PrefixLength':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'cgiAction':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "1";
                                                                    break;
                                                                }
                                                            }
                                                            

                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].address = "";
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask = "";
                                                            for (var i=0, len=cgiIpAlias.length, max=cgiIpAlias.length; i<len; i++) 
                                                            {
                                                                switch(i==max)
                                                                {
                                                                case true:
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].address += cgiIpAlias[ i ].address;
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask += cgiIpAlias[ i ].netmask;
                                                                    break;
                                                                case false:
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].address += cgiIpAlias[ i ].address + ';';
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask += cgiIpAlias[ i ].netmask + ';';
                                                                    break;
                                                                }
                                                            }
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].ipAliasCnt = cgiIpAlias.length;
                                                            
                                                            for (var node in dataObj[ aimID ][ dhcpsT ][ thisNo ])
                                                            {
                                                                switch(node) 
                                                                {
                                                                case 'gid':
                                                                    break;
                                                                case 'type':
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#guiDhcpsT-type').val();
                                                                    break;
                                                                case 'relayIp':
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#guiDhcpsT-type-2-' + node ).val();
                                                                    break;
                                                                default:
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#guiDhcpsT-type-1-' + node ).val();
                                                                    
                                                                }
                                                            }
                                                         
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            tmp += '<td id="name-' + thisNo + '">' + $('#lan-name').val() + '</td>';
                                                            tmp += '<td id="address-' + thisNo + '">' + $('#lan-address').val() + '</td>';
                                                            tmp += '<td id="dhcpPool-' + thisNo + '"></td>';
                                                            tmp += '<td id="interfaces-' + thisNo + '">' + ints.join(';') + '</td>';
                                                            tmp += '<td id="zone-' + thisNo + '">' + $('#lan-zone option:selected').text() + '</td>';
                                                            
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            
                                                            $(tableID).append(tmp);
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                        
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });                                            
                                                                                
                                            genAliasTable(aimID);
        
                                            cgiSelectOption(aimID + '-zone');
                                                                                    
                                            for (var x in cgiGids.common_portIf_list)                                         
                                                $('#' + aimID + '-interfacesPool').append('<option value="' + x    + '">' + cgiGids.common_portIf_list[ x ] + '</option>');
                                            
                                            for (var x in cgiGids.common_vlanIf_list)
                                                $('#' + aimID + '-interfacesPool').append('<option value="' + x    + '">' + cgiGids.common_vlanIf_list[ x ] + '</option>');
                                            
                                            $('#' + aimID + '-ipv6Address').val( "::" );
                                            $('#' + aimID + '-ipv6PrefixLength').val( "0" );
                                            
                                            $('#guiDhcpsT-type').append(genSelectOption('guiDhcpsT-type')).val( "0" ).trigger('change'); 
        
                                            
                                            $('#div-ip_alias button').prop('disabled', true);
                                            
                                            popTabs = $('.tabs').tabs();
                                            
                                            if (parseInt(cgiRef.routing.protoType) != 3)
                                               popTabs.tabs({"disabled": [2]});
                                            
        
                                            break;
                                        case 'vlan_interfaces':
                                            cgiGetID = 'vlan';
                                            cgiPostID = 'vlan';
                                            cgiT = 'guiVlanIfT';
                                            cgiTNum = 'guiVlanIfTNum';
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        calcObj = {};
                                                        if ($('#' + aimID + '-name').val().length == 0) {
                                                            isPass = false;
                                                            $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#' + aimID + '-name').focus();
                                                        }
                                                        
                                                        if (isNaN(parseInt($('#' + aimID + '-vid').val())) || parseInt($('#' + aimID + '-vid').val()) < 1 || parseInt( $('#' + aimID + '-vid').val() ) > 4094) {
                                                            $('#' + aimID + '-vid').parents('td').append('<label class="errorLabel" for="' + aimID + '-vid"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-vid').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            // tell if vid unique in this interface
                                                            for (var x in dataObj[ aimID ][ cgiT ])
                                                            {
                                                                if ($('#' + aimID + '-interface').val() == dataObj[ aimID ][ cgiT ][ x ].interface) {
                                                                    if ($('#' + aimID + '-vid').val() == dataObj[ aimID ][ cgiT ][ x ].vid) {
                                                                        $('#' + aimID + '-vid').parents('td').append('<label class="errorLabel" for="' + aimID + '-vid"><span class="error">must be unique</span></label>');
                                                                        isPass = false;
                                                                        $('#' + aimID + '-vid').focus();
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        
                                                        if (isNaN(parseInt($('#' + aimID + '-ipv6PrefixLength').val())) || parseInt( $('#' + aimID + '-ipv6PrefixLength').val() ) < 0 || parseInt( $('#' + aimID + '-ipv6PrefixLength') > 128 ) ) {
                                                            $('#' + aimID + '-ipv6PrefixLength').parents('td').append('<label class="errorLabel" for="' + aimID + '-ipv6PrefixLength"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-ipv6PrefixLength').focus();
                                                            isPass = false; 
                                                        }
                                                        
                                                        if ($('#' + aimID + '-address').val().length > 0 || $('#' + aimID + '-netmask').val().length > 0) {
                                                            if (regIpv4.test($('#' + aimID + '-address').val())) {
                                                            
                                                                calcObj.arr = $('#' + aimID + '-address').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-address').parents('td').append('<label class="errorLabel" for="' + aimID + '-address"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-address').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-address').parents('td').append('<label class="errorLabel" for="' + aimID + '-address"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-address').focus();
                                                                isPass = false; 
                                                            }
                                                            if (regIpv4.test($('#' + aimID + '-netmask').val())) {
                                                                calcObj.arr = $('#' + aimID + '-netmask').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-netmask"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-netmask').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-netmask').focus();
                                                                isPass = false; 
                                                            }
                                                        }
                                                        
                                                        $('input[name=mtuMode]').each(function() {
                                                            if ($(this).is(':checked') && parseInt($(this).val()) == 1) {
                                                                if (isNaN( parseInt($('#' + aimID + '-mtuValue').val()) ) || parseInt($('#' + aimID + '-mtuValue').val()) < 64 || parseInt($('#' + aimID + '-mtuValue').val()) > 1500 ) {
                                                                  $('#' + aimID + '-mtuValue').parents('td').append('<label class="errorLabel" for="' + aimID + '-mtuValue"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-mtuValue').focus();
                                                                    isPass = false;   
                                                                }
                                                            }
                                                        });
                                                        
                                                        switch(parseInt( $('#' + aimID + 'dhcpType') ) )
                                                        {
                                                        case 1:
                                                            if (regIpv4.test($('#' + aimID + '-dhcpType-1-startIp').val())) {
                                                                calcObj.arr = $('#' + aimID + '-dhcpType-1-startIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-dhcpType-1-startIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-startIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-dhcpType-1-startIp').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-dhcpType-1-startIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-startIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dhcpType-1-startIp').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            if (regIpv4.test($('#' + aimID + '-dhcpType-1-endIp').val())) {
                                                                calcObj.arr = $('#' + aimID + '-dhcpType-1-endIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-dhcpType-1-endIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-startIp"><endIp class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-dhcpType-1-endIp').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-dhcpType-1-endIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-endIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dhcpType-1-endIp').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            if (regIpv4.test($('#' + aimID + '-dhcpType-1-gateway').val())) {
                                                                calcObj.arr = $('#' + aimID + '-dhcpType-1-gateway').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-dhcpType-1-gateway').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-gateway"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-dhcpType-1-gateway').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-dhcpType-1-gateway').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-gateway"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dhcpType-1-gateway').focus();
                                                                isPass = false; 
                                                            }
                                                            break;
                                                        case 2:
                                                            if (regIpv4.test($('#' + aimID + '-dhcpType-2-relayIp').val())) {
                                                                calcObj.arr = $('#' + aimID + '-dhcpType-2-relayIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-dhcpType-2-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-2-relayIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-dhcpType-2-relayIp').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-dhcpType-2-relayIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-2-relayIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dhcpType-2-relayIp').focus();
                                                                isPass = false; 
                                                            }
                                                            break;
                                                        }
                                                        
                                                        if (isPass) {
                                                            
                                                            var trNo = $(tableBD + ' tr').length + 1;
        
                                                            var tmp = '<tr class="' + ((trNo % 2 == 1)? 'odd' : 'even') + '">';
                                                         
                                                            thisNo = parseInt( dataObj[ aimID ][ cgiTNum ] );
                                                            
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            
                                                            dataObj[ aimID ][ cgiTNum ] = thisNo + 1;
                                                            dataObj[ aimID ].guiIpAliasTNum = dataObj[ aimID ][ cgiTNum ];
                                                            dataObj[ aimID ].guiDhcpsTNum = dataObj[ aimID ][ cgiTNum ];
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = {};
                                                            dataObj[ aimID ].guiIpAliasT[ thisNo ] = {};
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ] = {};
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].port = dataObj[ aimID ][ cgiTNum ];
                                                            tmp += '<td id="port-' + thisNo + '">' + dataObj[ aimID ][ cgiTNum ] + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                            tmp += '<td id="name-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].name + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].type = 0;
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].interface = $('#' + aimID + '-interface').val();
                                                            tmp += '<td id="interface-' + thisNo + '">' + $('#' + aimID + '-interface').val()+ '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].vid = $('#' + aimID + '-vid').val();
                                                            tmp += '<td id="vid-' + thisNo + '">' + $('#' + aimID + '-vid').val() + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].address = $('#' + aimID + '-address').val();
                                                            tmp += '<td id="address-' + thisNo + '">' + $('#' + aimID + '-address').val() + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].netmask = $('#' + aimID + '-netmask').val();
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].dhcpType = $('#' + aimID + '-dhcptype').val();     
                                                                                                             
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].dhcpPool = "";
                                                            tmp += '<td id="dhcpPool-' + thisNo + '"></td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].mtuMode = $('input[name=mtuMode]:checked').val();
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].mtuValue = $('#' + aimID + '-mtuValue').val();
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].zone = $('#' + aimID + '-zone').val();
                                                            tmp += '<td id="zone-' + thisNo + '">' + cgiHash[ $('#' + aimID + '-zone').val() ] + '</td>';
                                                                                                                    
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "1";
                                                            
                                                            // ipalias

                                                            
                                                            dataObj[ aimID ].guiIpAliasT[ thisNo ].address = "";
                                                            dataObj[ aimID ].guiIpAliasT[ thisNo ].netmask = "";
                                                            for (var i=0, len=cgiIpAlias.length, max=cgiIpAlias.length-1; i<len; i++) 
                                                            {
                                                                switch(i==max)
                                                                {
                                                                case true:
                                                                    dataObj[ aimID ].guiIpAliasT[ thisNo ].address += cgiIpAlias[ i ].address;
                                                                    dataObj[ aimID ].guiIpAliasT[ thisNo ].netmask += cgiIpAlias[ i ].netmask;
                                                                    break;
                                                                case false:
                                                                    dataObj[ aimID ].guiIpAliasT[ thisNo ].address += cgiIpAlias[ i ].address + ';';
                                                                    dataObj[ aimID ].guiIpAliasT[ thisNo ].netmask += cgiIpAlias[ i ].netmask + ';';
                                                                    break;
                                                                }
                                                            }
                                                            dataObj[ aimID ].guiIpAliasT[ thisNo ].ipAliasCnt = cgiIpAlias.length;
                                                            
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].gid         = "0";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].type        = $('#' + aimID + '-dhcpType').val();
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].startIp     = $('#' + aimID + '-dhcpType-1-startIp').val()   || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].endIp       = $('#' + aimID + '-dhcpType-1-endIp').val()     || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].relayIp     = $('#' + aimID + '-dhcpType-2-relayIp').val()   || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].leaseTime   = $('#' + aimID + '-dhcpType-1-leaseTime').val() || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].gateway     = $('#' + aimID + '-dhcpType-1-gateway').val()   || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].dns1        = $('#' + aimID + '-dhcpType-1-dns1').val()      || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].dns2        = $('#' + aimID + '-dhcpType-1-dns2').val()      || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].wins1       = $('#' + aimID + '-dhcpType-1-wins1').val()     || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].wins2       = $('#' + aimID + '-dhcpType-1-wins2').val()     || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].domainName  = $('#' + aimID + '-dhcpType-1-domainName').val()|| "";
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            genAliasTable(aimID);
                                            
                                            $('#' + aimID + '-interface').append( genSelectOption( aimID + '-interface') );
                                            cgiSelectOption(aimID + '-zone');
                                            
                                            
                                            $('input[name=mtuMode]').eq(0).prop("checked", true).trigger('click');
                                            $('#' + aimID + '-mtuValue').val("1500");
                                            
                                            $('#div-ip_alias button').prop('disabled', true);
                                            
                                            $('#' + aimID + '-dhcpType').append(genSelectOption(aimID + '-dhcpType')).val(0).trigger('change');
                                            
                                            $('#' + aimID + '-ipv6PrefixLength').val(0);
                                            
                                            popTabs = $('.tabs').tabs();
                                            
                                            if (parseInt(cgiRef.routing.protoType) != 3)
                                               popTabs.tabs({"disabled": [2]});
                                            
                                            break;
                                        case 'wan':
                                            cgiGetID = 'wan';
                                            cgiPostID = 'wan';
                                            cgiT = 'wanIpIfT';
                                            cgiTNum = dataObj[ aimID ][ cgiT ].length;
                                            thisNo = cgiTNum;
                                            var ipAliasT = 'ipAliasT';
                                            var staticipT = 'staticipT';
                                            var dhcpcT = 'dhcpcT';
                                            var staticip6T = 'staticip6T';
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        calcObj = {};
                                                        if (parseInt( $('#' + cgiT + '-wanProto').val() ) == 0) {
                                                            if (regIpv4.test($('#staticipT-ip').val())) {
                                                                calcObj.arr = $('#staticipT-ip').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#staticipT-ip').parents('td').append('<label class="errorLabel" for="staticipT-ip"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#staticipT-ip').focus();
                                                                        isPass = false;
                                                                        break;
            
                                                                    }
                                                                }
                                                            }else {
                                                                $('#staticipT-ip').parents('td').append('<label class="errorLabel" for="staticipT-ip"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#staticipT-ip').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            if (regIpv4.test($('#staticipT-netmask').val())) {
                                                                calcObj.arr = $('#staticipT-netmask').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#staticipT-netmask').parents('td').append('<label class="errorLabel" for="staticipT-netmask"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#staticipT-netmask').focus();
                                                                        isPass = false;
                                                                        break;
            
                                                                    }
                                                                }
                                                            }else {
                                                                $('#staticipT-netmask').parents('td').append('<label class="errorLabel" for="staticipT-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#staticipT-netmask').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            if (regIpv4.test($('#staticipT-gateway').val())) {
                                                                calcObj.arr = $('#staticipT-gateway').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#staticipT-gateway').parents('td').append('<label class="errorLabel" for="staticipT-gateway"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#staticipT-gateway').focus();
                                                                        isPass = false;
                                                                        break;
            
                                                                    }
                                                                }
                                                            }else {
                                                                $('#staticipT-gateway').parents('td').append('<label class="errorLabel" for="staticipT-gateway"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#staticipT-gateway').focus();
                                                                isPass = false; 
                                                            }
                                                        }
                                                        
                                                        
                                                        $('input[name=mtuMode]').each(function() {
                                                            if ($(this).is(':checked') && parseInt($(this).val()) == 1) {
                                                                if (isNaN( parseInt($('#mtu').val()) ) || parseInt($('#mtu').val()) < 64 || parseInt($('#mtu').val()) > 1500 ) {
                                                                  $('#mtu').parents('td').append('<label class="errorLabel" for="mtu"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#mtu').focus();
                                                                    isPass = false;   
                                                                }
                                                            }
                                                        });
                                                        
                                                        $('input[name=macColneEnable]').each(function() {
                                                            if ($(this).is(':checked') && parseInt($(this).val()) == 1) {
                                                                if (!regMac.test( $('#macClone').val() )) {
                                                                  $('#macClone').parents('td').append('<label class="errorLabel" for="macClone"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#macClone').focus();
                                                                    isPass = false;   
                                                                }
                                                            }
                                                        });
                                                        
                                                        
                                                        if (isPass) {
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ][ cgiT ]); 
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ][ ipAliasT ]);
                                                            dataObj[ aimID ][ staticipT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ][ staticipT ]);
                                                            dataObj[ aimID ][ dhcpcT ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ][ dhcpcT ]);
                                                            dataObj[ aimID ][ staticip6T ][ thisNo ] = $.extend({}, cgiRef.tmpl[ aimID ][ staticip6T ]);
                                                                                                                    
                                                            for (var node in dataObj[ aimID ].wanIpIfT[ thisNo ])
                                                            {
                                                                switch(node)
                                                                {
                                                                case 'name':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + cgiT + '-' + node).html();
                                                                    cgiRef[ aimID ].free[ dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ] = false;
                                                                    cgiRef[ aimID ].wan.push( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] );
                                                                    break;
                                                                case 'gid':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "0";
                                                                    break;
                                                                case 'wanProto':
                                                                    
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + cgiT + '-' + node).val();
                                                                    
                                                                    switch($('#' + cgiT + '-' + node).val())
                                                                    {
                                                                    case '0':
                                                                        dataObj[ aimID ].staticipT[ thisNo ].ip = $('#staticipT-ip').val();
                                                                        dataObj[ aimID ].staticipT[ thisNo ].netmask = $('#staticipT-netmask').val();
                                                                        dataObj[ aimID ].staticipT[ thisNo ].gateway = $('#staticipT-gateway').val();
                                                                        
                                                                        $('input[name=mtuMode]').each(function() {
                                                                            switch($(this).is(':checked'))
                                                                            {
                                                                            case true:
                                                                                dataObj[ aimID ].staticipT[ thisNo ].mtuMode = $(this).val();
                                                                                switch($(this).val())
                                                                                {
                                                                                case '0':
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].mtu = 1500;
                                                                                    break;
                                                                                case '1':
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].mtu = $('#mtu').val();
                                                                                    break;
                                                                                }
                                                                                break;
                                                                            }
                                                                        });
                                                                        $('input[name=dnsMode]').each(function() {
                                                                            switch($(this).is(':checked'))
                                                                            {
                                                                            case true:
                                                                                dataObj[ aimID ].staticipT[ thisNo ].dnsMode = $(this).val();
                                                                                switch($(this).val())
                                                                                {
                                                                                case '0':
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].userDns1 = "";
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].userDns2 = "";
                                                                                    break;
                                                                                case '1':
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].userDns1 = $('#userDns1').val();
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].userDns2 = $('#userDns2').val();
                                                                                    break;
                                                                                }
                                                                                break;
                                                                            }
                                                                        });
                                                                        break;
                                                                    case '1':
                                                                        
                                                                        $('input[name=mtuMode]').each(function() {
                                                                            switch($(this).is(':checked'))
                                                                            {
                                                                            case true:
                                                                                dataObj[ aimID ].dhcpcT[ thisNo ].mtuMode = $(this).val();
                                                                                switch($(this).val())
                                                                                {
                                                                                case '0':
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].mtu = "1500";
                                                                                    break;
                                                                                case '1':
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].mtu = $('#mtu').val();
                                                                                    break;
                                                                                }
                                                                                break;
                                                                            }
                                                                        });
                                                                        $('input[name=dnsMode]').each(function() {
                                                                            switch($(this).is(':checked'))
                                                                            {
                                                                            case true:
                                                                                dataObj[ aimID ].dhcpcT[ thisNo ].dnsMode = $(this).val();
                                                                                switch($(this).val())
                                                                                {
                                                                                case '0':
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].userDns1 = "";
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].userDns2 = "";
                                                                                    break;
                                                                                case '1':
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].userDns1 = $('#userDns1').val();
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].userDns2 = $('#userDns2').val();
                                                                                    break;
                                                                                }
                                                                                break;
                                                                            }
                                                                        });
                                                                        break;
                                                                    }
                                                                    break;
                                                                case 'weight':
                                                                case 'portId':
                                                                case 'zoneId':
                                                                    dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $('#wanIpIfT-' + node).val();
                                                                    tmp += '<td id="' + node + '-' + trNo + '">' + $('#wanIpIfT-' + node + ' option:selected').text() + '</td>';
                                                                    break;
                                                                case 'backupWanNam':
                                                                    dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $('#wanIpIfT-' + node).val();
                                                                    tmp += '<td id="' + node + '-' + trNo + '">' + $('#wanIpIfT-' + node + ' option:selected').text() + '</td>';
                                                                    break;
                                                                case 'macCloneEnable':
                                                                    $('input[name=' + node + ']').each(function() {
                                                                        switch($(this).is(':checked'))
                                                                        {
                                                                        case true:
                                                                            dataObj[ aimID ].wanIpIfT[ thisNo ].macCloneEnable = $(this).val();
                                                                            switch($(this).val())
                                                                            {
                                                                            case '0':
                                                                                dataObj[ aimID ].wanIpIfT[ thisNo ].macClone = "";
                                                                                break;
                                                                            case '1':
                                                                                dataObj[ aimID ].wanIpIfT[ thisNo ].macClone = $('#macClone').val();
                                                                                break;
                                                                            }
                                                                            break;
                                                                        }
                                                                    });
                                                                    break;
                                                                case 'netDetectEnable':
                                                                case 'failoverEnable':
                                                                    switch($('#wanIpIfT-' + node).is(':checked'))
                                                                    {
                                                                    case true:
                                                                        dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = "1";
                                                                        break;
                                                                    case false:
                                                                        dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = "0";
                                                                        break;
                                                                    }
                                                                    break;
                                                                case 'netDetectMethod':
                                                                    $('input[name=wanIpIfT-' + node + ']').each(function() {
                                                                        switch($(this).is(':checked'))
                                                                        {
                                                                        case true:
                                                                            dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $(this).val();
                                                                            break;
                                                                        }
                                                                    });
                                                                    break;
                                                                case 'wanProto_v6':
                                                                    dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $('#wanIpIfT-' + node).val();
                                                                    for (var x in dataObj[ aimID ].staticip6T[ thisNo ]) {
                                                                        switch( x)
                                                                        {
                                                                        case 'gid':
                                                                            break;
                                                                        default:
                                                                            switch(parseInt( $('#wanIpIfT-' + node).val() ))
                                                                            {
                                                                            case 0:
                                                                                dataObj[ aimID ].staticip6T[ thisNo ][ x ] = $('#wanIpIfT-wanProto_v6-' + $('#wanIpIfT-' + node).val() + '-' + x).val();
                                                                                break;
                                                                            default:
                                                                                dataObj[ aimID ].staticip6T[ thisNo ][ x ] = "";
                                                                            }
                                                                        }
                                                                    }
                                                                    
                                                                    break;
                                                                case 'backupWanName':
                                                                    if ($('#' + cgiT + '-' + node).val() == 'selectOption')
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "";
                                                                    else 
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + cgiT + '-' + node).val();
                                                                    break;
                                                                default:
                                                                    if ($('#' + cgiT + '-' + node).length > 0)
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + cgiT + '-' + node).val();
                                                                }
                                                            }
                                                            // ipalias
                                                            
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].address = "";
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask = "";
                                                            for (var i=0, len=cgiIpAlias.length, max=cgiIpAlias.length-1; i<len; i++) 
                                                            {
                                                                switch(i==max)
                                                                {
                                                                case true:
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].address += cgiIpAlias[ i ].address;
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask += cgiIpAlias[ i ].netmask;
                                                                    break;
                                                                case false:
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].address += cgiIpAlias[ i ].address + ';';
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask += cgiIpAlias[ i ].netmask + ';';
                                                                    break;
                                                                }
                                                            }
                                                            
                                                            
                                                            dataObj[ aimID ].wanIpIfT[ thisNo ].cgiAction = "1";

                                                            var trNo = $(tableBD + ' tr').length + 1;
                                                            var tmp = '<tr class="' + ((trNo % 2 == 1)? 'odd' : 'even') + '">';
                                                         
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            tmp += '<td id="name-' + thisNo + '">' + $('#wanIpIfT-name').html() + '</td>';
                                                            tmp += '<td id="wanProto-' + thisNo + '">' + $('#wanIpIfT-wanProto option:selected').text() + '</td>';
                                                            tmp += '<td id="address-' + thisNo + '">' + ((parseInt($('#wanIpIfT-wanProto').val()) == 0)? $('#staticipT-ip').val() : "" )+ '</td>';
                                                            tmp += '<td id="portId-' + thisNo + '">' + $('#wanIpIfT-portId option:selected').text() + '</td>';
                                                            tmp += '<td id="weight-' + thisNo + '">' + $('#wanIpIfT-weight option:selected').text() + '</td>';
                                                             
                                                            
                                                            tmp += '<td id="backupWanName-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].backupWanName + '</td>';
                                                            tmp += '<td id="zoneId-' + thisNo + '">' + $('#wanIpIfT-zoneId option:selected').text() + '</td>';
                                                            
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            
                                                            $(tableID).append(tmp);
                                                        
                                                            // check if still wan left
                                                            var freez = true;
                                                            for (var x in cgiRef[ aimID ].free)
                                                            {
                                                                if (cgiRef[ aimID ].free[ x ] )
                                                                    freez = false;
                                                            }
                                                            
                                                            if (freez)
                                                                $('#Create-wan').prop('disabled', true);
                                                        
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            genAliasTable(aimID);
                                            $('.tabs').tabs();
                                            
                                            for (var node in cgiRef.tmpl[ aimID ][ cgiT ])
                                            {
                                                switch(node)
                                                {
                                                case 'gid':
                                                
                                                    break;
                                                case 'name':
                                                    for (var x in cgiRef[ aimID ].free)
                                                    {
                                                        if (cgiRef[ aimID ].free[ x ]) {
                                                            $('#' + cgiT + '-' + node).html( x );
                                                            break;
                                                        }
                                                    }
                                                    break;
                                                case 'portId':
                                                    $('#' + cgiT + '-' + node).append( genSelectOption( cgiT + '-' + node) );
                                                    break;
                                                case 'zoneId':
                                                    cgiSelectOption( cgiT + '-' + node);
                                                    break;
                                                case 'wanProto':
                                                    $('#' + cgiT + '-' + node).append( genSelectOption( cgiT + '-'+node) ).val( cgiRef.tmpl[ aimID ][ cgiT ][ node ] ).trigger('change');
        
                                                    switch( cgiRef.tmpl[ aimID ][ cgiT ][ node ])
                                                    {
                                                    case '0':
                                                        $('#staticipT-ip').val( cgiRef.tmpl[ aimID ].staticipT.ip );
                                                        $('#staticipT-netmask').val( cgiRef.tmpl[ aimID ].staticipT.netmask );
                                                        $('#staticipT-gateway').val( cgiRef.tmpl[ aimID ].staticipT.gateway );
                                                        $('#mtu').val( cgiRef.tmpl[ aimID ].staticipT.mtu);
                                                        $('#userDns1').val( cgiRef.tmpl[ aimID ].staticipT.userDns1);
                                                        $('#userDns2').val( cgiRef.tmpl[ aimID ].staticipT.userDns2);
                                                        $('input[name=mtuMode]').each(function() {
                                                            switch($(this).val() == cgiRef.tmpl[ aimID ].staticipT.mtuMode)
                                                            {
                                                            case true:
                                                                $(this).attr('checked', true).trigger('click');
                                                                break;
                                                            }
                                                        });
                                                        $('input[name=dnsMode]').each(function() {
                                                            switch($(this).val() == cgiRef.tmpl[ aimID ].staticipT.dnsMode)
                                                            {
                                                            case true:
                                                                $(this).attr('checked', true).trigger('click');
                                                                break;
                                                            }
                                                        });
                                                        break;
                                                    case '1':
                                                        $('#mtu').val( cgiRef.tmpl[ aimID ].dhcpcT.mtu);
                                                        $('#userDns1').val( cgiRef.tmpl[ aimID ].dhcpcT.userDns1);
                                                        $('#userDns2').val( cgiRef.tmpl[ aimID ].dhcpcT.userDns2);
                                                        $('input[name=mtuMode]').each(function() {
                                                            switch($(this).val() == cgiRef.tmpl[ aimID ].dhcpcT.mtuMode)
                                                            {
                                                            case true:
                                                                $(this).attr('checked', true).trigger('click');
                                                                break;
                                                            }
                                                        });
                                                        $('input[name=dnsMode]').each(function() {
                                                            switch($(this).val() == cgiRef.tmpl[ aimID ].dhcpcT.dnsMode)
                                                            {
                                                            case true:
                                                                $(this).attr('checked', true).trigger('click');
                                                                break;
                                                            }
                                                        });
                                                        break;
                                                    }
                                                    break;
                                                case 'macCloneEnable':
                                                    $('#macClone').val( cgiRef.tmpl[ aimID ][ cgiT ].macClone);
                                                    $('input[name=' + node + ']').each(function() {
                                                        switch($(this).val() == cgiRef.tmpl[ aimID ][ cgiT ][ node ])
                                                        {
                                                        case true:
                                                            $(this).attr('checked', true).trigger('click');
                                                            break;
                                                        }
                                                    });
                                                    break;
                                                case 'netDetectEnable':
                                                case 'failoverEnable':
                                                    switch( cgiRef.tmpl[ aimID ][ cgiT ][ node ] )
                                                    {
                                                    case '1':
                                                        $('#' + cgiT + '-' + node).attr('checked', true);
                                                        break;
                                                    default:
                                                        $('.' + cgiT + '-' + node + '-checked').prop('disabled', true);
                                                    }
                                                    break;
                                                case 'netDetectMethod':
                                                    $('input[name=' + cgiT + '-' + node + ']').each(function() {
                                                        switch($(this).val() == cgiRef.tmpl[ aimID ][ cgiT ][ node ])
                                                        {
                                                        case true:
                                                            $(this).attr('checked', true);
                                                            break;
                                                        case false:
                                                            $('.' + cgiT + '-' + node + '-' + $(this).val()).prop('disabled', true);
                                                            break;
                                                        }
                                                    });
                                                    break;
                                                case 'netDetectPingIpId':
                                                case 'netDetectDnsIpId':
                                                    $('#' + cgiT + '-' + node).append( genSelectOption( cgiT + '-' + node) ).val( cgiRef.tmpl[ aimID ][ cgiT ][ node ] );
                                                    break;
                                                case 'wanProto_v6':
                                                    $('#' + cgiT + '-' + node).val( cgiRef.tmpl[ aimID ][ cgiT ][ node ]).trigger('change');
                                                    for (var x in cgiRef.tmpl[ aimID ].staticip6T )
                                                        $('#' + cgiT + '-' + node + '-0-' + x).val( cgiRef.tmpl[ aimID ].staticip6T[ x ] );
                                                    break;
                                                case 'backupWanName':
                                                    var tmp = '<option value="selectOption">Select WAN</option>';
                                                    for (var x in cgiRef[ aimID ].wan)
                                                        tmp += '<option value="' + cgiRef[ aimID ].wan[ x ] + '">' + cgiRef[ aimID ].wan[ x ] + '</option>';
                                                    $('#' + cgiT + '-' + node).append( tmp );
                                                    break;
                                                default:
                                                    $('#' + cgiT + '-' + node).val( cgiRef.tmpl[ aimID ][ cgiT ][ node ]);
                                                }
                                            }
                                            break;
                                        case 'zone':
                                            cgiGetID = 'zone';
                                            cgiPostID = 'zone';
                                            cgiT = 'guiZoneIfT';
                                            cgiTNum = 'guiZoneIfTNum';
                                            $('.dialogForm').dialog({
                                                width: 600,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        if ($('#' + aimID + '-name').val().length == 0) {

                                                            isPass = false;
                                                            $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#' + aimID + '-name').focus();
                                                        }
                                                        
                                                        if ($('#' + aimID + '-securityLevel').val().length == 0 || isNaN( parseInt( $('#' + aimID + '-securityLevel').val() ) ) || parseInt( $('#' + aimID + '-securityLevel').val() ) < 0 || parseInt( $('#' + aimID + '-securityLevel').val() ) > 100) {
                                                                
                                                            $('#' + aimID + '-securityLevel').parents('td').append('<label class="errorLabel" for="' + aimID + '-securityLevel"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-securityLevel').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            var trNo = $(tableBD + ' tr').length + 1;
        
                                                            //var tmp = '<tr class="' + ((trNo % 2 == 0)? 'odd' : 'even') + '">';
                                                         
                                                            thisNo = parseInt( dataObj[ aimID ][ cgiTNum ] );
                                                            
                                                            //tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            
                                                            dataObj[ aimID ][ cgiTNum ] = thisNo + 1;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = {};
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].userDefined = "1";
                                                            //tmp += '<td id="name-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].name + '</td>';
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].securityLevel = $('#' + aimID + '-securityLevel').val();
                                                            //tmp += '<td id="securityLevel-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].securityLevel + '</td>';
                                                            
                                                            var arr = [];
                                                            var mems = [];
                                                            $('#' + aimID + '-member option').each( function() {
                                                                arr.push($(this).val());
                                                                mems.push(cgiHash[ $(this).val() ]);
                                                            });
                                                                                                                        
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].memberCnt = arr.length;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].member = arr.join(';');
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "1";
                                                            
                                                            //tmp += '<td id="member-' + thisNo + '">' + mems.join(';') + '</td>';
                                                            //tmp += '<td class="buttonTD">';
                                                            //tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                            //tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                            //tmp += '</td>';
                                                            //tmp += '</tr>';
                                                            //$(tableID).append(tmp);
                                                            
                                                            // reset zone options
                                                            cgiRef.zone.free = [];
                                                            for (var x in dataObj[ aimID ][ cgiT ]) 
                                                            {
                                                                if (x != thisNo) {
                                                                    var arrs = dataObj[ aimID ][ cgiT ][ x ].member.split(';');
                                                                    var news = [];
                                                                    var tag = false;
                                                                    for (var y in arrs)
                                                                    {
                                                                        if (arr.indexOf( arrs[ y ] ) != -1 )
                                                                            tag = true;
                                                                        else if (!isNaN(parseInt( arrs[ y] )))
                                                                            news.push(arrs[ y ]);
                                                                    }
                                                                    
                                                                    if (tag) {
                                                                        dataObj[ aimID ][ cgiT ][ x ].member = news.join(';');
                                                                        if (parseInt(dataObj[ aimID ][ cgiT ][ x ].gid) > 0)
                                                                            dataObj[ aimID ][ cgiT ][ x ].cgiAction = "2";
                                                                    }
                                                                }
                                                            }
                                                            
                                                            $( this ).dialog( "close" );
                                                            
                                                            cgiRedraw(aimID);
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
        
                                            for (var x in cgiHash)
                                            {
                                                $('#' + aimID + '-memberPool').append('<option value="' + x + '">' + cgiHash[ x ] + '</option>');
                                            }
        
                                            break;
                                        // Firewall
                                        case 'rules':
                                            cgiGetID = 'rules';
                                            cgiPostID = 'rules';
                                            cgiT = 'guiRulesT';
                                            cgiTNum = 'guiRulesTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();                                                        
    
                                                        if (isPass) {
                                                            var trNo = $(tableBD + ' tr').length + 1;
        
                                                            var tmp = '<tr class="'
                                                            tmp += ((trNo % 2 == 0)? 'odd' : 'even');
                                                            if (!isNaN(parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].fromZone)))
                                                                tmp += ' fromZone' + dataObj[ aimID ][ cgiT ][ thisNo ].fromZone;
                                                            if (!isNaN(parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].toZone)))
                                                                tmp += ' toZone' + dataObj[ aimID ][ cgiT ][ thisNo ].toZone;
                                                            tmp += '">';
                                                         
                                                            thisNo = parseInt( dataObj[ aimID ][ cgiTNum ] );
                                                            
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            tmp += '<td id="priority-' + thisNo + '">' + trNo + '</td>';
                                                            dataObj[ aimID ][ cgiTNum ] = thisNo + 1;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = {};
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                            
                                                            switch( $('#' + aimID + '-enabled').is(':checked') )
                                                            {
                                                            case true:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].enabled = $('#' + aimID + '-enabled').val();
                                                                break;
                                                            case false:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].enabled = "0";
                                                                break;
                                                            }
                                                            tmp += '<td id="enabled-' + thisNo + '">' + cgiRef[ cgiGetID ].enabled[ dataObj[ aimID ][ cgiT ][ thisNo ].enabled ] + '</td>';
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].fromZone = ( $('#' + aimID + '-fromZone').val() == 'selectOption' )? "" : $('#' + aimID + '-fromZone').val();
                                                            tmp += '<td id="fromZone-' + thisNo + '">' + (($('#' + aimID + '-fromZone').val() == "selectOption" ) ? "" : $('#' + aimID + '-fromZone option:selected').text()) + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].toZone = ( $('#' + aimID + '-toZone').val() == 'selectOption' )? "" : $('#' + aimID + '-toZone').val();
                                                            tmp += '<td id="toZone-' + thisNo + '">' + (($('#' + aimID + '-toZone').val() == "selectOption" ) ? "" : $('#' + aimID + '-toZone option:selected').text()) + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].sourceAddress = ( $('#' + aimID + '-sourceAddress').val() == 'selectOption' )? "" : $('#' + aimID + '-sourceAddress').val();
                                                            tmp += '<td id="sourceAddressUser-' + thisNo + '">' + (($('#' + aimID + '-sourceAddress').val() == "selectOption" ) ? "ANY" : $('#' + aimID + '-sourceAddress option:selected').text()) + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].sourceUser ="";
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].destinationAddress = ( $('#' + aimID + '-destinationAddress').val() == 'selectOption' )? "" : $('#' + aimID + '-destinationAddress').val();
                                                            tmp += '<td id="destinationAddressUser-' + thisNo + '">' + (($('#' + aimID + '-destinationAddress').val() == "selectOption" ) ? "ANY" : $('#' + aimID + '-destinationAddress option:selected').text()) + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].destinationUser = "";
                                                            
                                                            tmp += '<td id="serviceApplicationUrl-' + thisNo + '">';
                                                            $('input[name=rules-services]').each( function() {
                                                                console.log($(this).val() + ' @ ' + $(this).is(':checked')); 
                                                                switch($(this).is(':checked'))
                                                                {
                                                                case true:
                                                                console.log($(this).val());
                                                                    switch( parseInt($(this).val()) )
                                                                    {
                                                                    case 2:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].service = "";
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].application ="";
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].url ="";
                                                                        break;
                                                                    case 3:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].service = "";
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].application ="";
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].url ="";
                                                                        break;
                                                                    default:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].service = ( $('#' + aimID + '-service').val() == 'selectOption' )? "" : $('#' + aimID + '-service').val();
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].application ="";
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].url ="";
                                                                        
                                                                        tmp += ( ($('#' + aimID + '-service').val() == 'selectOption')? "Any" : ('#' + aimID + '-service option:selected').text() ) ;
                                                                    }
                                                                    break;
                                                                }
                                                            });
                                                            
                                                            tmp += '</td>';
    
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].schedule = ( $('#' + aimID + '-schedule').val() == 'selectOption' )? "" : $('#' + aimID + '-schedule').val();
                                                            tmp += '<td id="schedule-' + thisNo + '">' + (($('#' + aimID + '-schedule').val() == "selectOption" ) ? "" : $('#' + aimID + '-schedule option:selected').text()) + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].hitCount = "";
                                                            tmp += '<td id="htiCount-' + thisNo + '"></td>';
                                                            
                                                            switch( $('#' + aimID + '-log').is(':checked') )
                                                            {
                                                            case true:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].log = $('#' + aimID + '-log').val();
                                                                break;
                                                            case false:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].log = "0";
                                                                break;
                                                            }
                                                            
                                                            tmp += '<td id="log-' + thisNo + '">' + cgiRef[ cgiGetID ].log[ dataObj[ aimID ][ cgiT ][ thisNo ].log ] + '</td>';
    
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].matchAction = $('#' + aimID + '-matchAction').val();
                                                            tmp += '<td id="matchAction-' + thisNo + '">' + (($('#' + aimID + '-matchAction').val() == "selectOption" ) ? "" : $('#' + aimID + '-matchAction option:selected').text()) + '</td>';
    
    
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "1";
                                                            
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                            tmp += '<button id="MoveUp-' + aimID + '-' + thisNo + '" class="MoveUp"><span class="ui-icon" title="MoveUp"></span></button>';
                                                            tmp += '<button id="MoveDown-' + aimID + '-' + thisNo + '" class="MoveDown"><span class="ui-icon" title="MoveDown"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);
                                                            // push for move sorting
                                                            
                                                            
                                                            cgiRef[ aimID ].move.push(thisNo);
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            $('#' + aimID + '-services-1').attr("checked", true).trigger('click');
                                            
                                            cgiComboSelectOption( aimID + '-fromZone');
                                            cgiComboSelectOption( aimID + '-toZone');
                                            cgiComboSelectOption( aimID + '-service');
                                            cgiComboSelectOption( aimID + '-sourceAddress');
                                            cgiComboSelectOption( aimID + '-destinationAddress');
                                            cgiComboSelectOption( aimID + '-schedule');
                                            $('#' + aimID + '-matchAction').append( genSelectOption( aimID + '-matchAction' ) );
                                            break;
                                        case 'advanced_nat':
                                            cgiGetID = 'advancedNat';
                                            cgiPostID = 'advancedNat';
                                            cgiT = 'guiAdvancedNatT';
                                            cgiTNum = 'guiAdvancedNatTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        isValid = false;
                                                        $('.errorLabel').remove();
                                                                                                                
                                                        switch($('#' + aimID + '-originalSrc').val() != 'selectOption')
                                                        {
                                                        case true:
                                                            switch($('#' + aimID + '-translatedSrc').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                isValid = true;
                                                                break;
                                                            case false:
                                                                $('#' + aimID + '-translatedSrc').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedSrc"><span class="error">translated source address required</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-translatedSrc').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        case false:
                                                            switch($('#' + aimID + '-translatedSrc').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-originalSrc').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalSrc"><span class="error">origianl source address required</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-originalSrc').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        }
                                                        
                                                        switch($('#' + aimID + '-originalDst').val() != 'selectOption')
                                                        {
                                                        case true:
                                                            switch($('#' + aimID + '-translatedDst').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                isValid = true;
                                                                break;
                                                            case false:
                                                                $('#' + aimID + '-translatedDst').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedDst"><span class="error">translated destination address required</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-translatedDst').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        case false:
                                                            switch($('#' + aimID + '-translatedDst').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-originalDst').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalDst"><span class="error">original destination address required</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-originalDst').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        }
                                                        
                                                        switch($('#' + aimID + '-originalService').val() != 'selectOption')
                                                        {
                                                        case true:
                                                            switch($('#' + aimID + '-translatedService').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                switch($('#' + aimID + '-originalDst').val() != 'selectOption')
                                                                {
                                                                case true:
                                                                    switch($('#' + aimID + '-translatedDst').val() != 'selectOption')
                                                                    {
                                                                    case true:
                                                                        switch( cgiTypes[ $('#' + aimID + '-originalService').val() ] == cgiTypes[ $('#' + aimID + '-translatedService').val() ] )
                                                                        {
                                                                        case false:
                                                                            $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">type match fail</span></label>')
                                                                            if (isPass)
                                                                                $('#' + aimID + '-translatedService').focus();
                                                                            isPass = false;
                                                                            break;
                                                                        }
    
                                                                        break;
                                                                    case false:
                                                                        $('#' + aimID + '-translatedDst').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedDst"><span class="error">translated destination address required</span></label>')
                                                                        if (isPass)
                                                                            $('#' + aimID + '-translatedDst').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    }
                                                                    break;
                                                                case false:
                                                                    switch($('#' + aimID + '-translatedDst').val() != 'selectOption')
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-originalDst').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalDst"><span class="error">original destination address required</span></label>')
                                                                        if (isPass)
                                                                            $('#' + aimID + '-originalDst').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    }
                                                                    break;
                                                                }
                                                                break;
                                                            case false:
                                                                $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">type match faill</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-translatedService').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        case false:
                                                            switch($('#' + aimID + '-translatedService').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">type match fail</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-translatedService').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        }
                                                        
                                                        if (isPass) {
                                                            if (isValid) {
                                                                var trNo = $(tableBD + ' tr').length + 1;
            
                                                                var tmp = '<tr class="' + ((trNo % 2 == 0)? 'odd' : 'even') + '">';
                                                             
                                                                thisNo = parseInt( dataObj[ aimID ][ cgiTNum ] );
                                                                
                                                                tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                                tmp += '<td id="seq-' + thisNo + '">' + trNo + '</td>';
                                                                dataObj[ aimID ][ cgiTNum ] = thisNo + 1;
                                                                dataObj[ aimID ][ cgiT ][ thisNo ] = {};
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                                
                                                                switch( $('#' + aimID + '-enabled').is(':checked') )
                                                                {
                                                                case true:
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].enabled = $('#' + aimID + '-enabled').val();
                                                                    break;
                                                                case false:
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].enabled = 0;
                                                                    break;
                                                                }
                                                                tmp += '<td id="enabled-' + thisNo + '">' + cgiRef[ cgiGetID ].enabled[ dataObj[ aimID ][ cgiT ][ thisNo ].enabled ] + '</td>';
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].fromIf = ($('#' + aimID + '-fromIf').val() == "selectOption" ) ? "" : $('#' + aimID + '-fromIf').val();
                                                                tmp += '<td id="fromIf-' + thisNo + '">' + (($('#' + aimID + '-fromIf').val() == "selectOption" ) ? "" : $('#' + aimID + '-fromIf option:selected').text()) + '</td>';
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].toIf = ($('#' + aimID + '-toIf').val() == "selectOption" ) ? "" : $('#' + aimID + '-toIf').val();
                                                                tmp += '<td id="toIf-' + thisNo + '">' + (($('#' + aimID + '-toIf').val() == "selectOption" ) ? "" : $('#' + aimID + '-toIf option:selected').text()) + '</td>';
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].originalSrc = ($('#' + aimID + '-originalSrc').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalSrc').val();
                                                                tmp += '<td id="originalSrc-' + thisNo + '">' + (($('#' + aimID + '-originalSrc').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalSrc option:selected').text()) + '</td>';
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].originalDst = ($('#' + aimID + '-originalDst').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalDst').val();
                                                                tmp += '<td id="originalDst-' + thisNo + '">' + (($('#' + aimID + '-originalDst').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalDst option:selected').text()) + '</td>';
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].originalService = ($('#' + aimID + '-originalService').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalService').val();
                                                                tmp += '<td id="originalService-' + thisNo + '">' + (($('#' + aimID + '-originalService').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalService option:selected').text()) + '</td>';
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].translatedSrc = ($('#' + aimID + '-translatedSrc').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedSrc').val();
                                                                tmp += '<td id="translatedSrc-' + thisNo + '">' + (($('#' + aimID + '-translatedSrc').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedSrc option:selected').text()) + '</td>';
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].translatedDst = ($('#' + aimID + '-translatedDst').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedDst').val();
                                                                tmp += '<td id="translatedDst-' + thisNo + '">' + (($('#' + aimID + '-translatedDst').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedDst option:selected').text()) + '</td>';
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].translatedService = ($('#' + aimID + '-translatedService').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedService').val();
                                                                tmp += '<td id="translatedService-' + thisNo + '">' + (($('#' + aimID + '-translatedService').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedService option:selected').text()) + '</td>';
        
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "1";
                                                                
                                                                tmp += '<td class="buttonTD">';
                                                                tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                                tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                                tmp += '</td>';
                                                                tmp += '</tr>';
                                                                $(tableID).append(tmp);
                                                                $( this ).dialog( "close" );
                                                            }else{
                                                                $('#' + aimID + '-originalSrc').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalSrc"><span class="error">original source address required</span></label>')
                                                                $('#' + aimID + '-originalSrc').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            cgiComboSelectOption( aimID + '-fromIf');
                                            cgiComboSelectOption( aimID + '-toIf');
                                            cgiComboSelectOption( aimID + '-originalSrc');
                                            cgiComboSelectOption( aimID + '-originalDst');
                                            cgiComboSelectOption( aimID + '-originalService');
                                            cgiComboSelectOption( aimID + '-translatedSrc');
                                            cgiComboSelectOption( aimID + '-translatedDst');
                                            cgiComboSelectOption( aimID + '-translatedService');
                                            
                                            break;
                                            
                                        case 'port_forwarding':
                                            cgiGetID = 'portForwarding';
                                            cgiPostID = 'portForwarding';
                                            cgiT = 'guiPortForwardingT';
                                            cgiTNum = 'guiPortForwardingTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if ($('#' + aimID + '-originalService').val() == 'selectOption') {
                                                            $('#' + aimID + '-originalService').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalService"><span class="error">service required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-originalService').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if ($('#' + aimID + '-translatedService').val() == 'selectOption') {
                                                            $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">service required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-translatedService').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if (isPass) {
                                                            if ( cgiTypes[ $('#' + aimID + '-originalService').val() ] != cgiTypes[ $('#' + aimID + '-translatedService').val() ] ) {
                                                                $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">type match fail</span></label>')
                                                                if (isPass)
                                                                        $('#' + aimID + '-translatedService').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        
                                                        if ($('#' + aimID + '-privateIp').val() == 'selectOption') {
                                                            $('#' + aimID + '-privateIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-privateIp"><span class="error">private IP required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-privateIp').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if ($('#' + aimID + '-wan').val() != '0' && $('#' + aimID + '-wanIpId').val() == 'selectOption' ) {
                                                            $('#' + aimID + '-wanIpId').parents('td').append('<label class="errorLabel" for="' + aimID + '-wanIpId"><span class="error">WAN IP required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-wanIpId').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if (isPass) {
                                                            var trNo = $(tableBD + ' tr').length + 1;
        
                                                            var tmp = '<tr class="' + ((trNo % 2 == 0)? 'odd' : 'even') + '">';
                                                         
                                                            thisNo = parseInt( dataObj[ aimID ][ cgiTNum ] );
                                                            dataObj[ aimID ][ cgiTNum ]++;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = {};
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                            
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            tmp += '<td id="seq-' + thisNo + '">' + trNo + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].description = ($('#' + aimID + '-description').val().length > 0)? $('#' + aimID + '-description').val() : "";
                                                            tmp += '<td id="description-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].description + '</td>';
                                                            
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].originalService = $('#' + aimID + '-originalService').val();
                                                            tmp += '<td id="originalService-' + thisNo + '">' + (($('#' + aimID + '-originalService').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalService option:selected').text()) + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].translatedService = $('#' + aimID + '-translatedService').val();
                                                            tmp += '<td id="translatedService-' + thisNo + '">' + (($('#' + aimID + '-toIf').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedService option:selected').text()) + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].privateIp = $('#' + aimID + '-privateIp').val();
                                                            tmp += '<td id="privateIp-' + thisNo + '">' + (($('#' + aimID + '-privateIp').val() == "selectOption" ) ? "" : $('#' + aimID + '-privateIp option:selected').text()) + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].wan = $('#' + aimID + '-wan').val();
                                                            tmp += '<td id="wan-' + thisNo + '">' + (($('#' + aimID + '-wan').val() == "selectOption" ) ? "" : $('#' + aimID + '-wan option:selected').text()) + '</td>';
                                                            
                                                            switch(parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].wan ))
                                                            {
                                                            case 0:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].wanIpId = "";
                                                                tmp += '<td id="wanIpId-' + thisNo + '"></td>';
                                                                break;
                                                            default:
                                                            
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].wanIpId = $('#' + aimID + '-wanIpId').val();
                                                                tmp += '<td id="wanIpId-' + thisNo + '">' + (($('#' + aimID + '-wanIpId').val() == "selectOption" ) ? "" : $('#' + aimID + '-wanIpId option:selected').text()) + '</td>';
                                                            }
                                                            console.log( dataObj[ aimID ][ cgiT ][ thisNo ].wan + ' @ ' + dataObj[ aimID ][ cgiT ][ thisNo ].wanIpId + ' @ ' + $('#' + aimID + '-wanIpId').val());
    
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "1";
                                                            
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);
                                                            $( this ).dialog( "close" );
                                                        }
                                                        
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('#' + aimID + '-wan').append( genSelectOption( aimID + '-wan' ) ).val( 0 ).trigger('change');
                                            cgiComboSelectOption( aimID + '-privateIp');
                                            cgiComboSelectOption( aimID + '-wanIpId');
                                            cgiComboSelectOption( aimID + '-originalService');
                                            cgiComboSelectOption( aimID + '-translatedService');
                                            break;
                                        case 'static_nat':
                                            cgiGetID = 'staticNat';
                                            cgiPostID = 'staticNat';
                                            cgiT = 'guiStaticNatT';
                                            cgiTNum = 'guiStaticNatTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if ($('#' + aimID + '-publicIp').val() == 'selectOption') {
                                                            $('#' + aimID + '-publicIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-publicIp"><span class="error">IP required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-publicIp').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if ($('#' + aimID + '-privateIp').val() == 'selectOption') {
                                                            $('#' + aimID + '-privateIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-privateIp"><span class="error">IP required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-privateIp').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                     
                                                        
                                                        if (isPass) {
                                                            
                                                            var trNo = $(tableBD + ' tr').length + 1;
        
                                                            var tmp = '<tr class="' + ((trNo % 2 == 0)? 'odd' : 'even') + '">';
                                                         
                                                            thisNo = parseInt( dataObj[ aimID ][ cgiTNum ] );
                                                            
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            tmp += '<td id="seq-' + thisNo + '">' + trNo + '</td>';
                                                            dataObj[ aimID ][ cgiTNum ]++;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = {};
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].wanInterface = $('#' + aimID + '-wanInterface').val();
                                                            tmp += '<td id="wanInterface-' + thisNo + '">' + $('#' + aimID + '-wanInterface option:selected').text() + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].publicIp = $('#' + aimID + '-publicIp').val();
                                                            tmp += '<td id="publicIp-' + thisNo + '">' + $('#' + aimID + '-publicIp option:selected').text() + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].privateIp = $('#' + aimID + '-privateIp').val();
                                                            tmp += '<td id="privateIp-' + thisNo + '">' + $('#' + aimID + '-privateIp option:selected').text() + '</td>';
    
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "1";
                                                            
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);
                                                            
                                                         
                                                            $( this ).dialog( "close" );
                                                        }
                                                        
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            $('#' + aimID + '-wanInterface').append( genSelectOption( aimID + '-wanInterface' ) ).val( 0 ).trigger('change');
                                            cgiComboSelectOption( aimID + '-privateIp');
                                            cgiComboSelectOption( aimID + '-publicIp');
                                            
                                            break;
                                        case 'ipsec_policies':
                                            cgiGetID = 's2svpn';
                                            cgiPostID = 's2svpn';
                                            cgiT = 'guiS2svpnT';
                                            cgiTNum = 'guiS2svpnTNum';
                                            
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        calcObj = {};
                                                        if ($('#' + aimID + '-name').val().length == 0) {
                                                            isPass = false;
                                                            $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">description required</span></label>');
                                                            $('#' + aimID + '-name').focus();
                                                        }
                                                        switch(parseInt( $('#' + aimID + '-remoteGwType').val() ))
                                                        {
                                                        case 1:
                                                            if (regIpv4.test($('#' + aimID + '-remoteGw').val())) {
                                                                calcObj.arr = $('#' + aimID + '-remoteGw').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-remoteGw').parents('td').append('<label class="errorLabel" for="' + aimID + '-remoteGw"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-remoteGw').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-remoteGw').parents('td').append('<label class="errorLabel" for="' + aimID + '-remoteGw"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-remoteGw').focus();
                                                                isPass = false; 
                                                            }
                                                            break;
                                                        case 2:
                                                            if (!regDomain.test($('#' + aimID + '-remoteGw').val())){
                                                                $('#' + aimID + '-remoteGw').parents('td').append('<label class="errorLabel" for="' + aimID + '-remoteGw"><span class="error">domain error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-remoteGw').focus();
                                                                isPass = false; 
                                                            
                                                            }
                                                            break;
                                                        }
                                                        
                                                        if ($('#' + aimID + '-presharedkey').val().length == 0 || $('#' + aimID + '-presharedkey').val().length > 256) {
                                                            $('#' + aimID + '-presharedkey').parents('td').append('<label class="errorLabel" for="' + aimID + '-presharedkey"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-presharedkey').focus();
                                                                isPass = false; 
                                                        }
                                                        
                                                        if ($('#' + aimID + '-dpdEnable').is(':checked')) {
                                                            if (isNaN(parseInt($('#' + aimID + '-dpddelay').val())) || parseInt($('#' + aimID + '-dpddelay').val()) < 10 || parseInt($('#' + aimID + '-dpddelay').val()) > 300) {
                                                                $('#' + aimID + '-dpddelay').parents('td').append('<label class="errorLabel" for="' + aimID + '-dpddelay"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dpddelay').focus();
                                                                isPass = false;
                                                            }
                                                            
                                                            if (isNaN(parseInt($('#' + aimID + '-dpdtimeout').val())) || parseInt($('#' + aimID + '-dpdtimeout').val()) < 30 || parseInt($('#' + aimID + '-dpdtimeout').val()) > 1800) {
                                                                $('#' + aimID + '-dpdtimeout').parents('td').append('<label class="errorLabel" for="' + aimID + '-dpdtimeout"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dpdtimeout').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        
                                                        if ($('#' + aimID + '-backupPolicyEnable').is(':checked')) {
                                                            if (isNaN(parseInt($('#' + aimID + '-fallbackTime').val())) || parseInt($('#' + aimID + '-fallbackTime').val()) < 3 || parseInt($('#' + aimID + '-fallbackTime').val()) > 59) {
                                                                $('#' + aimID + '-fallbackTime').parents('td').append('<label class="errorLabel" for="' + aimID + '-fallbackTime"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-fallbackTime').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        
                                                        if (isPass) {
                                                            
                                                            var trNo = $(tableBD + ' tr').length + 1;
        
                                                            var tmp = '<tr class="' + ((trNo % 2 == 0)? 'odd' : 'even') + '">';
                                                         
                                                            thisNo = parseInt( dataObj[ aimID ][ cgiTNum ] );
                                                            
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            
                                                            dataObj[ aimID ][ cgiTNum ]++;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = {};
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].gid = "0";
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                            cgiRef[ cgiGetID ].free.push( dataObj[ aimID ][ cgiT ][ thisNo ].name  );
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].type = "0";
                                                            tmp += '<td id="name-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].name + '</td>';
                                                            if ($('#' + aimID + '-enable').is(':checked')) 
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].enable = "1";
                                                            else 
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].enable = "0";
                                                            tmp += '<td id="enable-' + thisNo + '">' + cgiRef[ cgiGetID ].enable[ dataObj[ aimID ][ cgiT ][ thisNo ].enable ] + '</td>';
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].infoStatus = "2";
                                                            tmp += '<td id="infoStatus-' + thisNo + '">' + cgiRef[ cgiGetID ].infoStatus[ dataObj[ aimID ][ cgiT ][ thisNo ].infoStatus ] + '</td>';
                                                            
                                                            if ($('#' + aimID + '-wanId').val() != 'selectOption') {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].wanId = $('#' + aimID + '-wanId').val();
                                                                tmp += '<td id="wanId-' + thisNo + '">' + $('#' + aimID + '-wanId option:selected').text() + '</td>';
                                                            }else {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].wanId = "";
                                                                tmp += '<td id="wanId-' + thisNo + '"></td>';
                                                            }
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].remoteGwType = $('#' + aimID + '-remoteGwType').val();
                                                            if (parseInt($('#' + aimID + '-remoteGwType').val()) == 0 ) 
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].remoteGw = "";
                                                            else 
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].remoteGw = $('#' + aimID + '-remoteGw').val();
                                                                
                                                            tmp += '<td id="remoteGw-' + thisNo + '">' + dataObj[ aimID ][ cgiT ][ thisNo ].remoteGw + '</td>';
                                                            
                                                            $('input[name=phase1AuthType]').each(function() {
                                                                if ($(this).is(':checked')) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].phase1AuthType = $(this).val();
                                                                    if (parseInt($(this).val()) == 0)
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].presharedkey = $('#' + aimID + '-presharedkey').val();
                                                                    else 
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].presharedkey = "";
                                                                }
                                                            });
                                                            
                                                            if ($('#' + aimID + '-localNetworkId').val() != 'selectOption') {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].localNetworkId = $('#' + aimID + '-localNetworkId').val();
                                                                tmp += '<td id="localNetworkId-' + thisNo + '">' + $('#' + aimID + '-localNetworkId option:selected').text() + '</td>';
                                                            }else {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].localNetworkId = "";
                                                                tmp += '<td id="localNetworkId-' + thisNo + '"></td>';
                                                            }
                                                            
                                                            if ($('#' + aimID + '-remoteNetworkId').val() != 'selectOption') {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].remoteNetworkId = $('#' + aimID + '-remoteNetworkId').val();
                                                                tmp += '<td id="remoteNetworkId-' + thisNo + '">' + $('#' + aimID + '-remoteNetworkId option:selected').text() + '</td>';
                                                            }else {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].remoteNetworkId = "";
                                                                tmp += '<td id="remoteNetworkId-' + thisNo + '"></td>';
                                                            }
                                                            
                                                            if ($('#' + aimID + '-pfsEnable').is(':checked'))
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].pfsEnable = "1";
                                                            else
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].pfsEnable = "0";
                                                                
                                                            if ($('#' + aimID + '-dpdEnable').is(':checked')) {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].dpdEnable = "1";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].dpddelay = $('#' + aimID + '-dpddelay').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].dpdtimeout = $('#' + aimID + '-dpdtimeout').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].dpdaction = $('#' + aimID + '-dpdaction').val();
                                                            }else{
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].dpdEnable = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].dpddelay = "10";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].dpdtimeout = "30";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].dpdaction = "0";
                                                            }
                                                            
                                                            if ($('#' + aimID + '-ikePolicyId').val() != 'selectOption') {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].ikePolicyId = $('#' + aimID + '-ikePolicyId').val();
                                                                tmp += '<td id="ikePolicyId-' + thisNo + '">' + $('#' + aimID + '-ikePolicyId option:selected').text() + '</td>';
                                                            }else {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].ikePolicyId = "";
                                                                tmp += '<td id="ikePolicyId-' + thisNo + '"></td>';
                                                            }
                                                            
                                                            if ($('#' + aimID + '-transformPolicyId').val() != 'selectOption') {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].transformPolicyId = $('#' + aimID + '-transformPolicyId').val();
                                                                tmp += '<td id="transformPolicyId-' + thisNo + '">' + $('#' + aimID + '-transformPolicyId option:selected').text() + '</td>';
                                                            }else {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].transformPolicyId = "";
                                                                tmp += '<td id="transformPolicyId-' + thisNo + '"></td>';
                                                            }
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].vpnaclTNum = "0";
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].vpnaclT = [];
                                                            
                                                            if ($('#' + aimID + '-wanFailoverEnable').is(':checked'))
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].wanFailoverEnable = "1";
                                                            else
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].wanFailoverEnable = "0";
                                                                
                                                            if ($('#' + aimID + '-backupPolicyEnable').is(':checked')) {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyEnable = "1";
                                                                if ($('#' + aimID + '-backupPolicyName').val() != 'selectOption') {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyName = $('#' + aimID + '-backupPolicyName').val();
                                                                    cgiRef[ cgiGetID ].freez.push( dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyName );
                                                                }else 
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyName = "";   
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].fallbackTime = $('#' + aimID + '-fallbackTime');
                                                            }else {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyEnable = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyName = "";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].fallbackTime = "5";
                                                            }
                                                             
                                                                
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon" title="Edit"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon" title="Delete"></span></button>';
                                                            tmp += '<button id="Connect-' + aimID + '-' + thisNo + '" class="Connect"><span class="ui-icon" title="Connect"></span></button>';
                                                            tmp += '<button id="Disconnect-' + aimID + '-' + thisNo + '" class="Disconnect"><span class="ui-icon" title="Disconnect"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "1";
                                                            
                                                            $(tableID).append(tmp);
                                                            
                                                            $('#Connect-' + aimID + '-' + thisNo).prop('disabled', true);
                                                            $('#Disconnect-' + aimID + '-' + thisNo).prop('disabled', true);
                                                            
                                                            $( this ).dialog( "close" );
                                                            
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('.tabs').tabs();
                                            genAccessControl('access_control');
                                            
                                            $('#' + aimID + '-remoteGwType').append( genSelectOption( aimID + '-remoteGwType') ).val( 0 ).trigger('change');
                                            
                                            cgiSelectOption( aimID + '-wanId');
                                            cgiComboSelectOption( aimID + '-localNetworkId');
                                            cgiComboSelectOption( aimID + '-remoteNetworkId');
                                            
                                            $('#' + aimID + '-dpddelay').val("10");
                                            $('#' + aimID + '-dpdtimeout').val("30");
                                            $('#' + aimID + '-dpdaction').append( genSelectOption( aimID + '-dpdaction') ).val( 3 ).trigger('change');
                                            
                                            cgiSelectOption( aimID + '-ikePolicyId');
                                            cgiSelectOption( aimID + '-transformPolicyId');
                                            
                                            tmp ='<option value="selectOption">Select Backup Policy</option>';
                                            for (var x in cgiRef[ cgiGetID ].free) {
                                                if (cgiRef[ cgiGetID ].freez.indexOf( cgiRef[ cgiGetID ].free[ x ] ) == -1)
                                                    tmp += '<option value="' + cgiRef[ cgiGetID ].free[ x ] + '">' + cgiRef[ cgiGetID ].free[ x ] + '</option>';
                                            }
                                            
                                            $('#' + aimID + '-backupPolicyName').append(tmp);
                                            
                                            $('#' + aimID + '-fallbackTime').val( "5" );
                                            
                                            $('input[name=phase1AuthType]').val(0).trigger('click');
                                            
                                            $('.' + aimID + '-dpdEnable-checked').prop('disabled', true);
                                            $('.' + aimID + '-backupPolicyEnable-checked').prop('disabled', true);
                                            break;
                                        case 'transform_policy':
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        dataObj[ aimID ].guiIpsectransformT[ dataObj[ aimID ].guiIpsectransformTNum ] = {};
                                                        for (var key in dataObj[ aimID ].guiIpsectransformT[0])
                                                            dataObj[ aimID ].guiIpsectransformT[ dataObj[ aimID ].guiIpsectransformTNum ][ key] = dataObj[ aimID ].guiIpsectransformT[0][ key ];
                                                        tmp = '<tr class="' + ((dataObj[ aimID ].guiIpsectransformTNum % 2 == 0)? 'odd' : 'even') + '">';
                                                        $(tableID + ' tr th').each(function(index) {
                                                                var thID = $(this).attr('id');
                                                                var thClass = $(this).attr('class');
                                                                regObj = thClass.match(regRowAction);
                                                                switch(regObj != null)
                                                                {
                                                                case true:
                                                                    $(this).addClass('rowAction BT'+regObj.length);
                                                                    tmp += '<td class="buttonTD">';
                                                                    for (var x in regObj){
                                                                        switch(regDigit.test(x))
                                                                        {
                                                                        case true:
                                                                            tmp += '<button id="' + regObj[x] + '-' + aimID + '-' + dataObj[ aimID ].guiIpsectransformTNum + '" class="' + regObj[x] + '"><span class="ui-icon"></span></button>';
                                                                            break;
                                                                        }
                                                                    }
                                                                    tmp += '</td>';
                                                                     break;
                                                                case false:
                                                                    switch (regCheckbox.test(thClass))
                                                                    {
                                                                    case true:
                                                                        tmp += '<td class="checkTD"><input type="checkbox" value="' + dataObj[ aimID ].guiIpsectransformTNum + '" /></td>';
                                                                        break;
                                                                    case false:
                                                                        switch (regSelect.test(thClass))
                                                                        {
                                                                        case true:
                                                                            tmp += '<td class="selectTD">'
                                                                            tmp += '<select id="' + thID + dataObj[ aimID ].guiIpsectransformTNum + '">';
                                                                            tmp += genSelectOption(thID);
                                                                            tmp += '</select>';
                                                                            tmp += '</td>';
                                                                            break;
                                                                        case false:
                                                                            switch(thID)
                                                                            {
                                                                            case 'cipher':
                                                                            case 'hash':
                                                                            case 'pfsgroup':
                                                                                tmp += '<td id="' + thID + '-' + dataObj[ aimID ].guiIpsectransformTNum + '">' + cgiRef.ipsectransform[ thID ][ $('#form-' + thID).val() ] + '</td>';
                                                                                break;
                                                                        default :
                                                                            tmp += '<td id="' + thID + '-' + dataObj[ aimID ].guiIpsectransformTNum + '">' + $('#form-' + thID).val() + '</td>';
                                                                            break;
                                                                        }
                                                                        dataObj[ aimID ].guiIpsectransformT[ dataObj[ aimID ].guiIpsectransformTNum ][ thID ] = $('#form-' + thID).val();
                                                                        break;
                                                                    }
                                                                    break;
                                                                }
                                                                break;
                                                            }
                                                        });
                
                                                        tmp += '</tr>';
                                                        $(tableID).append(tmp);
                                                        dataObj[ aimID ].guiIpsectransformT[ dataObj[ aimID ].guiIpsectransformTNum ].userDefined = "1";
                                                        dataObj[ aimID ].guiIpsectransformT[ dataObj[ aimID ].guiIpsectransformTNum ].cgiAction = "1";
                                                        dataObj[ aimID ].guiIpsectransformTNum++;
                                                        $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            break;
                                        case 'ike_policy':
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        dataObj[ aimID ].guiIpsecikeT[ dataObj[ aimID ].guiIpsecikeTNum ] = {};
                                                        for (var key in dataObj[ aimID ].guiIpsecikeT[0])
                                                            dataObj[ aimID ].guiIpsecikeT[ dataObj[ aimID ].guiIpsecikeTNum ][ key ] = dataObj[ aimID ].guiIpsecikeT[0][ key ];
                                                        tmp = '<tr class="' + ((dataObj[ aimID ].guiIpsecikeTNum % 2 == 0)? 'odd' : 'even') + '">';
                                                        $(tableID + ' tr th').each(function(index) {
                                                            var thID = $(this).attr('id');
                                                            var thClass = $(this).attr('class');
                                                            regObj = thClass.match(regRowAction);
                                                            switch(regObj != null)
                                                            {
                                                            case true:
                                                                $(this).addClass('rowAction BT'+regObj.length);
                                                                tmp += '<td class="buttonTD">';
                                                                for (var x in regObj){
                                                                    switch(regDigit.test(x))
                                                                    {
                                                                    case true:
                                                                        tmp += '<button id="' + regObj[x] + '-' + aimID + '-' + dataObj[ aimID ].guiIpsecikeTNum + '" class="' + regObj[x] + '"><span class="ui-icon"></span></button>';
                                                                        break;
                                                                    }
                                                                }
                                                                tmp += '</td>';
                                                                break;
                                                            case false:
                                                                switch (regCheckbox.test(thClass))
                                                                {
                                                                case true:
                                                                    tmp += '<td class="checkTD"><input type="checkbox" value="' + dataObj[ aimID ].guiIpsecikeTNum + '" /></td>';
                                                                    break;
                                                                case false:
                                                                    switch (regSelect.test(thClass))
                                                                    {
                                                                    case true:
                                                                        tmp += '<td class="selectTD">'
                                                                        tmp += '<select id="' + thID + dataObj[ aimID ].guiIpsecikeTNum + '">';
                                                                        tmp += genSelectOption(thID);
                                                                        tmp += '</select>';
                                                                        tmp += '</td>';
                                                                        break;
                                                                    case false:
                                                                        switch(thID)
                                                                        {
                                                                        case 'cipher':
                                                                        case 'hash':
                                                                        case 'dhgroup':
                                                                            tmp += '<td id="' + thID + '-' + dataObj[ aimID ].guiIpsecikeTNum + '">' + cgiRef.ipsecike[ thID ][ $('#form-' + thID).val() ] + '</td>';
                                                                            break;
                                                                        default :
                                                                            tmp += '<td id="' + thID + '-' + dataObj[ aimID ].guiIpsecikeTNum + '">' + $('#form-' + thID).val() + '</td>';
                                                                            break;
                                                                        }
                                                                        dataObj[ aimID ].guiIpsecikeT[ dataObj[ aimID ].guiIpsecikeTNum ][ thID ] = $('#form-' + thID).val();
                                                                        break;
                                                                    }
                                                                    break;
                                                                }
                                                                break;
                                                            }
                                                        });
                
                                                        tmp += '</tr>';
                                                        $(tableID).append(tmp);
                                                        dataObj[ aimID ].guiIpsecikeT[ dataObj[ aimID ].guiIpsecikeTNum ].userDefined = "1";
                                                        dataObj[ aimID ].guiIpsecikeT[ dataObj[ aimID ].guiIpsecikeTNum ].cgiAction = "1";
                                                        dataObj[ aimID ].guiIpsecikeTNum++;
                                                        $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            break;
                                        case 'address_exceptions':
                                            cgiT = 'excepT';
                                            cgiTNum = 'excepNum';
                                            $('.dialogForm').dialog({
                                                width: 600,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if ( isNaN(parseInt($('#sourceAddress').val())) ) {
                                                            isPass = false;
                                                            $('#sourceAddress').parents('td').append('<label class="errorLabel" for="sourceAddress"><span class="error">source address required</span></label>');
                                                            $('#sourceAddress').focus();
                                                        }
                                                        
                                                        if ( isNaN(parseInt($('#destinationAddress').val())) ) {
                                                            
                                                            $('#destinationAddress').parents('td').append('<label class="errorLabel" for="destinationAddress"><span class="error">destination address required</span></label>');
                                                            if (isPass)
                                                                $('#destinationAddress').focus();
                                                            isPass = false; 
                                                        }
                                                        
                                                        if (isPass) {
                                                            thisNo = dataObj[ aimID ][ cgiTNum ];
                                                            dataObj[ aimID ][ cgiT ][ thisNo ] = {};
                                                            if ($(tableBD).length == 0)
                                                                $(tableID).append('<tbody>');
                                                            tmp = '<tr class="' + ((parseInt(thisNo) % 2 == 0)? 'odd' : 'even') + '">';
                                                            for (var i=0, len=parseInt( cgiList.common_addr_list.guiAddrTNum ); i<len; i++) 
                                                            {
                                                                if (parseInt( cgiList.common_addr_list.guiAddrT[ i ].gid) == parseInt($('#sourceAddress').val())) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcAddrType = "0";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcAddrGid  = cgiList.common_addr_list.guiAddrT[ i ].gid;
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcGAddrGid = "0";
                                                                    tmp += '<td id="srcAddrType-' + thisNo + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</td>';
                                                                }
                                                            }
                                                            
                                                            for (var i=0, len=parseInt( cgiList.common_gAddr_list.guiGAddrTNum ); i<len; i++) 
                                                            {
                                                                if (parseInt( cgiList.common_gAddr_list.guiGAddrT[ i ].gid) == parseInt($('#sourceAddress').val())) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcAddrType = "1";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcAddrGid  = "0";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcGAddrGid = cgiList.common_gAddr_list.guiGAddrT[ i ].gid;
                                                                    tmp += '<td id="srcAddrType-' + thisNo + '">' + cgiList.common_gAddr_list.guiGAddrT[ i ].name + '</td>';
                                                                }
                                                            }
                                                            
                                                            for (var i=0, len=parseInt( cgiList.common_addr_list.guiAddrTNum ); i<len; i++) 
                                                            {
                                                                if (parseInt( cgiList.common_addr_list.guiAddrT[ i ].gid) == parseInt($('#destinationAddress').val())) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstAddrType = "0";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstAddrGid  = cgiList.common_addr_list.guiAddrT[ i ].gid;
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstGAddrGid  ="0";
                                                                    tmp += '<td id="dstAddrType-' + thisNo + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</td>';
                                                                }
                                                            }
                                                            
                                                            for (var i=0, len=parseInt( cgiList.common_gAddr_list.guiGAddrTNum ); i<len; i++) 
                                                            {
                                                                if (parseInt( cgiList.common_gAddr_list.guiGAddrT[ i ].gid) == parseInt($('#destinationAddress').val())) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstAddrType = "1";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstAddrGid  = "0";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstGAddrGid = cgiList.common_gAddr_list.guiGAddrT[ i ].gid;
                                                                    tmp += '<td id="dstAddrType-' + thisNo + '">' + cgiList.common_gAddr_list.guiGAddrT[ i ].name + '</td>';
                                                                }
                                                            }
                                                            
                                                            dataObj[ aimID ][cgiT ][ thisNo ].cgiAction = "1";
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].Log = ($('#addressLog').is(':checked') )? "1" : "0";
                                                            tmp += '<td id="Log-' + thisNo + '">' + cgiRef.antivirus.Log[ dataObj[ aimID ][ cgiT ][ thisNo ].Log ] + '</td>';
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo+ '" class="Delete"><span class="ui-icon"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);

                                                            dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                                            
                                                            if (dataObj[ aimID ][ cgiTNum ] == 32)
                                                                $('#Create-address_exceptions').prop('disabled', true);
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            switch(dataObj[ aimID ].excepT[ thisNo ].Log)
                                            {
                                            case "1":
                                                $('#addressLog').attr('checked', true);
                                                break;
                                            }
                                            cgiComboSelectOption(aimID);
                                            break;
                                        case 'mime':
                                            $('.dialogForm').dialog({
                                                width: 300,
                                                height:250,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                    buttons: {
                                                    "OK": function() {
                                                            if ($(tableBD).length == 0)
                                                                $(tableID).append('<tbody>');
                                                            
                                                            tmp = '<tr class="' + ((dataObj.file_extensions.mimeExcepNum % 2 == 0)? 'odd' : 'even') + '">';
                                                            tmp += '<td id="mime-' + dataObj.file_extensions.mimeExcepNum + '">' + $('#modMime').val() + '</td>';
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + dataObj.file_extensions.mimeExcepNum + '" class="Edit"><span class="ui-icon"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + dataObj.file_extensions.mimeExcepNum + '" class="Delete"><span class="ui-icon"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);
                                                            dataObj.file_extensions.mimeExcepT.push({"mime": $('#modMime').val()});
                                                            dataObj.file_extensions.mimeExcepNum = dataObj.file_extensions.mimeExcepT.length;
                                                            $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            break;
                                        case 'file_extension':
                                            $('.dialogForm').dialog({
                                                width: 300,
                                                height:250,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                            if ($(tableBD).length == 0)
                                                                $(tableID).append('<tbody>');
                                                            
                                                            tmp = '<tr class="' + ((dataObj.file_extensions.fileExcepNum % 2 == 0)? 'odd' : 'even') + '">';
                                                            tmp += '<td id="fileExt-' + dataObj.file_extensions.fileExcepNum + '">' + $('#modFileExt').val() + '</td>';
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + dataObj.file_extensions.fileExcepNum + '" class="Edit"><span class="ui-icon"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + dataObj.file_extensions.fileExcepNum + '" class="Delete"><span class="ui-icon"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);
                                                            dataObj.file_extensions.fileExcepT.push({"fileExt": $('#modFileExt').val()});
                                                            dataObj.file_extensions.fileExcepNum = dataObj.file_extensions.fileExcepT.length;
                                                            $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            break;
                                        case 'user':
                                            cgiT = 'userListT';
                                            thisNo = dataObj[ aimID ][ cgiT ].length;
                                            $('.dialogForm').dialog({
                                                width: 600,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if (($('#'+ aimID + '-name').val().length == 0)) {
                                                            isPass = false;
                                                            $('#'+ aimID + '-name').parents('td').append('<label class="errorLabel" for="'+ aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#'+ aimID + '-name').focus();
                                                        }
                                                        
                                                        if (($('#'+ aimID + '-password').val().length == 0)) {
                                                            
                                                            $('#'+ aimID + '-password').parents('td').append('<label class="errorLabel" for="'+ aimID + '-password"><span class="error">password required</span></label>');
                                                            if (isPass)
                                                                $('#'+ aimID + '-password').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (($('#'+ aimID + '-confirm').val().length == 0)|| $('#'+ aimID + '-password').val() != $('#'+ aimID + '-confirm').val()) {
                                                            
                                                            $('#'+ aimID + '-confirm').parents('td').append('<label class="errorLabel" for="'+ aimID + '-confirm"><span class="error">password match fail</span></label>');
                                                            if (isPass)
                                                                $('#'+ aimID + '-confirm').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                        
                                                            tmp = '<tr class="' + ((dataObj[ aimID ][ cgiT ].length % 2 == 0)? 'odd' : 'even') + '">';
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            tmp += '<td id="userName-' + thisNo + '">' + $('#' + aimID + '-name').val() + '</td>';
                                                            tmp += '<td id="userGroup-' + thisNo + '">' + $('#' + aimID + '-groupId').text() + '</td>';
                                                            
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);
                                                                                                                        
                                                            dataObj[ aimID ][ cgiT ].push({"gid":"0","name":$('#' + aimID + '-name').val(),"password": $('#' + aimID + '-password').val(),"groupId":$('#' + aimID + '-groupId').val(), "cgiSetPwd":"1","cgiAction":"1"});
                                                            
                                                            tmplTabs.tabs({"disabled": [1]});
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('.tabs').tabs();
                                            
                                            $('#' + aimID + '-groupId').append( genSelectOption( aimID + '-groupId') );
                                            break;
                                        case 'group':
                                            cgiT = 'groupListT';
                                            thisNo = dataObj[ aimID ][ cgiT ].length;
                                            $('.dialogForm').dialog({
                                                width: 600,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if (($('#'+ aimID + '-name').val().length == 0)) {
                                                            isPass = false;
                                                            $('#'+ aimID + '-name').parents('td').append('<label class="errorLabel" for="'+ aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#'+ aimID + '-name').focus();
                                                        }
                                                        
                                                        if (isPass) {
                                                        
                                                            tmp = '<tr class="' + ((dataObj[ aimID ][ cgiT ].length % 2 == 0)? 'odd' : 'even') + '">';
                                                            tmp += '<td class="checkTD"><input type="checkbox" value="' + thisNo + '" /></td>';
                                                            tmp += '<td id="groupName-' + thisNo + '">' + $('#' + aimID + '-name').val() + '</td>';
                                                            tmp += '<td id="groupMember-' + thisNo + '">';
                                                            var users = [];
                                                            $('#selectedGroup option').each(function() {
                                                                tmp += $(this).text() + ';';
                                                                users.push($(this).val());

                                                            });
                                                            tmp += '</td>';
                                                            tmp += '<td id="groupServices-' + thisNo + '">' + 'Web Login:' + cgiRef[ aimID ].webLoginPriv[ $('#' + aimID + '-webLoginPriv').val() ] + '; Captive Portal:' + cgiRef[ aimID ].portalPriv[ (($('#' + aimID + '-portalPriv').is(':checked'))? "1" : "0") ] + '</td>';
                                                            tmp += '<td class="buttonTD">';
                                                            tmp += '<button id="Edit-' + aimID + '-' + thisNo + '" class="Edit"><span class="ui-icon"></span></button>';
                                                            tmp += '<button id="Delete-' + aimID + '-' + thisNo + '" class="Delete"><span class="ui-icon"></span></button>';
                                                            tmp += '</td>';
                                                            tmp += '</tr>';
                                                            $(tableID).append(tmp);
                                                                                                                        
                                                            dataObj[ aimID ][ cgiT ].push({"gid":"0","name":$('#' + aimID + '-name').val(),"webLoginPriv": $('#' + aimID + '-webLoginPriv').val(),"portalPriv":($('#' + aimID + '-portalPriv').is(':checked'))? "1" : "0","cgiSetListId":users.join(';'),"cgiAction":"1"});
                                                            
                                                            tmplTabs.tabs({"disabled": [1]});
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('.tabs').tabs();
                                            $('#' + aimID + '-webLoginPriv').append( genSelectOption( aimID + '-webLoginPriv') );
                                            
                                            for (var x in dataObj.user.userListT)
                                            {
                                                $('#selectedGroupPool').append('<option value="' + dataObj.user.userListT[ x ].gid + '">' + dataObj.user.userListT[ x ].name + '</option>');
                                            }
                                            
                                            break;
                                            
                                        }
                                 
                                    });
                                }
                                break;
                            case 'Edit':
                                var thisTr = $(this).parents('tr');
                                var thisNo = btID.replace(btClass + '-' + aimID + '-', '');
                                var isPass = true;
                                var cgiGetID;
                                var cgiPostID;
                                var cgiT;
                                var cgiTNum;
                                
                                switch(aimID)
                                {
                                case 'ip_alias':
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                         $('.extraForm').dialog({
                                                width: 350,
                                                height:200,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        if ( !regIpv4.test($('#modIpAliasAddress').val()) ) {
                                                            isPass = false;
                                                            $('#modIpAliasAddress').parents('td').append('<label    class="errorLabel" for="modIpAliasAddress"><span class="error">IPv4 spec</span></label>');
                                                            $('#modIpAliasAddress').focus();
                                                        }
                                                        
                                                        if ( !regIpv4.test($('#modIpAliasNetmask').val()) ) {                                                        
                                                            $('#modIpAliasNetmask').parents('td').append('<label    class="errorLabel" for="modIpAliasNetmask"><span class="error">IPv4 spec</span></label>');
                                                            if (isPass)
                                                                $('#modIpAliasNetmask').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            cgiIpAlias[ thisNo ].address = $('#modIpAliasAddress').val();
                                                            cgiIpAlias[ thisNo ].netmask = $('#modIpAliasNetmask').val();
                                                            $('#ipAliasT-address-' + thisNo).html($('#modIpAliasAddress').val());
                                                            $('#ipAliasT-netmask-' + thisNo).html($('#modIpAliasNetmask').val());
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            $('#modIpAliasAddress').val($('#ipAliasT-address-' + thisNo).html());
                                            $('#modIpAliasNetmask').val($('#ipAliasT-netmask-' + thisNo).html());
                                    });
                                    break;
                                        
                                // device object
                                case 'schedule':
                                    cgiGetID = 'common_time_list';
                                    cgiPostID = 'common_updateTime';
                                    cgiT = 'guiTimeT';
                                    cgiTNum = 'guiTimeTNum';
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#' + aimID + '-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#' + aimID + '-name').parents('td').append('<label    class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                        $('#' + aimID + '-name').focus();
                                                    }
        
                                                    if (isPass) {
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                        
                                                        formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                                        switch($('#days option:selected').val())
                                                        {
                                                        case "0":
                                                            switch($('#times option:selected').val())
                                                            {
                                                            case "0":
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].type = "1";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startHour = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startMin = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endHour = "23";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endMin = "59";
                                                                break;
                                                            case "1":
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].type = "2";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startHour = $('#startHour').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startMin = $('#startMin').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endHour = $('#endHour').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endMin = $('#endMin').val();
                                                                break;
                                                            }
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].day = 0;
                                                            $('#day-' + thisNo ).html( cgiRef[ aimID ].day[ dataObj[ aimID ][ cgiT ][ thisNo ].day ] );
                                                            break;
                                                        case "1":
                                                            switch($('#times option:selected').val())
                                                            {
                                                            case "0":
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].type = "3";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startHour = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startMin = "0";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endHour = "23";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endMin = "59";
                                                                break;
                                                            case "1":
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].type = "4";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startHour = $('#startHour').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].startMin = $('#startMin').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endHour = $('#endHour').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].endMin = $('#endMin').val();
                                                                break;
                                                            }
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].day = 0;
                                                            var arr = [];
                                                            for (var x in cgiRef[ aimID ].days)
                                                            {
                                                                switch($('#'+ cgiRef[ aimID ].days[ x ] ).is(':checked'))
                                                                {
                                                                case true:
                                                                    arr.push( cgiRef[ aimID ].day[ $('#' + cgiRef[ aimID ].days[ x ] ).val() ] );
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].day += parseInt( $('#' + cgiRef[ aimID ].days[ x ] ).val() );
                                                                    break;
                                                                }
                                                            }
                                                            $('#day-' + thisNo ).html( arr.join(',')  );
                                                            break;
                                                        }
                                                        
                                                        
                                                        formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                                        
                                                        formObj.day = dataObj[ aimID ][ cgiT ][ thisNo ].day;
                                                                                                        
                                                        
                                                        formObj.startHour = dataObj[ aimID ][ cgiT ][ thisNo ].startHour;
                                                        
                                                        formObj.startMin = dataObj[ aimID ][ cgiT ][ thisNo ].startMin;
                                                        
                                                        formObj.endHour = dataObj[ aimID ][ cgiT ][ thisNo ].endHour;
                                                        
                                                        formObj.endMin = dataObj[ aimID ][ cgiT ][ thisNo ].endMin;
                                                        
                                                        formObj.action = "1";
                                                        
                                                        /* should be move insiide callback */
                                                        $('#name-' + thisNo ).html( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                                        
                                                        $('#startTime-' + thisNo ).html( dataObj[ aimID ][ cgiT ][ thisNo ].startHour + ':' + dataObj[ aimID ][ cgiT ][ thisNo ].startMin );
                                                        $('#endTime-' + thisNo ).html( dataObj[ aimID ][ cgiT ][ thisNo ].endHour + ':' + dataObj[ aimID ][ cgiT ][ thisNo ].endMin );
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        
                                                        
                                                        $( this ).dialog( "close" );
                                                    

                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                         
                                        });
                                        
                                        $('#startHour').append( genSelectOption('startHour') );
                                        $('#startMin').append( genSelectOption('startMin') );
                                        $('#endHour').append( genSelectOption('endHour') );
                                        $('#endMin').append( genSelectOption('endMin') );
                                            
                                        $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                        
                                        switch( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].type ) )
                                        {
                                        case 1:
                                            $('#days').val("0").trigger('change');
                                            $('#times').val("0").trigger('change');
                                            break;
                                        case 2:
                                            $('#days').val("0").trigger('change');
                                            $('#times').val("1").trigger('change');
                                            $('#startHour').val( dataObj[ aimID ][ cgiT ][ thisNo ].startHour );
                                            $('#startMin').val( dataObj[ aimID ][ cgiT ][ thisNo ].startMin );
                                            $('#endHour').val( dataObj[ aimID ][ cgiT ][ thisNo ].endHour );
                                            $('#endHour').val( dataObj[ aimID ][ cgiT ][ thisNo ].endHour );
                                            break;
                                        case 3:
                                            $('#days').val("1").trigger('change');
                                            $('#times').val("0").trigger('change');
                                            var arr = switchSchedule( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].day ), false);
                                            for (var node in arr)
                                            {
                                                $('#day' + arr[ node ]).attr('checked', true);
                                            }
                                            break;
                                        case 4:
                                            $('#days').val("1").trigger('change');
                                            $('#times').val("1").trigger('change');
                                            
                                            var arr = switchSchedule( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].day ), false);
                                            for (var node in arr)
                                            {
                                                $('#day' + arr[ node ]).attr('checked', true);
                                            }
                                            $('#startHour').val( dataObj[ aimID ][ cgiT ][ thisNo ].startHour );
                                            $('#startMin').val( dataObj[ aimID ][ cgiT ][ thisNo ].startMin );
                                            $('#endHour').val( dataObj[ aimID ][ cgiT ][ thisNo ].endHour );
                                            $('#endHour').val( dataObj[ aimID ][ cgiT ][ thisNo ].endHour );
                                            break;    
                                        }
                                    });
                                    break;
                                case 'address':
                                    cgiGetID = 'common_addr_list';
                                    cgiPostID = 'common_updateAddr';
                                    cgiT = 'guiAddrT';
                                    cgiTNum = 'guiAddrTNum';
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    calcObj = {};
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#' + aimID + '-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                        $('#' + aimID + '-name').focus();
                                                    }

                                                    var types = parseInt( $('#' + aimID + '-type option:selected').val() );
                                                    var arr = [];
                                                    switch(parseInt( $('#' + aimID + '-type option:selected').val() ))
                                                    {
                                                    case 1:
                                                        
                                                        if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                            arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                            for (var i=0, ilen=arr.length; i<ilen; i++)
                                                            {
                                                                arr[i] = parseInt(arr[i]);
                                                                switch (arr[i] > 255 || arr[i] < 0) 
                                                                {
                                                                case true:
                                                                    $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case false:
                                                                    switch(i)
                                                                    {
                                                                    case 3:
                                                                        switch(arr[i] == 255 || arr[i] == 0 )
                                                                        {
                                                                        case true:
                                                                            $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                            if (isPass)
                                                                                $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                            isPass = false;
                                                                            break; 
                                                                        }
                                                                        break; 
                                                                    }
                                                                    break;
                                                                }
                                                            }
                                                            if (isPass)
                                                                $('#' + aimID + '-type-' + types + '-startIp').val( arr.join('.') );
    
                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                            isPass = false;
                                                        }
                                                        break;
                                                    case 2:
                                                        if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                            arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                            for (var i=0, ilen=arr.length; i<ilen; i++)
                                                            {
                                                                switch (arr[i] > 255 || arr[i] < 0) 
                                                                {
                                                                case true:
                                                                    $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case false:
                                                                    calcObj["ip_" + (i+1)] = parseInt(arr[i]);
                                                                    break;
                                                                }
                                                            }
                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (regIpv4.test($('#' + aimID + '-type-' + types + '-netmask').val()) && $('#' + aimID + '-type-' + types + '-netmask').val() != '255.255.255.255' ) {
                                                            arr = $('#' + aimID + '-type-' + types + '-netmask').val().split(regDot);
                                                            for (var i=0, ilen=arr.length; i<ilen; i++)
                                                            {
                                                                switch (arr[i] > 255 || arr[i] < 0) 
                                                                {
                                                                case true:
                                                                    $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case false:
                                                                    calcObj["snm_" + (i+1)] = parseInt(arr[i]);
                                                                    break;
                                                                }
                                                            }
                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            calcNWbits(calcObj);
                                                            
                                                            if (calcObj.result != 'invalid') {
                                                                calcObj.bits = calcObj.result;
                                                                calcNBFL(calcObj);
                                                                
                                                                switch(calcObj.numofaddr)
                                                                {
                                                                case 'ERR':
                                                                    $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case 'one':
                                                                case 'two':
                                                                    calcObj.startIp = calcObj.firstadr_1 + '.' + calcObj.firstadr_2 + '.' + calcObj.firstadr_3 + '.' + calcObj.firstadr_4;
                                                                    calcObj.endIp     = calcObj.lastadr_1 + '.' + calcObj.lastadr_2 + '.' + calcObj.lastadr_3 + '.' + calcObj.lastadr_4;
                                                                    break;                                                                
                                                                default:
                                                                    calcObj.startIp = calcObj.nwadr_1 + '.' + calcObj.nwadr_2 + '.' + calcObj.nwadr_3 + '.' + calcObj.nwadr_4;
                                                                    calcObj.endIp     = calcObj.bcast_1 + '.' + calcObj.bcast_2 + '.' + calcObj.bcast_3 + '.' + calcObj.bcast_4;
                                                                }
                                                                
                                                                if (isPass && calcObj.startIp != $('#' + aimID + '-type-' + types + '-startIp').val() ) {
                                                                    $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error"> match fail</span></label>');
                                                                    $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                    isPass = false;
                                                                    
                                                                }
    
                                                            }else {
                                                                $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        break;
                                                    case 3:
                                                        calcObj.start = [];
                                                        calcObj.end = [];
                                                        if ($('#' + aimID + '-type-' + types + '-startIp').val() == $('#' + aimID + '-type-' + types + '-endIp').val()) {
                                                            $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                            isPass = false;
                                                        }else {
                                                            if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                                arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                                for (var i=0, ilen=arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(arr[i]) || arr[i] > 255 || arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    case false:
                                                                        calcObj.start.push( parseInt(arr[i]) );
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                     $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                isPass = false;
                                                            }
                                                            
                                                            if (regIpv4.test($('#' + aimID + '-type-' + types + '-endIp').val())) {
                                                                arr = $('#' + aimID + '-type-' + types + '-endIp').val().split(regDot);
                                                                for (var i=0, ilen=arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(arr[i]) || arr[i] > 255 || arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    case false:
                                                                        calcObj.end.push( parseInt(arr[i]) );
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                     $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                isPass = false;
                                                            }
                                                            
                                                            if (isPass) {
                                                                if (calcObj.start[0] > calcObj.end[0]) {
                                                                    $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                        isPass = false;
                                                                }else if (calcObj.start[0]== calcObj.end[0]) {
                                                                    if (calcObj.start[1] > calcObj.end[1]) {
                                                                        $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                            isPass = false;
                                                                    }else if (calcObj.start[1] == calcObj.end[1]) {
                                                                        if (calcObj.start[2] > calcObj.end[2]) {
                                                                            $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                            if (isPass)
                                                                                $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                                isPass = false;
                                                                        }else if ( calcObj.start[2] == calcObj.end[2]) {
                                                                            if ( calcObj.start[3] > calcObj.end[3] ) {
                                                                                $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                                if (isPass)
                                                                                    $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                                    isPass = false;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        break;
                                                    case 4:
                                                        if (!regMac.test($('#' + aimID + '-type-' + types + '-mac').val())) {
                                                            $('#' + aimID + '-type-' + types + '-mac').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-mac"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-mac').focus();
                                                            isPass = false;
                                                        }
                                                        break;
                                                    }

  
                                                    switch(isPass)
                                                    {
                                                    case true:
                                                                                                            
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                        formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        $('#name-' + thisNo).html( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                                        
                                                        formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].type = $('#' + aimID + '-type').val();
                                                        formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                                        $('#type-' + thisNo).html( cgiRef[ aimID ].type[ dataObj[ aimID ][ cgiT ][ thisNo ].type ]);
                                                        
                                                        switch(parseInt($('#' + aimID + '-type').val()))
                                                        {
                                                        case 1:
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].startIp = $('#' + aimID + '-type-' + types + '-startIp').val();
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].endIp     = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].netmask = '255.255.255.255';
                                                            
                                                            formObj.startIp = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                                            formObj.endIp = dataObj[ aimID ][ cgiT ][ thisNo ].endIp;
                                                            formObj.netmask = dataObj[ aimID ][ cgiT ][ thisNo ].netmask;
                                                            
                                                            $('#detail-' + thisNo).html('Host: ' + dataObj[ aimID ][ cgiT ][ thisNo ].startIp + '/' + dataObj[ aimID ][ cgiT ][ thisNo ].netmask); 
                                                            break;
                                                        case 2:
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].startIp = calcObj.startIp;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].endIp     = calcObj.endIp;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].netmask = $('#' + aimID + '-type-' + types + '-netmask').val();
                                                            
                                                            formObj.startIp = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                                            formObj.endIp = dataObj[ aimID ][ cgiT ][ thisNo ].endIp;
                                                            formObj.netmask = dataObj[ aimID ][ cgiT ][ thisNo ].netmask;
                                                            
                                                            $('#detail-' + thisNo).html('Network: ' + dataObj[ aimID ][ cgiT ][ thisNo ].startIp + '/' + dataObj[ aimID ][ cgiT ][ thisNo ].netmask); 
                                                            break;
                                                        case 3:
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].startIp = $('#' + aimID + '-type-' + types + '-startIp').val();
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].endIp     = $('#' + aimID + '-type-' + types + '-endIp').val();
                                                            
                                                            formObj.startIp = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                                            formObj.endIp = dataObj[ aimID ][ cgiT ][ thisNo ].endIp;
                                                            
                                                            $('#detail-' + thisNo).html( 'Range: ' + dataObj[ aimID ][ cgiT ][ thisNo ].startIp + '-' + dataObj[ aimID ][ cgiT ][ thisNo ].endIp); 

                                                            break;
                                                        case 4:
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].mac = $('#' + aimID + '-type-' + types + '-mac').val();
                                                            formObj.mac = dataObj[ aimID ][ cgiT ][ thisNo ].mac;
                                                            
                                                            $('#detail-' + thisNo).html('Mac: ' + dataObj[ aimID ][ cgiT ][ thisNo ].mac);
                                                            break;
                                                        }
                                                        
                                                        
                                                        formObj.action = "1";
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                        });
                                                        
                                                        /* should be move insiide callback */
                                                        $( this ).dialog( "close" );
                                                        
                                                        /* ---- */
                                                        break;
                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                         
                                        });

                                        $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                        $('#' + aimID + '-type').append( genSelectOption('addressType1') ).val( dataObj[ aimID ][ cgiT ][ thisNo ].type).trigger('change');
                                        switch(parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].type))
                                        {
                                        case 1:
                                            $('#' + aimID + '-type-' + dataObj[ aimID ][ cgiT ][ thisNo ].type + '-startIp').val( dataObj[ aimID ][ cgiT ][ thisNo ].startIp );
                                            break;
                                        case 2:
                                            $('#' + aimID + '-type-' + dataObj[ aimID ][ cgiT ][ thisNo ].type + '-startIp').val( dataObj[ aimID ][ cgiT ][ thisNo ].startIp );
                                            $('#' + aimID + '-type-' + dataObj[ aimID ][ cgiT ][ thisNo ].type + '-netmask').val( dataObj[ aimID ][ cgiT ][ thisNo ].netmask );
                                            break;
                                        case 3:
                                            $('#' + aimID + '-type-' + dataObj[ aimID ][ cgiT ][ thisNo ].type + '-startIp').val( dataObj[ aimID ][ cgiT ][ thisNo ].startIp );
                                            $('#' + aimID + '-type-' + dataObj[ aimID ][ cgiT ][ thisNo ].type + '-endIp').val( dataObj[ aimID ][ cgiT ][ thisNo ].endIp );
                                            break;
                                        case 4:
                                            $('#' + aimID + '-type-' + dataObj[ aimID ][ cgiT ][ thisNo ].type + '-mac').val( dataObj[ aimID ][ cgiT ][ thisNo ].mac );
                                            break;
                                        }
                                        
                                    });
                                    
                                    
                                    break;
                                case 'group_address':
                                    cgiGetID = 'common_gAddr_list';
                                    cgiPostID = 'common_updateGAddr';
                                    cgiT = 'guiGAddrT';
                                    cgiTNum = 'guiGAddrTNum';
                                    
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#' + aimID + '-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                        $('#' + aimID + '-name').focus();
                                                    }

                                                    if (isPass) {
                                                                                                                
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                        
                                                        formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        
                                                        formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                                        
                                                        var arr = [];
                                                        $('#' + aimID + '-idList option').each(function() {
                                                            arr.push($(this).val());
                                                        });
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].num = arr.length;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].idList = arr.join(';');
                                                        formObj.num         = dataObj[ aimID ][ cgiT ][ thisNo ].num;
                                                        formObj.idList    = dataObj[ aimID ][ cgiT ][ thisNo ].idList;
                                                        
                                                        formObj.action    = "1";                                                        
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        /* should be move insiide callback */
                                                        
                                                        $('#div-groupName-' + thisNo).html( tooltipTable( aimID, 'groupName-' + thisNo,    dataObj[ aimID ][ cgiT ][ thisNo ].idList) );
                                                            
                                                        $(tableID).append(tmp);
                                                        $('.tooltipAccordion').accordion({
                                                            collapsible:true, 
                                                            active:false, 
                                                            autoHeight: false
                                                        });
                                                        
                                                        $( this ).dialog( "close" );

                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                        });
                                        
                                        $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                        
                                        switch( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].num ) > 0 )
                                        {
                                        case true:
                                            var arr = [];
                                            
                                            var tmp1 = "";
                                            var tmp2 = "";
                                            arr = dataObj[ aimID ][ cgiT ][ thisNo ].idList.split(regSemicolon);
                                            
                                            for (var i=0, ilen=parseInt( dataObj.address.guiAddrTNum ); i<ilen; i++)
                                            {
                                                var ifTag = false;
                                                for (var j=0, jlen=arr.length; j<jlen; j++)
                                                {
                                                    switch( arr[j] == dataObj.address.guiAddrT[i].gid ) 
                                                    {
                                                    case true:
                                                        ifTag = true;
                                                        tmp2 += '<option value="' + dataObj.address.guiAddrT[i].gid + '">' + dataObj.address.guiAddrT[i].name + '</option>';
                                                        break;
                                                        
                                                    }
                                                }
                                                switch (ifTag)
                                                {
                                                case false:
                                                    tmp1 += '<option value="' + dataObj.address.guiAddrT[i].gid + '">' + dataObj.address.guiAddrT[i].name + '</option>';
                                                    break;
                                                }
                                            }
        
                                            $('#' + aimID + '-idList').append(tmp2);
                                            $('#' + aimID + '-idListPool').append(tmp1);
                                            break;
                                        case false:
                                            var tmp1;
                                            for (var x in dataObj.service.guiServiceT)
                                            {
                                                tmp1 += '<option value="' + dataObj.address.guiAddrT[x].gid + '">' + dataObj.address.guiAddrT[x].name + '</option>';
                                            }
                                            $('#' + aimID + '-idListPool').append(tmp1);
                                            break;
                                        }
                                    });
                                    break;
                                case 'service':
                                    cgiGetID = 'common_service_list';
                                    cgiPostID = 'common_updateService';
                                    cgiT = 'guiServiceT';
                                    cgiTNum = 'guiServiceTNum';
                                    
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#service-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#service-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                        $('#service-name').focus();
                                                    }
                                                    
                                                    var types = parseInt($('#service-type option:selected').val());
                                                    var param;
                                                    switch(types)
                                                    {
                                                    case 0:
                                                    case 1:
                                                    case 2:
                                                        param = parseInt($('#service-type-' + types + '-param1').val());
                                                        if ( param < 1 || param > 65535 || isNaN(param)) {
                                                            $('#service-type-' + types + '-param1').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param1"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#service-type-' + types + '-parma1').focus();
                                                            isPass = false;
                                                        }
                                                        param = parseInt($('#service-type-' + types + '-param2').val());
                                                        if ( param < 1 || param > 65535 || isNaN(param)) {
                                                            $('#service-type-' + types + '-param2').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param2"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#service-type-' + types + '-parma2').focus();
                                                            isPass = false;
                                                        }
                                                        break;
                                                    case 3:
                                                    case 4:
                                                        param = parseInt($('#service-type-' + types + '-param1').val());
                                                        if ( param < 1 || param > 255 || isNaN(param)) {
                                                            $('#service-type-' + types + '-param1').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param1"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#service-type-' + types + '-parma1').focus();
                                                            isPass = false;
                                                        }
                                                        break;
                                                    }
        
                                                    if (isPass) {
                                                                                                                
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);

                                                        formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;

                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name        = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        $('#name-' + thisNo ).html( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                                        
                                                        if (dataObj[ aimID ][ cgiT ][ thisNo ].userDefined == "0")
                                                            formObj.userDefined = "0";
                                                        else 
                                                            formObj.userDefined = "1";
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].type = $('#' + aimID + '-type option:selected').val();
                                                        formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                                        $('#type-' + thisNo ).html( cgiRef[ aimID ].type[ dataObj[ aimID ][ cgiT ][ thisNo ].type ] );
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].param1 = $('#' + aimID + '-type-' + types + '-param1').val();
                                                        formObj.param1 = dataObj[ aimID ][ cgiT ][ thisNo ].param1;
                                                        $('#param1-' + thisNo ).html( dataObj[ aimID ][ cgiT ][ thisNo ].param1 );
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].param2 = ( types < 3 )? $('#' + aimID + '-type-' + types + '-param2').val() : "0";
                                                        formObj.param2 = dataObj[ aimID ][ cgiT ][ thisNo ].param2;
                                                        $('#param2-' + thisNo ).html( dataObj[ aimID ][ cgiT ][ thisNo ].param2 );
                                                        
                                                        formObj.action    = "1";                                                        
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        /* should be move insiide callback */
                                                                                                                    
                                                        $( this ).dialog( "close" );
                                                        
                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                        });
                                    
                                        $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name ).prop('disabled', true);
                                        $('#' + aimID + '-type').val( dataObj[ aimID ][ cgiT ][ thisNo ].type ).trigger('change').focus();
                                        $('#' + aimID + '-type-' + dataObj[ aimID ][ cgiT ][ thisNo ].type + '-param1').val( dataObj[ aimID ][ cgiT ][ thisNo ].param1 );
                                        $('#' + aimID + '-type-' + dataObj[ aimID ][ cgiT ][ thisNo ].type + '-param2').val( dataObj[ aimID ][ cgiT ][ thisNo ].param2 );
                                    });
                                    break;
                                case 'group_service':
                                    cgiGetID = 'common_gService_list';
                                    cgiPostID = 'common_updateGService';
                                    cgiT = 'guiGServiceT';
                                    cgiTNum = 'guiGServiceTNum';
                                    
                                    $('#extra').load('forms/' + aimID + '.html .extraForm', function() {
                                        $('.extraForm').dialog({
                                            width: 600,
                                            height:600,
                                            position: "center",
                                            resizable: false,
                                            modal: true,
                                            buttons: {
                                                OK: function() {
                                                    
                                                    isPass = true;
                                                    $('.errorLabel').remove();
                                                    if ($('#' + aimID + '-name').val().length == 0) {
                                                        isPass = false;
                                                        $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="group_service-name"><span class="error">name required</span></label>');
                                                        $('#' + aimID + '-name').focus();
                                                    }
                                                    var arr = [];
                                                    $('#' + aimID + '-idList option').each(function() {
                                                        arr.push($(this).val());
                                                    });
                                                    
                                                    if (isPass) {
                                                                                                                
                                                        formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);

                                                        formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;

                                                        dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                        formObj.name = dataObj[ aimID ][ cgiT ][ thisNo ].name;
                                                        
                                                        var arr = [];
                                                        $('#' + aimID + '-idList option').each(function() {
                                                            arr.push($(this).val());
                                                        });
                                                        
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].num = arr.length;
                                                        dataObj[ aimID ][ cgiT ][ thisNo ].idList = arr.join(';');
                                                        formObj.num         = dataObj[ aimID ][ cgiT ][ thisNo ].num;
                                                        formObj.idList    = dataObj[ aimID ][ cgiT ][ thisNo ].idList;
                                                        
                                                        $('#div-groupName-' + thisNo ).html( tooltipTable( aimID, 'groupName-' + thisNo,    dataObj[ aimID ][ cgiT ][ thisNo ].idList) );

                                                        formObj.action    = "1";                                                        
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        
                                                        $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                            // supposed to be here, but temporary move out 
                                                            // need to update gid after callback
                                                        });
                                                        
                                                        /* should be move insiide callback */
                                                            
                                                        $(tableID).append(tmp);
                                                        $('.tooltipAccordion').accordion({
                                                            collapsible:true, 
                                                            active:false, 
                                                            autoHeight: false
                                                        });
                                                        
                                                        $( this ).dialog( "close" );
                                                    
                                                    }
                                                },
                                                Cancel: function() {
                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            close: function(event, ui) {
                                                $(this).dialog('destroy').remove();
                                            }
                                        });
                                        
                                        $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name ).prop('disabled', true);
                                        
                                        switch( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].num ) > 0 )
                                        {
                                        case true:
                                            var arr = [];
                                            
                                            var tmp1 = "";
                                            var tmp2 = "";
                                            arr = dataObj[ aimID ][ cgiT ][ thisNo ].idList.split(regSemicolon);
                                            
                                            for (var i=0, ilen=parseInt( dataObj.service.guiServiceTNum ); i<ilen; i++)
                                            {
                                                var ifTag = false;
                                                for (var j=0, jlen=arr.length; j<jlen; j++)
                                                {
                                                    switch( arr[j] == dataObj.service.guiServiceT[i].gid ) 
                                                    {
                                                    case true:
                                                        ifTag = true;
                                                        tmp2 += '<option value="' + dataObj.service.guiServiceT[i].gid + '">' + dataObj.service.guiServiceT[i].name + '</option>';
                                                        break;
                                                        
                                                    }
                                                }
                                                switch (ifTag)
                                                {
                                                case false:
                                                    tmp1 += '<option value="' + dataObj.service.guiServiceT[i].gid + '">' + dataObj.service.guiServiceT[i].name + '</option>';
                                                    break;
                                                }
                                            }
        
                                            $('#' + aimID + '-idList').append(tmp2);
                                            $('#' + aimID + '-idListPool').append(tmp1).focus();
                                            break;
                                        case false:
                                            var tmp1;
                                            for (var x in dataObj.service.guiServiceT)
                                            {
                                                tmp1 += '<option value="' + dataObj.service.guiServiceT[x].gid + '">' + dataObj.service.guiServiceT[x].name + '</option>';
                                            }
                                            $('#' + aimID + '-idListPool').append(tmp1);
                                            break;
                                        }
                                    });
                                    break;

                                default:
                                
                                    $('#dialog').load('forms/' + aimID + '.html .dialogForm', function() {
                                        
                                        switch(aimID)
                                        {
                                        // interface
                                        case 'ports':
                                            cgiGetID = 'port';
                                            cgiPostID = 'port';
                                            cgiT = 'guiPortIfT';
                                            cgiTNum = 'guiPortIfTNum';
                                            var dhcpsT = 'guiDhcpsT';
                                            var ipAliasT = 'guiIpAliasT';
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        
                                                        if (isPass) {
                                                            for (var node in dataObj[ aimID ][ cgiT ][ thisNo ])
                                                            {
                                                                switch( node )
                                                                {
                                                                case 'gid':
                                                                case 'port':
                                                                case 'name':
                                                                case 'dhcpPool':
                                                                case 'linkStatus':
                                                                    break;
                                                                case 'cgiAction':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "2";
                                                                    break;
                                                                case 'address':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    $('#address-' + thisNo).html( $('#' + aimID + '-' + node).val() );
                                                                    break;
                                                                case 'speed':
                                                                case 'duplex':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    
                                                                    break;
                                                                case 'mtuMode':
                                                                    $('input[name=' + node + ']').each( function() {
                                                                        switch( $(this).is(':checked') ) 
                                                                        {
                                                                        case true:
                                                                            dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $(this).val();
                                                                            break;
                                                                        }
                                                                    });
                                                                    break;
                                                                case 'flowControl':
                                                                    switch($('#' + aimID + '-' + node).is(':checked'))
                                                                    {
                                                                    case true:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "1";
                                                                        break;
                                                                    case false:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "0";
                                                                        break;
                                                                    }
                                                                    break;
                                                                case 'zoneId':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    $('#zoneId-' + thisNo).html( $('#' + aimID + '-' + node + ' option:selected').text() );
                                                                    break;
                                                                default:
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                }
                                                            }
                                                        
                                                            for (var node in dataObj[ aimID ][ dhcpsT ][ thisNo ] )
                                                            {
                                                                switch( node )
                                                                {
                                                                case 'gid':
                                                                    break;
                                                                case 'type':
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#' + dhcpsT + '-dhcpType').val()
                                                                    break;
                                                                case 'relayIp':
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#' + dhcpsT + '-dhcpType-2-' + node).val();
                                                                    break;
                                                                default:
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#' + dhcpsT + '-dhcpType-1-' + node).val();
                                                                }
                                                            }
                                                            
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].address = "";
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask = "";
                                                            for (var i=0, len=cgiIpAlias.length, max=cgiIpAlias.length-1; i<len; i++) 
                                                            {
                                                                switch(i==max)
                                                                {
                                                                case true:
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].address += cgiIpAlias[ i ].address;
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask += cgiIpAlias[ i ].netmask;
                                                                    break;
                                                                case false:
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].address += cgiIpAlias[ i ].address + ';';
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask += cgiIpAlias[ i ].netmask + ';';
                                                                    break;
                                                                }
                                                            }
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].ipAliasCnt = cgiIpAlias.length;
                                                            
                                                            $('#speedDuplex-' + thisNo).html( cgiRef.port.speed[ dataObj[ aimID ][ cgiT ][ thisNo ].speed ] + '/' + cgiRef.port.duplex[ dataObj[ aimID ][ cgiT ][ thisNo ].duplex ]);
                                                            
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                         
                                            for (var node in dataObj[ aimID ][ cgiT ][ thisNo ])
                                            {
                                                switch( node )
                                                {
                                                case 'gid':
                                                case 'cgiAction':
                                                case 'port':
                                                    break;
                                                case 'name':
                                                    $('#' + aimID + '-' + node).html( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ); 
                                                    break;
                                                case 'speed':
                                                case 'duplex':
                                                    $('#' + aimID + '-' + node).append(genSelectOption( aimID + '-' + node )).val( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ).trigger('change');
                                                    break;
                                                case 'mtuMode':
                                                    $('input[name=' + node + ']').each( function() {
                                                        switch( parseInt( $(this).val() ) == parseInt( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ) )
                                                        {
                                                        case true:
                                                            $(this).attr('checked', true).trigger('click');
                                                            break;
                                                        }
                                                    });
                                                    break;
                                                case 'flowControl':
                                                    switch( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ) )
                                                    {
                                                    case 1:
                                                        $('#' + aimID + '-' + node).attr('checked', true);
                                                        break;
                                                    }
                                                    break;
                                                case 'zoneId':
                                                    cgiSelectOption(aimID + '-' + node , aimID, thisNo);
                                                    break;
                                                default:
                                                    $('#' + aimID + '-' + node).val( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ); 
                                                }
                                            }
                                        
                                            for (var node in dataObj[ aimID ][ dhcpsT ][ thisNo ] )
                                            {
                                                switch( node )
                                                {
                                                case 'gid':
                                                    break;
                                                case 'type':
                                                    $('#' + dhcpsT + '-dhcpType').append(genSelectOption( dhcpsT + '-dhcpType')).val( dataObj[ aimID ][ dhcpsT ][ thisNo ].type ).trigger('change');
                                                    break;
                                                case 'relayIp':
                                                    $('#' + dhcpsT + '-dhcpType-2-' + node).val( dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] ); 
                                                    break;
                                                default:
                                                    $('#' + dhcpsT + '-dhcpType-1-' + node).val( dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] ); 
                                                }
                                            }
                                            
                                            switch( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].speed ) )
                                            {
                                            case 0:
                                            case 1000:
                                                $('#' + aimID + '-duplex').val(0).prop('disabled', true);
                                                break;
                                            default:
                                                $('#' + aimID + '-duplex').prop('disabled', false);
                                            }
                                            genAliasTable(aimID, dataObj[ aimID ][ ipAliasT ][ thisNo ]);
                                            popTabs = $('.tabs').tabs();
                                            
                                            if (parseInt(cgiRef.routing.protoType) != 3)
                                               popTabs.tabs({"disabled": [2]});
                                            
                                            break;
                                        case 'lan':
                                            cgiGetID = 'lan';
                                            cgiPostID = 'lan';
                                            cgiT = 'guiLanIfT';
                                            cgiTNum = 'guiLanIfTNum';
                                            var dhcpsT = 'guiDhcpsT';
                                            var ipAliasT = 'guiIpAliasT';
                                            var ipAliasTNum = 'guiIpAliasTNum';
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if ($('#' + aimID + '-name').val().length == 0) {
                                                            isPass = false;
                                                            $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#' + aimID + '-name').focus();
                                                        }
                                                        
                                                        if (isNaN(parseInt($('#' + aimID + '-ipv6PrefixLength').val())) || parseInt( $('#' + aimID + '-ipv6PrefixLength').val() ) < 0 || parseInt( $('#' + aimID + '-ipv6PrefixLength') > 64 ) ) {
                                                            $('#' + aimID + '-ipv6PrefixLength').parents('td').append('<label class="errorLabel" for="' + aimID + '-ipv6PrefixLength"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-ipv6PrefixLength').focus();
                                                            isPass = false; 
                                                        }
                                                        
                                                        if ($('#' + aimID + '-address').val().length > 0 || $('#' + aimID + '-netmask').val().length > 0) {
                                                            if (regIpv4.test($('#' + aimID + '-address').val())) {
                                                            
                                                                calcObj.arr = $('#' + aimID + '-address').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-address').parents('td').append('<label class="errorLabel" for="' + aimID + '-address"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-address').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-address').parents('td').append('<label class="errorLabel" for="' + aimID + '-address"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-address').focus();
                                                                isPass = false; 
                                                            }
                                                            if (regIpv4.test($('#' + aimID + '-netmask').val())) {
                                                                calcObj.arr = $('#' + aimID + '-netmask').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-netmask"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-netmask').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-netmask').focus();
                                                                isPass = false; 
                                                            }
                                                        }
                                                        
                                                        switch(parseInt($('#' + dhcpsT +'-type').val()))
                                                        {
                                                        case 1:
                                                            
                                                            calcObj.start = [];
                                                            calcObj.end     = [];
                                                            if (regIpv4.test($('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').val())) {
                                                                calcObj.arr = $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').parents('td').append('<label class="errorLabel" for="' +dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() +    '-startIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    case false:
                                                                        calcObj.start.push( parseInt(calcObj.arr[i]) );
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-startIp').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            
                                                            if (regIpv4.test($('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').val())) {
                                                                calcObj.arr = $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' +dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() +    '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    case false:
                                                                        calcObj.end.push( parseInt(calcObj.arr[i]) );
                                                                        
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                isPass = false; 
                                                            }
                                                        
                                                            if (isPass) {
                                                                if (calcObj.start[0] > calcObj.end[0]) {
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                        isPass = false;
                                                                }else if (calcObj.start[0]== calcObj.end[0]) {
                                                                    if (calcObj.start[1] > calcObj.end[1]) {
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                            isPass = false;
                                                                    }else if (calcObj.start[1] == calcObj.end[1]) {
                                                                        if (calcObj.start[2] > calcObj.end[2]) {
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                            if (isPass)
                                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                                isPass = false;
                                                                        }else if ( calcObj.start[2] == calcObj.end[2]) {
                                                                            if ( calcObj.start[3] > calcObj.end[3] ) {
                                                                                $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp"><span class="error">range error</span></label>');
                                                                                if (isPass)
                                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-endIp').focus();
                                                                                    isPass = false;
                                                                            }
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                            
                                                            if (regIpv4.test($('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').val())) {
                                                                calcObj.arr = $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').parents('td').append('<label class="errorLabel" for="' +dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() +    '-gateway"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-gateway').focus();
                                                                isPass = false; 
                                                            }
                                                            break;
                                                        case 2:
                                                            if (regIpv4.test($('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').val())) {
                                                                calcObj.arr = $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').parents('td').append('<label class="errorLabel" for="' +dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() +    '-relayIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                                
                                                            }else {
                                                                $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').parents('td').append('<label class="errorLabel" for="' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + dhcpsT + '-type-' + $('#' + dhcpsT + '-type').val() + '-relayIp').focus();
                                                                isPass = false; 
                                                            }
                                                            break; 
                                                        }
                                                        
                                                        if (isPass) {
                                                            
                                                            for (var node in dataObj[ aimID ][ cgiT ][ thisNo ])
                                                            {
                                                                switch( node )
                                                                {
                                                                case 'gid':
                                                                case 'dhcpPool':
                                                                    break;
                                                                case 'name':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    $('#' + node + '-' + thisNo).html( $('#' + aimID + '-' + node).val() );
                                                                    break;
                                                                case 'address':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    $('#' + node + '-' + thisNo).html( $('#' + aimID + '-' + node).val() );
                                                                    break;
                                                                case 'netmask':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                case 'stp':
                                                                    switch( $('#' + aimID + '-stp').is(':checked') )
                                                                    {
                                                                    case true:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "1";
                                                                        break;
                                                                    case false:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "0";
                                                                        break;
                                                                    }
                                                                    break;
                                                                case 'interfaces':
                                                                    var arr = [];
                                                                    var ints = [];
                                                                    
                                                                    $('#' + aimID + '-interfaces option').each( function() {
                                                                        arr.push($(this).val());
                                                                        ints.push($(this).text());
                                                                    });
                                                                    
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = arr.join(';');
                                                                    
                                                                    $('#interfaces-' + thisNo).html( ints.join(';') );
                                                                    break;
                                                                case 'zone':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'ipv6Address':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'ipv6PrefixLength':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'cgiAction':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "2";
                                                                    break;
                                                                }
                                                            }
                                                            
                                                            var cnt = 0;
                                                            var addressArr = [];
                                                            var netmaskArr = [];
                                                            $('#table-ip_alias tbody tr').each(function() {
                                                                addressArr.push($('#ipAliasT-address-' + cnt).html());
                                                                netmaskArr.push($('#ipAliasT-netmask-' + cnt).html());
                                                                cnt++;
                                                            });
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].address = addressArr.join(';');
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask = netmaskArr.join(';');
                                                            
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].ipAliasCnt = addressArr.length;
                                                            
                                                            
                                                            for (var node in dataObj[ aimID ][ dhcpsT ][ thisNo ])
                                                            {
                                                                switch(node) 
                                                                {
                                                                case 'gid':
                                                                    break;
                                                                case 'type':
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#guiDhcpsT-type').val();
                                                                    break;
                                                                case 'relayIp':
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#guiDhcpsT-type-2-' + node ).val();
                                                                    break;
                                                                default:
                                                                    dataObj[ aimID ][ dhcpsT ][ thisNo ][ node ] = $('#guiDhcpsT-type-1-' + node ).val();
                                                                    
                                                                }
                                                            }
                                                        
                                                            $( this ).dialog( "close" );
                                                        }
                                                        
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });                                            
                                                                                
                                            genAliasTable(aimID, dataObj[ aimID ][ ipAliasT ][ thisNo ]);
                                            
                                            $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                            $('#' + aimID + '-address').val( dataObj[ aimID ][ cgiT ][ thisNo ].address );
                                            $('#' + aimID + '-netmask').val( dataObj[ aimID ][ cgiT ][ thisNo ].netmask );
                                            
                                            switch( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].stp ) )
                                            {
                                            case 1:
                                                $('#' + aimID + '-stp').attr('checked', true);
                                                break;
                                            }
                                                                                    
                                            cgiSelectOption(aimID + '-zone', aimID, thisNo);
                                            
                                            var arr = dataObj[ aimID ][ cgiT ][ thisNo ].interfaces.split(regSemicolon);
                                            
                                            for (var x in cgiGids.common_portIf_list)
                                            {
                                                if ( arr.indexOf( x ) != -1)
                                                    $('#' + aimID + '-interfaces').append('<option value="' + x    + '">' + cgiGids.common_portIf_list[ x ] + '</option>');
                                                else
                                                    $('#' + aimID + '-interfacesPool').append('<option value="' + x    + '">' + cgiGids.common_portIf_list[ x ] + '</option>');
                                            }
                                            
                                            for (var x in cgiGids.common_vlanIf_list)
                                            {
                                                if ( arr.indexOf( x ) != -1)
                                                    $('#' + aimID + '-interfaces').append('<option value="' + x    + '">' + cgiGids.common_vlanIf_list[ x ] + '</option>');
                                                else
                                                    $('#' + aimID + '-interfacesPool').append('<option value="' + x    + '">' + cgiGids.common_vlanIf_list[ x ] + '</option>');
                                            }
                                            
                                            $('#' + aimID + '-ipv6Address').val( dataObj[ aimID ][ cgiT ][ thisNo ].ipv6Address );
                                            $('#' + aimID + '-ipv6PrefixLength').val( dataObj[ aimID ][ cgiT ][ thisNo ].ipv6PrefixLength );
                                            
                                            $('#guiDhcpsT-type').append(genSelectOption('guiDhcpsT-type')).val( dataObj[ aimID ].guiDhcpsT[ thisNo ].type ).trigger('change'); 
                                                                                    
                                            $('#guiDhcpsT-type-1-startIp').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].startIp ); 
                                            $('#guiDhcpsT-type-1-endIp').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].endIp );         
                                            $('#guiDhcpsT-type-2-relayIp').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].relayIp );     
                                            $('#guiDhcpsT-type-1-leaseTime').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].leaseTime ); 
                                            $('#guiDhcpsT-type-1-gateway').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].gateway );     
                                            $('#guiDhcpsT-type-1-dns1').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].dns1 );            
                                            $('#guiDhcpsT-type-1-dns2').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].dns2 );            
                                            $('#guiDhcpsT-type-1-wins1').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].wins1 );
                                            $('#guiDhcpsT-type-1-wins2').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].wins2 );         
                                            $('#guiDhcpsT-type-1-domainName').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].domainName ); 
                                            
                                            popTabs = $('.tabs').tabs();
                                            
                                            if (parseInt(cgiRef.routing.protoType) != 3)
                                               popTabs.tabs({"disabled": [2]});
                                            
                                                                            
                                            break;
                                        case 'vlan_interfaces':
                                            cgiGetID = 'vlan';
                                            cgiPostID = 'vlan';
                                            cgiT = 'guiVlanIfT';
                                            cgiTNum = 'guiVlanIfTNum';
                                            var dhcpsT = 'guiDhcpsT';
                                            var dhcpsTNum    = 'guiDhcpsTNum';
                                            var ipAliasT = 'guiIpAliasT';
                                            var ipAliasTNum = 'guiIpAliasTNum';
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        calcObj = {};
                                                        
                                                        if ($('#' + aimID + '-name').val().length == 0) {
                                                            isPass = false;
                                                            $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#' + aimID + '-name').focus();
                                                        }

                                                        if (isNaN(parseInt($('#' + aimID + '-vid').val())) || parseInt($('#' + aimID + '-vid').val()) < 1 || parseInt( $('#' + aimID + '-vid').val() ) > 4094) {
                                                            $('#' + aimID + '-vid').parents('td').append('<label class="errorLabel" for="' + aimID + '-vid"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-vid').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            // tell if vid unique in this interface
                                                            for (var x in dataObj[ aimID ][ cgiT ])
                                                            {
                                                                if (x != thisNo) {
                                                                    if ($('#' + aimID + '-interface').val() == dataObj[ aimID ][ cgiT ][ x ].interface) {
                                                                        if ($('#' + aimID + '-vid').val() == dataObj[ aimID ][ cgiT ][ x ].vid) {
                                                                            $('#' + aimID + '-vid').parents('td').append('<label class="errorLabel" for="' + aimID + '-vid"><span class="error">must be unique</span></label>');
                                                                            isPass = false;
                                                                            $('#' + aimID + '-vid').focus();
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                        
                                                        if ($('#' + aimID + '-address').val().length > 0 || $('#' + aimID + '-netmask').val().length > 0) {
                                                            if (regIpv4.test($('#' + aimID + '-address').val())) {
                                                            
                                                                calcObj.arr = $('#' + aimID + '-address').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-address').parents('td').append('<label class="errorLabel" for="' + aimID + '-address"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-address').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-address').parents('td').append('<label class="errorLabel" for="' + aimID + '-address"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-address').focus();
                                                                isPass = false; 
                                                            }
                                                            if (regIpv4.test($('#' + aimID + '-netmask').val())) {
                                                                calcObj.arr = $('#' + aimID + '-netmask').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-netmask"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-netmask').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-netmask').focus();
                                                                isPass = false; 
                                                            }
                                                        }
                                                        
                                                        $('input[name=mtuMode]').each(function() {
                                                            if ($(this).is(':checked') && parseInt($(this).val()) == 1) {
                                                                if (isNaN( parseInt($('#' + aimID + '-mtuValue').val()) ) || parseInt($('#' + aimID + '-mtuValue').val()) < 64 || parseInt($('#' + aimID + '-mtuValue').val()) > 1500 ) {
                                                                  $('#' + aimID + '-mtuValue').parents('td').append('<label class="errorLabel" for="' + aimID + '-mtuValue"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-mtuValue').focus();
                                                                    isPass = false;   
                                                                }
                                                            }
                                                        });
                                                        
                                                        switch(parseInt( $('#' + aimID + 'dhcpType') ) )
                                                        {
                                                        case 1:
                                                            if (regIpv4.test($('#' + aimID + '-dhcpType-1-startIp').val())) {
                                                                calcObj.arr = $('#' + aimID + '-dhcpType-1-startIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-dhcpType-1-startIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-startIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-dhcpType-1-startIp').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-dhcpType-1-startIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-startIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dhcpType-1-startIp').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            if (regIpv4.test($('#' + aimID + '-dhcpType-1-endIp').val())) {
                                                                calcObj.arr = $('#' + aimID + '-dhcpType-1-endIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-dhcpType-1-endIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-startIp"><endIp class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-dhcpType-1-endIp').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-dhcpType-1-endIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-endIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dhcpType-1-endIp').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            if (regIpv4.test($('#' + aimID + '-dhcpType-1-gateway').val())) {
                                                                calcObj.arr = $('#' + aimID + '-dhcpType-1-gateway').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-dhcpType-1-gateway').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-gateway"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-dhcpType-1-gateway').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-dhcpType-1-gateway').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-1-gateway"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dhcpType-1-gateway').focus();
                                                                isPass = false; 
                                                            }
                                                            break;
                                                        case 2:
                                                            if (regIpv4.test($('#' + aimID + '-dhcpType-2-relayIp').val())) {
                                                                calcObj.arr = $('#' + aimID + '-dhcpType-2-relayIp').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-dhcpType-2-netmask').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-2-relayIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-dhcpType-2-relayIp').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else{
                                                                $('#' + aimID + '-dhcpType-2-relayIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-dhcpType-2-relayIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dhcpType-2-relayIp').focus();
                                                                isPass = false; 
                                                            }
                                                            break;
                                                        }
                                                        
                                                        if (isNaN(parseInt($('#' + aimID + '-ipv6PrefixLength').val())) || parseInt( $('#' + aimID + '-ipv6PrefixLength').val() ) < 0 || parseInt( $('#' + aimID + '-ipv6PrefixLength') > 128 ) ) {
                                                            $('#' + aimID + '-ipv6PrefixLength').parents('td').append('<label class="errorLabel" for="' + aimID + '-ipv6PrefixLength"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-ipv6PrefixLength').focus();
                                                            isPass = false; 
                                                        }
                                                        
                                                        if (isPass) {
                                                                                                                                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                            $('#name-' + thisNo ).val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                                            
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].interface = $('#' + aimID + '-interface').val();
                                                            $('#interface-' + thisNo).html( $('#' + aimID + '-interface option:selected').html() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].vid = $('#' + aimID + '-vid').val();
                                                            $('#vid-' + thisNo).html( $('#' + aimID + '-vid').val() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].address = $('#' + aimID + '-address').val();
                                                            $('#address-' + thisNo).html( $('#' + aimID + '-address').val() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].netmask = $('#' + aimID + '-netmask').val();
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].dhcpType = $('#' + aimID + '-dhcptype').val();     
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].mtuMode = $('input[name=mtuMode]:checked').val();
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].mtuValue = $('#' + aimID + '-mtuValue').val();
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].zone = $('#' + aimID + '-zone').val();
                                                            $('#zone-' + thisNo).html( cgiHash[ $('#' + aimID + '-zone option:selected').html() ] );
                                                            
                                                            $(tableID).append(tmp);
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2";
                                                            
                                                            // ipalias

                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].address = "";
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask = "";
                                                            for (var i=0, len=cgiIpAlias.length, max=cgiIpAlias.length-1; i<len; i++) 
                                                            {
                                                                switch(i==max)
                                                                {
                                                                case true:
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].address += cgiIpAlias[ i ].address;
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask += cgiIpAlias[ i ].netmask;
                                                                    break;
                                                                case false:
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].address += cgiIpAlias[ i ].address + ';';
                                                                    dataObj[ aimID ][ ipAliasT ][ thisNo ].netmask += cgiIpAlias[ i ].netmask + ';';
                                                                    break;
                                                                }
                                                            }
                                                            dataObj[ aimID ][ ipAliasT ][ thisNo ].ipAliasCnt = cgiIpAlias.length;
                                                            
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].gid         = "0";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].type        = $('#' + aimID + '-dhcpType').val();
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].startIp     = $('#' + aimID + '-dhcpType-1-startIp').val()     || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].endIp       = $('#' + aimID + '-dhcpType-1-endIp').val()       || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].relayIp     = $('#' + aimID + '-dhcpType-2-relayIp').val()     || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].leaseTime   = $('#' + aimID + '-dhcpType-1-leaseTime').val()   || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].gateway     = $('#' + aimID + '-dhcpType-1-gateway').val()     || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].dns1        = $('#' + aimID + '-dhcpType-1-dns1').val()        || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].dns2        = $('#' + aimID + '-dhcpType-1-dns2').val()        || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].wins1       = $('#' + aimID + '-dhcpType-1-wins1').val()       || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].wins2       = $('#' + aimID + '-dhcpType-1-wins2').val()       || "";
                                                            dataObj[ aimID ].guiDhcpsT[ thisNo ].domainName  = $('#' + aimID + '-dhcpType-1-domainName').val()  || "";
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
    
                                            
                                            $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                                                                    
                                            $('#' + aimID + '-vid').val( dataObj[ aimID ][ cgiT ][ thisNo ].vid );
                                            
                                            $('#' + aimID + '-address').val( dataObj[ aimID ][ cgiT ][ thisNo ].address );
                                            
                                            $('#' + aimID + '-netmask').val( dataObj[ aimID ][ cgiT ][ thisNo ].netmask );
                                            
                                            $('input[name=mtuMode]').each(function() {
                                                if ($(this).val() == dataObj[ aimID ][ cgiT ][ thisNo ].mtuMode)
                                                    $(this).click();
                                            });
                                            $('#' + aimID + '-mtuValue').val( dataObj[ aimID ][ cgiT ][ thisNo ].mtuValue );
                                        
                                            genAliasTable(aimID, dataObj[ aimID ].guiIpAliasT[ thisNo ]);
                                                
                                            $('#' + aimID + '-interface').append( genSelectOption( aimID + '-interface') ).val( dataObj[ aimID ].guiDhcpsT[ thisNo ].interface ).trigger('change');
                                            cgiSelectOption(aimID + '-zone', aimID, thisNo);
                                            
                                            $('#' + aimID + '-dhcpType').append(genSelectOption(aimID + '-dhcpType')).val( dataObj[ aimID ].guiDhcpsT[ thisNo ].type ).trigger('change');
                                            
                                            $('#' + aimID + '-dhcpType-1-startIp').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].startIp ); 
                                            $('#' + aimID + '-dhcpType-1-endIp').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].endIp );         
                                            $('#' + aimID + '-dhcpType-2-relayIp').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].relayIp );     
                                            $('#' + aimID + '-dhcpType-1-leaseTime').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].leaseTime ); 
                                            $('#' + aimID + '-dhcpType-1-gateway').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].gateway );     
                                            $('#' + aimID + '-dhcpType-1-dns1').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].dns1 );            
                                            $('#' + aimID + '-dhcpType-1-dns2').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].dns2 );            
                                            $('#' + aimID + '-dhcpType-1-wins1').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].wins1 );
                                            $('#' + aimID + '-dhcpType-1-wins2').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].wins2 );         
                                            $('#' + aimID + '-dhcpType-1-domainName').val(dataObj[ aimID ][ dhcpsT ][ thisNo ].domainName );
                                            
                                            $('#' + aimID + '-ipv6Address').val( dataObj[ aimID ][ cgiT ][ thisNo ].ipv6Address );
                                            $('#' + aimID + '-ipv6PrefixLength').val( dataObj[ aimID ][ cgiT ][ thisNo ].ipv6PrefixLength );
                                            
                                            popTabs = $('.tabs').tabs();
                                            
                                            if (parseInt(cgiRef.routing.protoType) != 3)
                                               popTabs.tabs({"disabled": [2]});
                                            
    
                                            break;
                                        case 'wan':
                                            cgiGetID = 'wan';
                                            cgiPostID = 'wan';
                                            cgiT = 'wanIpIfT';
                                            cgiTNum = dataObj[ aimID ][ cgiT ].length;

                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        calcObj = {};
                                                        if (parseInt( $('#' + cgiT + '-wanProto').val() ) == 0) {
                                                            if (regIpv4.test($('#staticipT-ip').val())) {
                                                                calcObj.arr = $('#staticipT-ip').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#staticipT-ip').parents('td').append('<label class="errorLabel" for="staticipT-ip"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#staticipT-ip').focus();
                                                                        isPass = false;
                                                                        break;
            
                                                                    }
                                                                }
                                                            }else {
                                                                $('#staticipT-ip').parents('td').append('<label class="errorLabel" for="staticipT-ip"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#staticipT-ip').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            if (regIpv4.test($('#staticipT-netmask').val())) {
                                                                calcObj.arr = $('#staticipT-netmask').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#staticipT-netmask').parents('td').append('<label class="errorLabel" for="staticipT-netmask"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#staticipT-netmask').focus();
                                                                        isPass = false;
                                                                        break;
            
                                                                    }
                                                                }
                                                            }else {
                                                                $('#staticipT-netmask').parents('td').append('<label class="errorLabel" for="staticipT-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#staticipT-netmask').focus();
                                                                isPass = false; 
                                                            }
                                                            
                                                            if (regIpv4.test($('#staticipT-gateway').val())) {
                                                                calcObj.arr = $('#staticipT-gateway').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#staticipT-gateway').parents('td').append('<label class="errorLabel" for="staticipT-gateway"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#staticipT-gateway').focus();
                                                                        isPass = false;
                                                                        break;
            
                                                                    }
                                                                }
                                                            }else {
                                                                $('#staticipT-gateway').parents('td').append('<label class="errorLabel" for="staticipT-gateway"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#staticipT-gateway').focus();
                                                                isPass = false; 
                                                            }
                                                        }
                                                        
                                                        
                                                        $('input[name=mtuMode]').each(function() {
                                                            if ($(this).is(':checked') && parseInt($(this).val()) == 1) {
                                                                if (isNaN( parseInt($('#mtu').val()) ) || parseInt($('#mtu').val()) < 64 || parseInt($('#mtu').val()) > 1500 ) {
                                                                  $('#mtu').parents('td').append('<label class="errorLabel" for="mtu"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#mtu').focus();
                                                                    isPass = false;   
                                                                }
                                                            }
                                                        });
                                                        
                                                        $('input[name=macColneEnable]').each(function() {
                                                            if ($(this).is(':checked') && parseInt($(this).val()) == 1) {
                                                                if (!regMac.test( $('#macClone').val() )) {
                                                                  $('#macClone').parents('td').append('<label class="errorLabel" for="macClone"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#macClone').focus();
                                                                    isPass = false;   
                                                                }
                                                            }
                                                        });
                                                        
                                                        if (isPass) {
                                                            for (var node in dataObj[ aimID ].wanIpIfT[ thisNo ])
                                                            {
                                                                switch(node)
                                                                {
                                                                case 'name':
                                                                case 'gid':
                                                                    break;
                                                                case 'wanProto':
                                                                    
                                                                    dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $('#wanIpIfT-' + node).val();
                                                                    $('#' + node + '-' + thisNo).html( $('#wanIpIfT-' + node + " option:selected").text() );
                                                                    switch($('#wanIpIfT-' + node).val())
                                                                    {
                                                                    case '0':
                                                                        dataObj[ aimID ].staticipT[ thisNo ].ip = $('#staticipT-ip').val();
                                                                        dataObj[ aimID ].staticipT[ thisNo ].netmask = $('#staticipT-netmask').val();
                                                                        dataObj[ aimID ].staticipT[ thisNo ].gateway = $('#staticipT-gateway').val();
                                                                        $('#address-' + thisNo).html( $('#staticipT-ip').val() );
                                                                        $('input[name=mtuMode]').each(function() {
                                                                            switch($(this).is(':checked'))
                                                                            {
                                                                            case true:
                                                                                dataObj[ aimID ].staticipT[ thisNo ].mtuMode = $(this).val();
                                                                                switch($(this).val())
                                                                                {
                                                                                case '0':
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].mtu = 1500;
                                                                                    break;
                                                                                case '1':
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].mtu = $('#mtu').val();
                                                                                    break;
                                                                                }
                                                                                break;
                                                                            }
                                                                        });
                                                                        $('input[name=dnsMode]').each(function() {
                                                                            switch($(this).is(':checked'))
                                                                            {
                                                                            case true:
                                                                                dataObj[ aimID ].staticipT[ thisNo ].dnsMode = $(this).val();
                                                                                switch($(this).val())
                                                                                {
                                                                                case '0':
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].userDns1 = "";
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].userDns2 = "";
                                                                                    break;
                                                                                case '1':
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].userDns1 = $('#userDns1').val();
                                                                                    dataObj[ aimID ].staticipT[ thisNo ].userDns2 = $('#userDns2').val();
                                                                                    break;
                                                                                }
                                                                                break;
                                                                            }
                                                                        });
                                                                        break;
                                                                    case '1':
                                                                        $('#address-' + thisNo).html( dataObj[ aimID ].wanIpIfT[ thisNo ].address );
                                                                        $('input[name=mtuMode]').each(function() {
                                                                            switch($(this).is(':checked'))
                                                                            {
                                                                            case true:
                                                                                dataObj[ aimID ].dhcpcT[ thisNo ].mtuMode = $(this).val();
                                                                                switch($(this).val())
                                                                                {
                                                                                case '0':
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].mtu = "1500";
                                                                                    break;
                                                                                case '1':
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].mtu = $('#mtu').val();
                                                                                    break;
                                                                                }
                                                                                break;
                                                                            }
                                                                        });
                                                                        $('input[name=dnsMode]').each(function() {
                                                                            switch($(this).is(':checked'))
                                                                            {
                                                                            case true:
                                                                                dataObj[ aimID ].dhcpcT[ thisNo ].dnsMode = $(this).val();
                                                                                switch($(this).val())
                                                                                {
                                                                                case '0':
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].userDns1 = "";
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].userDns2 = "";
                                                                                    break;
                                                                                case '1':
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].userDns1 = $('#userDns1').val();
                                                                                    dataObj[ aimID ].dhcpcT[ thisNo ].userDns2 = $('#userDns2').val();
                                                                                    break;
                                                                                }
                                                                                break;
                                                                            }
                                                                        });
                                                                        break;
                                                                    }
                                                                    break;
                                                                case 'weight':
                                                                case 'portId':
                                                                case 'zoneId':
                                                                    dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $('#wanIpIfT-' + node).val();
                                                                    $('#' + node + '-' + thisNo).html( $('#wanIpIfT-' + node + ' option:selected').text() );
                                                                    break;
                                                                case 'backupWanName':
                                                                    if ($('#' + cgiT + '-' + node).val() == 'selectOption')
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "";
                                                                    else 
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + cgiT + '-' + node).val();
                                                                    $('#' + node + '-' + thisNo).html( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] );    
                                                                    break;
                                                                case 'macCloneEnable':
                                                                    $('input[name=' + node + ']').each(function() {
                                                                        switch($(this).is(':checked'))
                                                                        {
                                                                        case true:
                                                                            dataObj[ aimID ].wanIpIfT[ thisNo ].macCloneEnable = $(this).val();
                                                                            switch($(this).val())
                                                                            {
                                                                            case '0':
                                                                                dataObj[ aimID ].wanIpIfT[ thisNo ].macClone = "";
                                                                                break;
                                                                            case '1':
                                                                                dataObj[ aimID ].wanIpIfT[ thisNo ].macClone = $('#macClone').val();
                                                                                break;
                                                                            }
                                                                            break;
                                                                        }
                                                                    });
                                                                    break;
                                                                case 'netDetectEnable':
                                                                case 'failoverEnable':
                                                                    switch($('#wanIpIfT-' + node).is(':checked'))
                                                                    {
                                                                    case true:
                                                                        dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = "1";
                                                                        break;
                                                                    case false:
                                                                        dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = "0";
                                                                        break;
                                                                    }
                                                                    break;
                                                                case 'netDetectMethod':
                                                                    $('input[name=wanIpIfT-' + node + ']').each(function() {
                                                                        switch($(this).is(':checked'))
                                                                        {
                                                                        case true:
                                                                            dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $(this).val();
                                                                            break;
                                                                        }
                                                                    });
                                                                    break;
                                                                case 'wanProto_v6':
                                                                    dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $('#wanIpIfT-' + node).val();
                                                                    for (var x in dataObj[ aimID ].staticip6T[ thisNo ]) {
                                                                        switch( x)
                                                                        {
                                                                        case 'gid':
                                                                            break;
                                                                        default:
                                                                            switch( parseInt( $('#wanIpIfT-' + node).val() ) )
                                                                            {
                                                                            case 0:
                                                                                dataObj[ aimID ].staticip6T[ thisNo ][ x ] = $('#wanIpIfT-wanProto_v6-' + $('#wanIpIfT-' + node).val() + '-' + x).val();
                                                                                break;
                                                                            default:
                                                                                dataObj[ aimID ].staticip6T[ thisNo ][ x ] = "";
                                                                            }
                                                                        }
                                                                    }
                                                                    
                                                                    break;
     
                                                                default:
                                                                    if ($('#wanIpIfT-' + node).length > 0)
                                                                        dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] = $('#wanIpIfT-' + node).val();
                                                                }
                                                            }
                                                            // ipalias
    
                                                            dataObj[ aimID ].ipAliasT[ thisNo ].address = "";
                                                            dataObj[ aimID ].ipAliasT[ thisNo ].netmask = "";
                                                            for (var i=0, len=cgiIpAlias.length, max=cgiIpAlias.length-1; i<len; i++) 
                                                            {
                                                                switch(i==max)
                                                                {
                                                                case true:
                                                                    dataObj[ aimID ].ipAliasT[ thisNo ].address += cgiIpAlias[ i ].address;
                                                                    dataObj[ aimID ].ipAliasT[ thisNo ].netmask += cgiIpAlias[ i ].netmask;
                                                                    break;
                                                                case false:
                                                                    dataObj[ aimID ].ipAliasT[ thisNo ].address += cgiIpAlias[ i ].address + ';';
                                                                    dataObj[ aimID ].ipAliasT[ thisNo ].netmask += cgiIpAlias[ i ].netmask + ';';
                                                                    break;
                                                                }
                                                            }
                                                            
                                                            if (parseInt( dataObj[ aimID ].wanIpIfT[ thisNo ].gid) > 0)
                                                                dataObj[ aimID ].wanIpIfT[ thisNo ].cgiAction = "2";
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                            
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                                            
                                            for (var node in dataObj[ aimID ].wanIpIfT[ thisNo ])
                                            {
                                                switch(node)
                                                {
                                                case 'gid':
                                                
                                                    break;
                                                case 'name':
                                                    $('#wanIpIfT-' + node).html( dataObj[ aimID ].wanIpIfT[ thisNo ].name );
                                                    break;
                                                case 'portId':
                                                    $('#wanIpIfT-' + node).append( genSelectOption('wanIpIfT-'+node) ).val( dataObj[ aimID ].wanIpIfT[ thisNo ][node] ).trigger('change');
                                                    break;
                                                case 'zoneId':
                                                    cgiSelectOption('wanIpIfT-' + node, aimID, thisNo);
                                                    break;
                                                case 'wanProto':
                                                    $('#wanIpIfT-' + node).append( genSelectOption('wanIpIfT-'+node) ).val( dataObj[ aimID ].wanIpIfT[ thisNo ][node] ).trigger('change');
    
                                                    switch( dataObj[ aimID ].wanIpIfT[ thisNo ][ node ])
                                                    {
                                                    case '0':
                                                        $('#staticipT-ip').val( dataObj[ aimID ].staticipT[ thisNo ].ip );
                                                        $('#staticipT-netmask').val( dataObj[ aimID ].staticipT[ thisNo ].netmask );
                                                        $('#staticipT-gateway').val( dataObj[ aimID ].staticipT[ thisNo ].gateway );
                                                        $('#mtu').val( dataObj[ aimID ].staticipT[ thisNo ].mtu);
                                                        $('#userDns1').val( dataObj[ aimID ].staticipT[ thisNo ].userDns1);
                                                        $('#userDns2').val( dataObj[ aimID ].staticipT[ thisNo ].userDns2);
                                                        $('input[name=mtuMode]').each(function() {
                                                            switch($(this).val() == dataObj[ aimID ].staticipT[ thisNo ].mtuMode)
                                                            {
                                                            case true:
                                                                $(this).attr('checked', true).trigger('click');
                                                                break;
                                                            }
                                                        });
                                                        $('input[name=dnsMode]').each(function() {
                                                            switch($(this).val() == dataObj[ aimID ].staticipT[ thisNo ].dnsMode)
                                                            {
                                                            case true:
                                                                $(this).attr('checked', true).trigger('click');
                                                                break;
                                                            }
                                                        });
                                                        break;
                                                    case '1':
                                                        $('#mtu').val( dataObj[ aimID ].dhcpcT[ thisNo ].mtu);
                                                        $('#userDns1').val( dataObj[ aimID ].dhcpcT[ thisNo ].userDns1);
                                                        $('#userDns2').val( dataObj[ aimID ].dhcpcT[ thisNo ].userDns2);
                                                        $('input[name=mtuMode]').each(function() {
                                                            switch($(this).val() == dataObj[ aimID ].dhcpcT[ thisNo ].mtuMode)
                                                            {
                                                            case true:
                                                                $(this).attr('checked', true).trigger('click');
                                                                break;
                                                            }
                                                        });
                                                        $('input[name=dnsMode]').each(function() {
                                                            switch($(this).val() == dataObj[ aimID ].dhcpcT[ thisNo ].dnsMode)
                                                            {
                                                            case true:
                                                                $(this).attr('checked', true).trigger('click');
                                                                break;
                                                            }
                                                        });
                                                        break;
                                                    }
                                                    break;
                                                case 'macCloneEnable':
                                                    $('#macClone').val( dataObj[ aimID ].wanIpIfT[ thisNo ].macClone);
                                                    $('input[name=' + node + ']').each(function() {
                                                        switch($(this).val() == dataObj[ aimID ].wanIpIfT[ thisNo ][ node ])
                                                        {
                                                        case true:
                                                            $(this).attr('checked', true).trigger('click');
                                                            break;
                                                        }
                                                    });
                                                    break;
                                                case 'netDetectEnable':
                                                case 'failoverEnable':
                                                    switch( dataObj[ aimID ].wanIpIfT[ thisNo ][ node ] )
                                                    {
                                                    case '1':
                                                        $('#wanIpIfT-' + node).attr('checked', true);
                                                        break;
                                                    default:
                                                        $('.wanIpIfT-' + node + '-checked').prop('disabled', true);
                                                    }
                                                    break;
                                                case 'netDetectMethod':
                                                    $('input[name=wanIpIfT-' + node + ']').each(function() {
                                                        switch($(this).val() == dataObj[ aimID ].wanIpIfT[ thisNo ][ node ])
                                                        {
                                                        case true:
                                                            $(this).attr('checked', true);
                                                            break;
                                                        case false:
                                                            $('.wanIpIfT-netDetectMethod-' + $(this).val()).prop('disabled', true);
                                                            break;
                                                        }
                                                    });
                                                    break;
                                                case 'netDetectPingIpId':
                                                case 'netDetectDnsIpId':
                                                    $('#wanIpIfT-' + node).append( genSelectOption('wanIpIfT-'+node) ).val( dataObj[ aimID ].wanIpIfT[ thisNo ][node] );
                                                    break;
                                                case 'wanProto_v6':
                                                    $('#wanIpIfT-' + node).val( dataObj[ aimID ].wanIpIfT[ thisNo ][node]).trigger('change');
                                                    for (var x in dataObj[ aimID ].staticip6T[ thisNo ] )
                                                        $('#staticip6T-' + x).val( dataObj[ aimID ].staticip6T[ thisNo ][ x ] );
                                                    break;
                                                case 'backupWanName':
                                                    var tmp = '<option value="selectOption">Select WAN</option>';
                                                    for (var x in cgiRef[ aimID ].wan)
                                                    {
                                                        if (cgiRef[ aimID ].wan[ x ] != dataObj[ aimID ][ cgiT ][ thisNo ].name)
                                                            tmp += '<option value="' + cgiRef[ aimID ].wan[ x ] + '">' + cgiRef[ aimID ].wan[ x ] + '</option>';
                                                    }
                                                    $('#' + cgiT + '-' + node).append( tmp ).val( dataObj[ aimID ].wanIpIfT[ thisNo ][node] ).trigger('change');
                                                    break;
                                                default:
                                                    $('#wanIpIfT-' + node).val( dataObj[ aimID ].wanIpIfT[ thisNo ][node]);
                                                }
                                            }
                                            
                                            for (var node in dataObj[ aimID ].staticip6T[ thisNo ]) 
                                            {
                                                switch(node)
                                                {
                                                case 'gid':
                                                    break;
                                                default:
                                                    $('#wanIpIfT-wanProto_v6-0-' + node).val( dataObj[ aimID ].staticip6T[ thisNo ][node] );
                                            
                                                }
                                            }
                                            
                                            genAliasTable(aimID, dataObj[ aimID ].ipAliasT[ thisNo ]);
                                            $('.tabs').tabs();
                                            break;
                                        case 'zone':
                                            cgiGetID = 'zone';
                                            cgiPostID = 'zone';
                                            cgiT = 'guiZoneIfT';
                                            cgiTNum = 'guiZoneIfTNum';
                                            $('.dialogForm').dialog({
                                                width: 600,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        if ($('#' + aimID + '-name').val().length == 0) {
                                                            isPass = false;
                                                            $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#' + aimID + '-name').focus();
                                                        }
                                                        
                                                        if ($('#' + aimID + '-securityLevel').val().length == 0 || parseInt( $('#' + aimID + '-securityLevel').val() ) < 0 && parseInt( $('#' + aimID + '-securityLevel').val() ) < 101) {
                                                            $('#' + aimID + '-securityLevel').parents('td').append('<label class="errorLabel" for="' + aimID + '-securityLevel"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-securityLevel').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                            //$('#name-' + thisNo).html( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].securityLevel = $('#' + aimID + '-securityLevel').val();
                                                            //$('#securityLevel-' + thisNo ).html( dataObj[ aimID ][ cgiT ][ thisNo ].securityLevel );
                                                            var arr = [];
                                                            var mems = [];
                                                            
                                                            $('#' + aimID + '-member option').each( function() {
                                                                arr.push($(this).val());
                                                                mems.push($(this).text());
                                                            });
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].memberCnt = arr.length;
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].member = arr.join(';');
                                                            
                                                            //$('#member-' + thisNo).html( mems.join(';') );
                                                            
                                                            if (parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].gid) > 0)
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2";

                                                            // reset zone options
                                                            for (var x in dataObj[ aimID ][ cgiT ]) 
                                                            {
                                                                if (x != thisNo) {
                                                                    var arrs = dataObj[ aimID ][ cgiT ][ x ].member.split(';');
                                                                    var news = [];
                                                                    var tag = false;
                                                                    for (var y in arrs)
                                                                    {
                                                                        if (arr.indexOf( arrs[ y ] ) != -1 )
                                                                            tag = true;
                                                                        else if (!isNaN(parseInt( arrs[ y ] )))
                                                                            news.push(arrs[ y ]);
                                                                    }
                                                                    
                                                                    if (tag) {
                                                                        dataObj[ aimID ][ cgiT ][ x ].member = news.join(';');
                                                                        if (parseInt(dataObj[ aimID ][ cgiT ][ x ].gid) > 0)
                                                                            dataObj[ aimID ][ cgiT ][ x ].cgiAction = "2";
                                                                    }
                                                                }
                                                            }
                                                            
                                                            $( this ).dialog( "close" );
                                                            
                                                            cgiRedraw(aimID);
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                        
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                            $('#' + aimID + '-securityLevel').val( dataObj[ aimID ][ cgiT ][ thisNo ].securityLevel );
                                                                                    
                                            var arr = dataObj[ aimID ][ cgiT ][ thisNo ].member.split(regSemicolon);
                                            
                                            for (var x in cgiHash)
                                            {
                                                if ( arr.indexOf( x ) != -1)
                                                    $('#' + aimID + '-member').append('<option value="' + x  + '">' + cgiHash[ x ] + '</option>');
                                                else 
                                                    $('#' + aimID + '-memberPool').append('<option value="' + x  + '">' + cgiHash[ x ] + '</option>');
                                            }
                                            
                                            
                                            break;
                                            
                                        // Firewall
                                        case 'rules':
                                            cgiGetID = 'rules';
                                            cgiPostID = 'rules';
                                            cgiT = 'guiRulesT';
                                            cgiTNum = 'guiRulesTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();                                                        
    
                                                        if (isPass) {
                                                            
                                                            switch( $('#' + aimID + '-enabled').is(':checked') )
                                                            {
                                                            case true:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].enabled = $('#' + aimID + '-enabled').val();
                                                                break;
                                                            case false:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].enabled = "0";
                                                                break;
                                                            }
                                                            $('#enabled-' + thisNo ).html( cgiRef[ cgiGetID ].enabled[ dataObj[ aimID ][ cgiT ][ thisNo ].enabled ] );
                                                            
                                                            if (!isNaN(parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].fromZone)))
                                                                $(tableBD + ' tr:eq(' + thisNo + ')').removeClass('fromZone' + dataObj[ aimID ][ cgiT ][ thisNo ].fromZone);
                                                            if (!isNaN(parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].toZone)))
                                                                $(tableBD + ' tr:eq(' + thisNo + ')').removeClass('toZone' + dataObj[ aimID ][ cgiT ][ thisNo ].toZone);
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].fromZone = ( $('#' + aimID + '-fromZone').val() == 'selectOption' )? "" : $('#' + aimID + '-fromZone').val();
                                                            $('#fromZone-' + thisNo ).html ( ($('#' + aimID + '-fromZone').val() == "selectOption" ) ? "" : $('#' + aimID + '-fromZone option:selected').text() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].toZone = ( $('#' + aimID + '-toZone').val() == 'selectOption' )? "" : $('#' + aimID + '-toZone').val();
                                                            $('#toZone-' + thisNo ).html ( ($('#' + aimID + '-toZone').val() == "selectOption" ) ? "" : $('#' + aimID + '-toZone option:selected').text() ) ;
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].sourceAddress = ( $('#' + aimID + '-sourceAddress').val() == 'selectOption' )? "ANY" : $('#' + aimID + '-sourceAddress').val();
                                                            $('#sourceAddressUser-' + thisNo ).html ( ($('#' + aimID + '-sourceAddress').val() == "selectOption" ) ? "" : $('#' + aimID + '-sourceAddress option:selected').text() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].sourceUser ="";
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].destinationAddress = ( $('#' + aimID + '-destinationAddress').val() == 'selectOption' )? "" : $('#' + aimID + '-destinationAddress').val();
                                                            $('#destinationAddressUser-' + thisNo ).html ( ($('#' + aimID + '-destinationAddress').val() == "selectOption" ) ? "ANY" : $('#' + aimID + '-destinationAddress option:selected').text() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].destinationUser = "";
                                                            
                                                            $('input[name=rules-services]').each( function() {
                                                                switch($(this).is(':checked'))
                                                                {
                                                                case true:
                                                                    switch( parseInt($(this).val()) )
                                                                    {
                                                                    case 2:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].service = "";
                                                                        
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].application ="";
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].url ="";
                                                                        $('#serviceApplicationUrl-' + thisNo ).html();
                                                                        break;
                                                                    case 3:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].service = "";
                                                                        
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].application ="";
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].url ="";
                                                                         $('#serviceApplicationUrl-' + thisNo ).html();
                                                                        break;
                                                                    default:
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].service = ( $('#' + aimID + '-service').val() == 'selectOption' )? "" : $('#' + aimID + '-service').val();
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].application ="";
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ].url ="";
                                                                        
                                                                        $('#serviceApplicationUrl-' + thisNo ).html ( ($('#' + aimID + '-service').val() == 'selectOption')? "Any" : ('#' + aimID + '-service option:selected').text() );
                                                                    }
                                                                    break;
                                                                }
                                                            });
    
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].schedule = ( $('#' + aimID + '-schedule').val() == 'selectOption' )? "" : $('#' + aimID + '-schedule').val();
                                                            $('#schedule-' + thisNo ).html( ($('#' + aimID + '-schedule').val() == "selectOption" ) ? "" : $('#' + aimID + '-schedule option:selected').text() ) ;
                                                            
                                                            
                                                            switch( $('#' + aimID + '-log').is(':checked') )
                                                            {
                                                            case true:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].log = "1";
                                                                break;
                                                            case false:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].log = "0";
                                                                break;
                                                            }
                                                            
                                                            $('#log-' + thisNo ).html( cgiRef[ cgiGetID ].log[ dataObj[ aimID ][ cgiT ][ thisNo ].log ] );
    
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].matchAction = $('#' + aimID + '-matchAction').val();
                                                            $('#matchAction-' + thisNo ).html( $('#' + aimID + '-matchAction option:selected').text() );
    
                                                            if (parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].gid) > 0)
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2";
                                                                
                                                            if (!isNaN(parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].fromZone)))
                                                                $(tableBD + ' tr:eq(' + thisNo + ')').addClass('fromZone' + dataObj[ aimID ][ cgiT ][ thisNo ].fromZone);
                                                            if (!isNaN(parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].toZone)))
                                                                $(tableBD + ' tr:eq(' + thisNo + ')').addClass('toZone' + dataObj[ aimID ][ cgiT ][ thisNo ].toZone);
                                                            
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].service ) > 0) 
                                                $('#' + aimID + '-services-1').attr("checked", true).trigger('click');
                                                
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].enabled ) == 1)
                                                $('#' + aimID + '-enabled').attr('checked', true);
                                                
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].log ) == 1)
                                                $('#' + aimID + '-log').attr('checked', true);
                                            
                                            cgiComboSelectOption( aimID + '-fromZone', dataObj[ aimID ][ cgiT ][ thisNo ].fromZone);
                                            cgiComboSelectOption( aimID + '-toZone', dataObj[ aimID ][ cgiT ][ thisNo ].toZone);
                                            cgiComboSelectOption( aimID + '-service', dataObj[ aimID ][ cgiT ][ thisNo ].service);
                                            cgiComboSelectOption( aimID + '-sourceAddress', dataObj[ aimID ][ cgiT ][ thisNo ].sourceAddress);
                                            cgiComboSelectOption( aimID + '-destinationAddress', dataObj[ aimID ][ cgiT ][ thisNo ].destinationAddress);
                                            cgiComboSelectOption( aimID + '-schedule', dataObj[ aimID ][ cgiT ][ thisNo ].schedule);
                                            $('#' + aimID + '-matchAction').append( genSelectOption( aimID + '-matchAction' ) ).val( dataObj[ aimID ][ cgiT ][ thisNo ].matchAction ).trigger('change');
                                            break;
                                        case 'advanced_nat':
                                            cgiGetID = 'advancedNat';
                                            cgiPostID = 'advancedNat';
                                            cgiT = 'guiAdvancedNatT';
                                            cgiTNum = 'guiAdvancedNatTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        isValid = false;
                                                        $('.errorLabel').remove();
                                                                                                             
                                                        switch($('#' + aimID + '-originalSrc').val() != 'selectOption')
                                                        {
                                                        case true:
                                                            switch($('#' + aimID + '-translatedSrc').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                isValid = true;
                                                                break;
                                                            case false:
                                                                $('#' + aimID + '-translatedSrc').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedSrc"><span class="error">translated source address required</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-translatedSrc').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        case false:
                                                            switch($('#' + aimID + '-translatedSrc').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-originalSrc').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalSrc"><span class="error">origianl source address required</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-originalSrc').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        }
                                                        
                                                        switch($('#' + aimID + '-originalDst').val() != 'selectOption')
                                                        {
                                                        case true:
                                                            switch($('#' + aimID + '-translatedDst').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                isValid = true;
                                                                break;
                                                            case false:
                                                                $('#' + aimID + '-translatedDst').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedDst"><span class="error">translated destination address required</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-translatedDst').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        case false:
                                                            switch($('#' + aimID + '-translatedDst').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-originalDst').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalDst"><span class="error">original destination address required</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-originalDst').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        }
                                                        
                                                        
                                                        switch($('#' + aimID + '-originalService').val() != 'selectOption')
                                                        {
                                                        case true:
                                                            switch($('#' + aimID + '-translatedService').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                switch($('#' + aimID + '-originalDst').val() != 'selectOption')
                                                                {
                                                                case true:
                                                                    switch($('#' + aimID + '-translatedDst').val() != 'selectOption')
                                                                    {
                                                                    case true:
                                                                        switch( cgiTypes[ $('#' + aimID + '-originalService').val() ] == cgiTypes[ $('#' + aimID + '-translatedService').val() ] )
                                                                        {
                                                                        case false:
                                                                            $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">type match fail</span></label>')
                                                                            if (isPass)
                                                                                $('#' + aimID + '-translatedService').focus();
                                                                            isPass = false;
                                                                            break;
                                                                        }

                                                                        break;
                                                                    case false:
                                                                        $('#' + aimID + '-translatedDst').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedDst"><span class="error">translated destination address required</span></label>')
                                                                        if (isPass)
                                                                            $('#' + aimID + '-translatedDst').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    }
                                                                    break;
                                                                case false:
                                                                    switch($('#' + aimID + '-translatedDst').val() != 'selectOption')
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-originalDst').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalDst"><span class="error">original destination address required</span></label>')
                                                                        if (isPass)
                                                                            $('#' + aimID + '-originalDst').focus();
                                                                        isPass = false;
                                                                        break;
                                                                    }
                                                                    break;
                                                                }
                                                                break;
                                                            case false:
                                                                $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">type match fail</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-translatedService').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        case false:
                                                            switch($('#' + aimID + '-translatedService').val() != 'selectOption')
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">type match fail</span></label>')
                                                                if (isPass)
                                                                    $('#' + aimID + '-translatedService').focus();
                                                                isPass = false;
                                                                break;
                                                            }
                                                            break;
                                                        }

                                                        if (isPass) {
                                                            if (isValid) {
                                                                switch( $('#' + aimID + '-enabled').is(':checked') )
                                                                {
                                                                case true:
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].enabled = $('#' + aimID + '-enabled').val();
                                                                    break;
                                                                case false:
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].enabled = 0;
                                                                    break;
                                                                }
                                                                
                                                                $('#enabled-' + thisNo).html( cgiRef[ cgiGetID ].enabled[ dataObj[ aimID ][ cgiT ][ thisNo ].enabled ] );
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].fromIf = $('#' + aimID + '-fromIf').val();
                                                                $('#fromIf-' + thisNo).html( (($('#' + aimID + '-fromIf').val() == "selectOption" ) ? "" : $('#' + aimID + '-fromIf option:selected').text()) );
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].toIf = $('#' + aimID + '-toIf').val();
                                                                $('#toIf-' + thisNo ).html( (($('#' + aimID + '-toIf').val() == "selectOption" ) ? "" : $('#' + aimID + '-toIf option:selected').text()) );
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].originalSrc = $('#' + aimID + '-originalSrc').val();
                                                                $('#originalSrc-' + thisNo).html( (($('#' + aimID + '-originalSrc').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalSrc option:selected').text()) );
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].originalDst = $('#' + aimID + '-originalDst').val();
                                                                $('#originalDst-' + thisNo ).html( (($('#' + aimID + '-originalDst').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalDst option:selected').text()) );
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].originalService = $('#' + aimID + '-originalService').val();
                                                                $('#originalService-' + thisNo ).html( (($('#' + aimID + '-originalService').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalService option:selected').text()) );
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].translatedSrc = $('#' + aimID + '-translatedSrc').val();
                                                                $('#translatedSrc-' + thisNo ).html( (($('#' + aimID + '-translatedSrc').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedSrc option:selected').text()) );
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].translatedDst = $('#' + aimID + '-translatedDst').val();
                                                                $('#translatedDst-' + thisNo ).html( (($('#' + aimID + '-translatedDst').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedDst option:selected').text()) );
                                                                
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].translatedService = $('#' + aimID + '-translatedService').val();
                                                                $('#translatedService-' + thisNo ).html( (($('#' + aimID + '-translatedService').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedService option:selected').text()) );
    
                                                                if (parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].gid) > 0)
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2";
    
                                                                $( this ).dialog( "close" );
                                                            }else {
                                                                $('#' + aimID + '-originalSrc').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalSrc"><span class="error">original source address required</span></label>')
                                                                $('#' + aimID + '-originalSrc').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            switch( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].enabled ) )
                                            {
                                            case 1:
                                                $('#' + aimID + '-enabled').attr('checked', true);
                                                break;
                                            }
                                            
                                            cgiComboSelectOption( aimID + '-fromIf', dataObj[ aimID ][ cgiT ][ thisNo ].fromIf);
                                            cgiComboSelectOption( aimID + '-toIf', dataObj[ aimID ][ cgiT ][ thisNo ].toIf);
                                            cgiComboSelectOption( aimID + '-originalSrc', dataObj[ aimID ][ cgiT ][ thisNo ].originalSrc);
                                            cgiComboSelectOption( aimID + '-originalDst', dataObj[ aimID ][ cgiT ][ thisNo ].originalDst);
                                            cgiComboSelectOption( aimID + '-originalService',dataObj[ aimID ][ cgiT ][ thisNo ].originalService);
                                            cgiComboSelectOption( aimID + '-translatedSrc', dataObj[ aimID ][ cgiT ][ thisNo ].translatedSrc);
                                            cgiComboSelectOption( aimID + '-translatedDst', dataObj[ aimID ][ cgiT ][ thisNo ].translatedDst);
                                            cgiComboSelectOption( aimID + '-translatedService', dataObj[ aimID ][ cgiT ][ thisNo ].translatedService);
                                            
                                            break;
                                            
                                        case 'port_forwarding':
                                            cgiGetID = 'portForwarding';
                                            cgiPostID = 'portForwarding';
                                            cgiT = 'guiPortForwardingT';
                                            cgiTNum = 'guiPortForwardingTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if ($('#' + aimID + '-originalService').val() == 'selectOption') {
                                                            $('#' + aimID + '-originalService').parents('td').append('<label class="errorLabel" for="' + aimID + '-originalService"><span class="error">service required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-originalService').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if ($('#' + aimID + '-translatedService').val() == 'selectOption') {
                                                            $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">service required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-translatedService').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if (isPass) {
                                                            if ( cgiTypes[ $('#' + aimID + '-originalService').val() ] != cgiTypes[ $('#' + aimID + '-translatedService').val() ] ) {
                                                                $('#' + aimID + '-translatedService').parents('td').append('<label class="errorLabel" for="' + aimID + '-translatedService"><span class="error">type match fail</span></label>')
                                                                if (isPass)
                                                                        $('#' + aimID + '-translatedService').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        
                                                        if ($('#' + aimID + '-privateIp').val() == 'selectOption') {
                                                            $('#' + aimID + '-privateIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-privateIp"><span class="error">private IP required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-privateIp').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if ($('#' + aimID + '-wan').val() != '0' && $('#' + aimID + '-wanIpId').val() == 'selectOption' ) {
                                                            $('#' + aimID + '-wanIpId').parents('td').append('<label class="errorLabel" for="' + aimID + '-wanIpId"><span class="error">WAN IP required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-wanIpId').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if (isPass) {
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].description = ($('#' + aimID + '-description').val().length > 0)? $('#' + aimID + '-description').val() : "";
                                                            $('#description-' + thisNo).html( dataObj[ aimID ][ cgiT ][ thisNo ].description );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].originalService = $('#' + aimID + '-originalService').val();
                                                            $('#originalService-' + thisNo ).html( (($('#' + aimID + '-originalService').val() == "selectOption" ) ? "" : $('#' + aimID + '-originalService option:selected').text()) );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].translatedService = $('#' + aimID + '-translatedService').val();
                                                            $('#translatedService-' + thisNo ).html( (($('#' + aimID + '-toIf').val() == "selectOption" ) ? "" : $('#' + aimID + '-translatedService option:selected').text()) );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].privateIp = $('#' + aimID + '-privateIp').val();
                                                            $('#privateIp-' + thisNo ).html( (($('#' + aimID + '-privateIp').val() == "selectOption" ) ? "" : $('#' + aimID + '-privateIp option:selected').text()) );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].wan = $('#' + aimID + '-wan').val();
                                                            $('#wan-' + thisNo ).html( (($('#' + aimID + '-wan').val() == "selectOption" ) ? "" : $('#' + aimID + '-wan option:selected').text()) );
                                                            
                                                            switch(parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].wan ))
                                                            {
                                                            case 0:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].wanIpId = "";
                                                                $('#wanIpId-' + thisNo).html("");
                                                                break;
                                                            default:
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].wanIpId = $('#' + aimID + '-wanIpId').val();
                                                                $('#wanIpId-' + thisNo ).html( (($('#' + aimID + '-wanIpId').val() == "selectOption" ) ? "" : $('#' + aimID + '-wanIpId option:selected').text()) );
                                                            }
                                                            

                                                            if (parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].gid) > 0)
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2";
                                                         
                                                            $( this ).dialog( "close" );
                                                        }
                                                        
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].wan ) == 0)
                                                $('#' + aimID + '-wan').append( genSelectOption( aimID + '-wan' ) ).val( dataObj[ aimID ][ cgiT ][ thisNo ].wan ).trigger('change');
                                            else 
                                                $('#' + aimID + '-wan').append( genSelectOption( aimID + '-wan' ) ).val( dataObj[ aimID ][ cgiT ][ thisNo ].wan );
                                            $('#' + aimID + '-description').val( $('#description-' + thisNo).html() );
                                            console.log('wanIpId ' +    dataObj[ aimID ][ cgiT ][ thisNo ].wanIpId);
                                            cgiComboSelectOption( aimID + '-privateIp',dataObj[ aimID ][ cgiT ][ thisNo ].privateIp);
                                            cgiComboSelectOption( aimID + '-wanIpId', dataObj[ aimID ][ cgiT ][ thisNo ].wanIpId);
                                            cgiComboSelectOption( aimID + '-originalService', dataObj[ aimID ][ cgiT ][ thisNo ].originalService);
                                            cgiComboSelectOption( aimID + '-translatedService',    dataObj[ aimID ][ cgiT ][ thisNo ].translatedService);

                                            break;
                                        case 'static_nat':
                                            cgiGetID = 'staticNat';
                                            cgiPostID = 'staticNat';
                                            cgiT = 'guiStaticNatT';
                                            cgiTNum = 'guiStaticNatTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if ($('#' + aimID + '-publicIp').val() == 'selectOption') {
                                                            $('#' + aimID + '-publicIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-publicIp"><span class="error">IP required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-publicIp').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                        
                                                        if ($('#' + aimID + '-privateIp').val() == 'selectOption') {
                                                            $('#' + aimID + '-privateIp').parents('td').append('<label class="errorLabel" for="' + aimID + '-privateIp"><span class="error">IP required</span></label>')
                                                            if (isPass)
                                                                    $('#' + aimID + '-privateIp').focus();
                                                            isPass = false;
                                                            
                                                        }
                                                     
                                                        
                                                        if (isPass) {
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].wanInterface = $('#' + aimID + '-wanInterface').val();
                                                            $('#wanInterface-' + thisNo ).html( dataObj[ aimID ][ cgiT ][ thisNo ].wanInterface );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].publicIp = $('#' + aimID + '-publicIp').val();
                                                            $('#publicIp-' + thisNo ).html( $('#' + aimID + '-publicIp option:selected').text() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].privateIp = $('#' + aimID + '-privateIp').val();
                                                            $('#privateIp-' + thisNo ).html( $('#' + aimID + '-privateIp option:selected').text() );

                                                            if (parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].gid) > 0)
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2";
                                                         
                                                            $( this ).dialog( "close" );
                                                        }
                                                        
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            $('#' + aimID + '-wanInterface').append( genSelectOption( aimID + '-wanInterface' ) ).val( dataObj[ aimID ][ cgiT ][ thisNo ].wanInterface ).trigger('change');
                                            cgiComboSelectOption( aimID + '-privateIp', dataObj[ aimID ][ cgiT ][ thisNo ].privateIp);
                                            cgiComboSelectOption( aimID + '-publicIp', dataObj[ aimID ][ cgiT ][ thisNo ].publicIp);
                                            break;
                                        case 'wan_address_settings':
                                            cgiGetID = 'dynamicPat';
                                            cgiPostID = 'dynamicPat';
                                            cgiT = 'guiWanAddressSettingT';
                                            cgiTNum = 'guiWanAddressSettingTNum';
                                            $('.dialogForm').dialog({
                                                width: 680,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    OK: function() {
                                                        dataObj.dynamic_pat[ cgiT ][ thisNo ].mode = $('input[name=dynamic_pat-mode]:checked').val();
                                                        $('#mode-' + thisNo).html( cgiRef[ cgiGetID ].mode[ dataObj.dynamic_pat[ cgiT ][ thisNo ].mode ] );
                                                        
                                                        $('input[name=dynamic_pat-mode]').each(function() {
                                                            switch($(this).is(':checked'))
                                                            {
                                                            case true:
                                                                dataObj.dynamic_pat[ cgiT ][ thisNo ].mode = $(this).val();
                                                                switch(parseInt($(this).val()))
                                                                {
                                                                case 0:
                                                                    dataObj.dynamic_pat[ cgiT ][ thisNo ].addressId = "";
                                                                    $('#addressId-' + thisNo).html( "" );
                                                                    break;
                                                                case 1:
                                                                    dataObj.dynamic_pat[ cgiT ][ thisNo ].addressId = $('#dynamic_pat-addressId').val();
                                                                    $('#addressId-' + thisNo).html( $('#dynamic_pat-addressId option:selected').text() );
                                                                    break; 
                                                                }
                                                                break;
                                                            }
                                                        });
                                                        dataObj.dynamic_pat[ cgiT ][ thisNo ].cgiAction = "2";                                                 
                                                        $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            $('#dynamic_pat-wanName').html( dataObj.dynamic_pat[ cgiT ][ thisNo ].wanName );                                            
                                            
                                            cgiComboSelectOption( 'dynamic_pat-addressId', dataObj.dynamic_pat[ cgiT ][ thisNo ].addressId);
                                            
                                            $('#dynamic_pat-mode-' + dataObj.dynamic_pat[ cgiT ][ thisNo ].mode ).attr('checked', true).trigger('click');
                                            $('#wanInterfaces').html(thisTr.find('td:eq(0)').html()); 
                                            break;
                                        case 'ipsec_policies':
                                            cgiGetID = 's2svpn';
                                            cgiPostID = 's2svpn';
                                            cgiT = 'guiS2svpnT';
                                            cgiTNum = 'guiS2svpnTNum';
                                            
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        calcObj = {};
                                                        if ($('#' + aimID + '-name').val().length == 0) {
                                                            isPass = false;
                                                            $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">description required</span></label>');
                                                            $('#' + aimID + '-name').focus();
                                                        }
                                                        
                                                        switch(parseInt( $('#' + aimID + '-remoteGwType').val() ))
                                                        {
                                                        case 1:
                                                        
                                                            if (regIpv4.test($('#' + aimID + '-remoteGw').val())) {
                                                                calcObj.arr = $('#' + aimID + '-remoteGw').val().split(regDot);
                                                                for (var i=0, ilen=calcObj.arr.length; i<ilen; i++)
                                                                {
                                                                    switch (isNaN(calcObj.arr[i]) || calcObj.arr[i] > 255 || calcObj.arr[i] < 0) 
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-remoteGw').parents('td').append('<label class="errorLabel" for="' + aimID + '-remoteGw"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-remoteGw').focus();
                                                                        isPass = false;
                                                                        break;
    
                                                                    }
                                                                }
                                                            }else {
                                                                $('#' + aimID + '-remoteGw').parents('td').append('<label class="errorLabel" for="' + aimID + '-remoteGw"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-remoteGw').focus();
                                                                isPass = false; 
                                                            }
                                                            break;
                                                        case 2:
                                                            if (!regDomain.test($('#' + aimID + '-remoteGw').val())){
                                                                $('#' + aimID + '-remoteGw').parents('td').append('<label class="errorLabel" for="' + aimID + '-remoteGw"><span class="error">domain error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-remoteGw').focus();
                                                                isPass = false; 
                                                            
                                                            }
                                                            break;
                                                        }
                                                        
                                                        if ($('#' + aimID + '-presharedkey').val().length == 0 || $('#' + aimID + '-presharedkey').val().length > 256) {
                                                            $('#' + aimID + '-presharedkey').parents('td').append('<label class="errorLabel" for="' + aimID + '-presharedkey"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-presharedkey').focus();
                                                                isPass = false; 
                                                        }
                                                        
                                                        if ($('#' + aimID + '-dpdEnable').is(':checked')) {
                                                            if (isNaN(parseInt($('#' + aimID + '-dpddelay').val())) || parseInt($('#' + aimID + '-dpddelay').val()) < 10 || parseInt($('#' + aimID + '-dpddelay').val()) > 300) {
                                                                $('#' + aimID + '-dpddelay').parents('td').append('<label class="errorLabel" for="' + aimID + '-dpddelay"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dpddelay').focus();
                                                                isPass = false;
                                                            }
                                                            
                                                            if (isNaN(parseInt($('#' + aimID + '-dpdtimeout').val())) || parseInt($('#' + aimID + '-dpdtimeout').val()) < 30 || parseInt($('#' + aimID + '-dpdtimeout').val()) > 1800) {
                                                                $('#' + aimID + '-dpdtimeout').parents('td').append('<label class="errorLabel" for="' + aimID + '-dpdtimeout"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-dpdtimeout').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        
                                                        if ($('#' + aimID + '-backupPolicyEnable').is(':checked')) {
                                                            if (isNaN(parseInt($('#' + aimID + '-fallbackTime').val())) || parseInt($('#' + aimID + '-fallbackTime').val()) < 3 || parseInt($('#' + aimID + '-fallbackTime').val()) > 59) {
                                                                $('#' + aimID + '-fallbackTime').parents('td').append('<label class="errorLabel" for="' + aimID + '-fallbackTime"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-fallbackTime').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        
                                                        if (isPass) {
                                                            
                                                            for (var node in dataObj[ aimID ].guiS2svpnT[ thisNo ])
                                                            {
                                                                switch(node)
                                                                {
                                                                case 'name':
                                                                    if ( cgiRef[ cgiGetID ].free.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ) != -1 )
                                                                        cgiRef[ cgiGetID ].free.splice( cgiRef[ cgiGetID ].free.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ), 1);
                                                                    
                                                                    cgiRef[ cgiGetID ].free.push( $('#' + aimID + '-' + node).val() );
                                                                        
                                                                    if (cgiRef[ cgiGetID ].freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ) != -1) {
                                                                        cgiRef[ cgiGetID ].freez.splice( cgiRef[ cgiGetID ].freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ), 1);
                                                                        cgiRef[ cgiGetID ].freez.push( $('#' + aimID + '-' + node).val() );
                                                                        
                                                                        // update who has this backup
                                                                        for (var i=0, len=parseInt(dataObj[ aimID ][ cgiTNum ]); i<len; i++) {
                                                                            if ( parseInt(dataObj[ aimID ][ cgiT ][ i ].cgiAction) != 3 ) {
                                                                                if ( dataObj[ aimID ][ cgiT ][ i ].backupPolicyName == dataObj[ aimID ][ cgiT ][ thisNo ][ node ] )
                                                                                    dataObj[ aimID ][ cgiT ][ i ].backupPolicyName = $('#' + aimID + '-' + node).val();
                                                                            }
                                                                        }
                                                                    }
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                case 'gid':
                                                                case 'vpnaclTNum':
                                                                case 'infoStatus':
                                                                    break;
                                                                case 'type':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "0";
                                                                    break;    
                                                                case 'vpnaclT':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = [];
                                                                    for (var i=0, len=parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].vpnaclTNum); i<len; i++)
                                                                    {
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ].push({"zoneName": $('#access_control-zoneName-' + i).html(), "actionType": $('#access_control-actionType-' + i).val()});
                                                                    }
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].vpnaclTNum = dataObj[ aimID ][ cgiT ][ thisNo ][ node ].length;
                                                                    break;
                                                                
                                                                case 'phase1AuthType':
                                                                    $('input[name=phase1AuthType]').each(function() {
                                                                        if ($(this).is(':checked')) {
                                                                            dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $(this).val();
                                                                        }
                                                                    });
                                                                    break;   
                                                                case 'wanId':
                                                                case 'localNetworkId':
                                                                case 'remoteNetworkId':
                                                                case 'ikePolicyId':
                                                                case 'transformPolicyId':
                                                                    
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    if ($('#' + aimID + '-' + node).val() != 'selectOption')
                                                                        $('#' + node + '-' + thisNo).html( $('#' + aimID + '-' + node + ' option:selected').text() );
                                                                    else 
                                                                        $('#' + node + '-' + thisNo).html( "" );
                                                                    break;
                                                                case 'enable':
                                                                    if ($('#' + aimID + '-' + node ).is(':checked'))
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "1";
                                                                    else
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "0";
                                                                    $('#' + node + '-' + thisNo).html( cgiRef.s2svpn.enable[ dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ] );
                                                                    break;
                                                                case 'pfsEnable':
                                                                case 'dpdEnable':
                                                                case 'wanFailoverEnable':
                                                                case 'backupPolicyEnable':
                                                                    if ($('#' + aimID + '-' + node ).is(':checked'))
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "1";
                                                                    else
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "0";

                                                                    break;
                                                                case 'backupPolicyName':
                                                                    if (cgiRef[ cgiGetID ].freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ) != -1)
                                                                        cgiRef[ cgiGetID ].freez.splice( cgiRef[ cgiGetID ].freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ), 1);

                                                                    if ($('#' + aimID + '-node').val() != 'selectOption') {
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-node').val();
                                                                        
                                                                        cgiRef[ cgiGetID ].freez.push( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] );
                                                                    }else {
                                                                        dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = "";
                                                                    }
                                               
                                                                    break;
                                                                case 'fallbackTime':
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                    break;
                                                                default:
                                                                    $('#' + node + '-' + thisNo).html( $('#' + aimID + '-' + node).val() );
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ][ node ] = $('#' + aimID + '-' + node).val();
                                                                }
                                                            }
                                                            if (parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].gid) > 0)
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2";
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('.tabs').tabs();
                                            
                                            
                                            
                                            for (var node in dataObj[ aimID ][ cgiT ][ thisNo ])
                                            {
                                                switch(node)
                                                {
                                                case 'enable':
                                                case 'pfsEnable':
                                                case 'dpdEnable':
                                                case 'wanFailoverEnable':
                                                case 'backupPolicyEnable':
                                                    switch( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ) )
                                                    {
                                                    case 1:
                                                        $('#' + aimID + '-' + node).attr('checked', true);
                                                        $('.' + aimID + '-' + node + '-checked').prop('disabled', false);
                                                        break;
                                                    default:
                                                        $('#' + aimID + '-' + node).attr('checked', false);
                                                        $('.' + aimID + '-' + node + '-checked').prop('disabled', true);
                                                    }
                                                    break;
                                                case 'phase1AuthType':
                                                    $('input[name=phase1AuthType]').each(function() {
                                                        switch($(this).val() == dataObj[ aimID ][ cgiT ][ thisNo ][ node ])
                                                        {
                                                        case true:
                                                            $(this).attr('checked', true).trigger('click');
                                                            break;
                                                        }
                                                    });
                                                    break;
                                                case 'remoteGwType':
                                                case 'dpdaction':
                                                    $('#' + aimID + '-' + node).append( genSelectOption( aimID + '-' + node) ).val( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] ).trigger('change');
                                                    break;
                                                case 'backupPolicyName':
                                                    tmp ='<option value="selectOption">Select Backup Policy</option>';
                                                    for (var x in cgiRef[ cgiGetID ].free) {
                                                        if ( cgiRef[ cgiGetID ].free[ x ] != dataObj[ aimID ][ cgiT ][ thisNo ].name ) {
                                                            if ( cgiRef[ cgiGetID ].free[ x ] == dataObj[ aimID ][ cgiT ][ thisNo ][ node ])
                                                                tmp += '<option selected value="' + cgiRef[ cgiGetID ].free[ x ] + '">' + cgiRef[ cgiGetID ].free[ x ] + '</option>';
                                                            else {
                                                                if ( cgiRef[ cgiGetID ].freez.indexOf( cgiRef[ cgiGetID ].free[ x ] ) == -1 ) {
                                                                    tmp += '<option value="' + cgiRef[ cgiGetID ].free[ x ] + '">' + cgiRef[ cgiGetID ].free[ x ] + '</option>';
                                                                }
                                                            }
                                                        }
                                                    }
                                                    
                                                    $('#' + aimID + '-' + node).append(tmp);

                                                    break; 
                                                
                                                case 'localNetworkId':
                                                case 'remoteNetworkId':
                                                    cgiComboSelectOption( aimID + '-' + node, aimID, thisNo);
                                                    break;
                                                case 'wanId':
                                                case 'ikePolicyId':
                                                case 'transformPolicyId':
                                                    cgiSelectOption( aimID + '-' + node, aimID, thisNo);
                                                    break;
                                                case 'vpnaclTNum':
                                                case 'vpnaclT':
                                                
                                                    break;
                                                default:
                                                    $('#' + aimID + '-' + node).val( dataObj[ aimID ][ cgiT ][ thisNo ][ node ] );
                                                }
                                            }
                                            
                                            genAccessControl('access_control', dataObj[ aimID ][ cgiT ][ thisNo ]);

                                            break;
                                        case 'transform_policy':
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        for (var node in dataObj[ aimID ].guiIpsectransformT[ thisNo ]) 
                                                        {
                                                            dataObj[ aimID ].guiIpsectransformT[ thisNo ][ node ] = $('#form-' + node).val();
                                                            switch(node)
                                                            {
                                                            case 'cipher':
                                                            case 'hash':
                                                            case 'pfsgroup':
                                                                $('#' + node + '-' + thisNo).html( cgiRef.ipsectransform[ node ][ $('#form-' + node).val() ] );                                                            
                                                                break;
                                                            default :
                                                                $('#' + node + '-' + thisNo).html( $('#form-' + node).val() );
                                                            }     
                                                        }
                                                        dataObj[ aimID ].guiIpsectransformT[ thisNo ].cgiAction = "2";
                                                        if (isPass)
                                                            $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            for (var node in dataObj[ aimID ].guiIpsectransformT[ thisNo ]) 
                                                $('#form-' + node).val( dataObj[ aimID ].guiIpsectransformT[ thisNo ][ node ] );
                                            break;
                                        case 'ike_policy':
                                            $('.dialogForm').dialog({
                                                width: 800,
                                                height:680,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        for (var node in dataObj[ aimID ].guiIpsecikeT[ thisNo ]) 
                                                        {
                                                            dataObj[ aimID ].guiIpsecikeT[ thisNo ][ node ] = $('#form-' + node).val();
                                                            switch(node)
                                                            {
                                                            case 'cipher':
                                                            case 'hash':
                                                            case 'dhgroup':
                                                                $('#' + node + '-' + thisNo).html( cgiRef.ipsecike[ node ][ $('#form-' + node).val() ] );
                                                                break;
                                                            default :
                                                                $('#' + node + '-' + thisNo).html( $('#form-' + node).val() );
                                                                break;
                                                            }
                                                        }
                                                        dataObj[ aimID ].guiIpsecikeT[ thisNo ].cgiAction = "2";
                                                        if (isPass)
                                                            $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            for (var node in dataObj[ aimID ].guiIpsecikeT[ thisNo ]) 
                                                $('#form-' + node).val( dataObj[ aimID ].guiIpsecikeT[ thisNo ][ node ] );
                                            break;
                                        // antivirus
                                        case 'address_exceptions':
                                            cgiT = 'excepT';
                                            $('.dialogForm').dialog({
                                                width: 600,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if ( isNaN(parseInt($('#sourceAddress').val())) ) {
                                                            isPass = false;
                                                            $('#sourceAddress').parents('td').append('<label class="errorLabel" for="sourceAddress"><span class="error">source address required</span></label>');
                                                            $('#sourceAddress').focus();
                                                        }
                                                        
                                                        if ( isNaN(parseInt($('#destinationAddress').val())) ) {
                                                            
                                                            $('#destinationAddress').parents('td').append('<label class="errorLabel" for="destinationAddress"><span class="error">destination address required</span></label>');
                                                            if (isPass)
                                                                $('#destinationAddress').focus();
                                                            isPass = false; 
                                                        }
                                                        
                                                        if (isPass) {
                                                            for (var i=0, len=parseInt( cgiList.common_addr_list.guiAddrTNum ); i<len; i++) 
                                                            {
                                                                if (parseInt( cgiList.common_addr_list.guiAddrT[ i ].gid) == parseInt($('#sourceAddress').val())) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcAddrType = "0";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcAddrGid  = cgiList.common_addr_list.guiAddrT[ i ].gid;
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcGAddrGid = "0";
                                                                    $('#srcAddrType-' + thisNo ).html( cgiList.common_addr_list.guiAddrT[ i ].name );
                                                                }
                                                            }
                                                            
                                                            for (var i=0, len=parseInt( cgiList.common_gAddr_list.guiGAddrTNum ); i<len; i++) 
                                                            {
                                                                if (parseInt( cgiList.common_gAddr_list.guiGAddrT[ i ].gid) == parseInt($('#sourceAddress').val())) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcAddrType = "1";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcAddrGid  = "0";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].srcGAddrGid = cgiList.common_gAddr_list.guiGAddrT[ i ].gid;
                                                                    $('#srcAddrType-' + thisNo ).html( cgiList.common_gAddr_list.guiGAddrT[ i ].name );
                                                                }
                                                            }
                                                            
                                                            for (var i=0, len=parseInt( cgiList.common_addr_list.guiAddrTNum ); i<len; i++) 
                                                            {
                                                                if (parseInt( cgiList.common_addr_list.guiAddrT[ i ].gid) == parseInt($('#destinationAddress').val())) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstAddrType = "0";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstAddrGid  = cgiList.common_addr_list.guiAddrT[ i ].gid;
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstGAddrGid  ="0";
                                                                    $('#dstAddrType-' + thisNo ).html( cgiList.common_addr_list.guiAddrT[ i ].name );
                                                                }
                                                            }
                                                            
                                                            for (var i=0, len=parseInt( cgiList.common_gAddr_list.guiGAddrTNum ); i<len; i++) 
                                                            {
                                                                if (parseInt( cgiList.common_gAddr_list.guiGAddrT[ i ].gid) == parseInt($('#destinationAddress').val())) {
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstAddrType = "1";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstAddrGid  = "0";
                                                                    dataObj[ aimID ][ cgiT ][ thisNo ].dstGAddrGid = cgiList.common_gAddr_list.guiGAddrT[ i ].gid;
                                                                    $('#dstAddrType-' + thisNo ).html( cgiList.common_gAddr_list.guiGAddrT[ i ].name );
                                                                }
                                                            }
                                                            
                                                            if (parseInt(dataObj[ aimID ][ cgiT ][ thisNo ].entryId) > 0)
                                                                dataObj[ aimID ][cgiT ][ thisNo ].cgiAction = "2";
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].Log = ($('#addressLog').is(':checked') )? "1" : "0";
                                                            $('#Log-' + thisNo ).html( cgiRef.antivirus.Log[ dataObj[ aimID ][ cgiT ][ thisNo ].Log ] );
                                                            
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            
                                            switch(dataObj[ aimID ].excepT[ thisNo ].Log)
                                            {
                                            case "1":
                                                $('#addressLog').attr('checked', true);
                                                break;
                                            }
                                            cgiComboSelectOption(aimID, dataObj[ aimID ][ cgiT ][ thisNo ]);
                                            break;
                                        case 'mime':
                                            $('.dialogForm').dialog({
                                                width: 300,
                                                height:250,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        $('#mime-' + thisNo).val( $('#modMime').val() );
                                                        dataObj.file_extensions.mimeExcepT[ thisNo ].mime = $('#modMime').val();
                                                        if (isPass)
                                                            $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('#modMime').val( dataObj.file_extensions.mimeExcepT[ thisNo ].mime );
                                            break;
                                        case 'file_extension':
                                            $('.dialogForm').dialog({
                                                width: 300,
                                                height:250,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        $('#fileExt-' + thisNo).val( $('#modMime').val() );
                                                        dataObj.file_extensions.fileExcepT[ thisNo ].fileExt = $('#modFileExt').val();
                                            
                                                        if (isPass)
                                                            $( this ).dialog( "close" );
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('#modFileExt').val( dataObj.file_extensions.fileExcepT[ thisNo ].fileExt );
                                            break;
                                        case 'user':
                                            cgiT = 'userListT';
                                            $('.dialogForm').dialog({
                                                width: 600,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        isPass = true;
                                                        isValid = false;
                                                        $('.errorLabel').remove();
                                                        
                                                        if (($('#'+ aimID + '-name').val().length == 0)) {
                                                            isPass = false;
                                                            $('#'+ aimID + '-name').parents('td').append('<label class="errorLabel" for="'+ aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#'+ aimID + '-name').focus();
                                                        }
                                                        
                                                        if (($('#'+ aimID + '-password').val().length > 0) || $('#'+ aimID + '-confirm').val().length > 0) {
                                                            if ($('#'+ aimID + '-password').val() == $('#'+ aimID + '-password').val() ) {
                                                                isValid = true;
                                                            }else {
                                                                $('#'+ aimID + '-password').parents('td').append('<label class="errorLabel" for="'+ aimID + '-password"><span class="error">password required</span></label>');
                                                                if (isPass)
                                                                    $('#'+ aimID + '-password').focus();
                                                                isPass = false;
                                                            }
                                                        }
                                                        
                                                        if (isPass) {
                                                        
                                                            $('#userName-' + thisNo ).html( $('#' + aimID + '-name').val() );
                                                            $('#userGroup-' + thisNo ).html( $('#' + aimID + '-groupId option:selected').text() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                            if (isValid) {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].password = $('#' + aimID + '-password').val();
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiSetPwd = "1";
                                                            }else {
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].password = "";
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiSetPwd = "0";
                                                            }
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].groupId = $('#' + aimID + '-groupId').val();
                                                            
                                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid ) > 0)
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2";
                                                            
                                                            tmplTabs.tabs({"disabled": [1]});
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('.tabs').tabs();
                                            $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                            $('#' + aimID + '-groupId').append( genSelectOption( aimID + '-groupId') ).val( dataObj[ aimID ][ cgiT ][ thisNo ].groupId );
                                            break;
                                        case 'group':
                                            cgiT = 'groupListT';
                                            $('.dialogForm').dialog({
                                                width: 600,
                                                height:480,
                                                position: "center",
                                                resizable: false,
                                                modal: true,
                                                buttons: {
                                                    "OK": function() {
                                                        isPass = true;
                                                        $('.errorLabel').remove();
                                                        
                                                        if (($('#'+ aimID + '-name').val().length == 0)) {
                                                            isPass = false;
                                                            $('#'+ aimID + '-name').parents('td').append('<label class="errorLabel" for="'+ aimID + '-name"><span class="error">name required</span></label>');
                                                            $('#'+ aimID + '-name').focus();
                                                        }
                                                        
                                                        if (isPass) {
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].name = $('#' + aimID + '-name').val();
                                                            $('#groupName-' + thisNo ).html( $('#' + aimID + '-name').val() );
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].webLoginPriv = $('#' + aimID + '-webLoginPriv').val();
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].portalPriv = $('#' + aimID + '-portalPriv').val();
                                                            
                                                            $('#groupServices-' + thisNo ).html( + 'Web Login:' + cgiRef[ aimID ].webLoginPriv[ $('#' + aimID + '-webLoginPriv').val() ] + '; Captive Portal:' + cgiRef[ aimID ].portalPriv[ (($('#' + aimID + '-portalPriv').is(':checked'))? "1" : "0") ] );
                                                            
                                                            var users = [];
                                                            var usersName = [];
                                                            $('#selectedGroup option').each(function() {
                                                                usersName.push($(this).text());
                                                                users.push($(this).val());

                                                            });
                                                            
                                                            dataObj[ aimID ][ cgiT ][ thisNo ].cgiSetListId = users.join(';');
                                                            $('#groupMember-' + thisNo ).html( usersName.join(';') );
                                                            
                                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) > 0)
                                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "2"
                                                            
                                                            tmplTabs.tabs({"disabled": [1]});
                                                            $( this ).dialog( "close" );
                                                        }
                                                    },
                                                    Cancel: function() {
                                                        $( this ).dialog( "close" );
                                                    }
                                                },
                                                close: function(event, ui) {
                                                    $(this).dialog('destroy').remove();
                                                }
                                            });
                                            $('.tabs').tabs();
                                            $('#' + aimID + '-name').val( dataObj[ aimID ][ cgiT ][ thisNo ].name );
                                            $('#' + aimID + '-webLoginPriv').append( genSelectOption( aimID + '-webLoginPriv') );
                                            
                                            for (var x in dataObj.user.userListT)
                                            {
                                                if ( dataObj.user.userListT[ x ].groupId  == dataObj[ aimID ][ cgiT ][ thisNo ].gid )
                                                    $('#selectedGroup').append('<option value="' + dataObj.user.userListT[ x ].gid + '">' + dataObj.user.userListT[ x ].name + '</option>');
                                                else
                                                    $('#selectedGroupPool').append('<option value="' + dataObj.user.userListT[ x ].gid + '">' + dataObj.user.userListT[ x ].name + '</option>');
                                            }
                                            if ( thisNo == 0)
                                                $('#' + aimID + '-name').prop('disabled', true);
                                            break;

                                        }
                                            
                                    });
                                }
                                break;
                            case 'Add':
                                $('#extra').empty();
                                $('#extra').load('forms/' + aimID + '.html .dialogForm', function() {
                                    $('#extra .dialogForm').dialog({
                                        width: 600,
                                        height: 480,
                                        position: "center",
                                        resizable: false,
                                        modal: true,
                                        buttons: {
                                            "OK": function() {
                                                $( this ).dialog( "close" );
                                            },
                                            Cancel: function() {
                                                $( this ).dialog( "close" );
                                            }
                                        },
                                        close: function(event, ui) {
                                            $(this).dialog('destroy').remove();
                                        }
                                    });
                                });
                                break;
                            case 'Mod':
                                $('#extra').empty();
                                $('#extra').load('forms/' + aimID + '.html .dialogForm', function() {
                                    $('#extra .dialogForm').dialog({
                                        width: 600,
                                        height: 480,
                                        position: "center",
                                        resizable: false,
                                        modal: true,
                                        buttons: {
                                            "OK": function() {
                                                $( this ).dialog( "close" );
                                            },
                                            Cancel: function() {
                                                $( this ).dialog( "close" );
                                            }
                                        },
                                        close: function(event, ui) {
                                            $(this).dialog('destroy').remove();
                                        }
                                    });
                                });
                                break;
                            case 'Delete':
                                var thisTr = $(this).parents('tr');
                                var thisNo = btID.replace(btClass + '-' + aimID + '-', '');
                                var cgiGetID;
                                var cgiPostID;
                                var cgiT;
                                var cgiTNum;
                                switch( aimID )
                                {
                                case 'ip_alias':
                                    cgiIpAlias.splice( thisNo, 1);
                                    
                                    break;
                                case 'schedule':
                                    cgiGetID = 'common_time_list';
                                    cgiPostID = 'common_updateTime';
                                    cgiT = 'guiTimeT';

                                    formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                    formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                    formObj.name = "";
                                    formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                    formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                    formObj.day = dataObj[ aimID ][ cgiT ][ thisNo ].day;
                                    formObj.startHour = dataObj[ aimID ][ cgiT ][ thisNo ].startHour;
                                    formObj.startMin = dataObj[ aimID ][ cgiT ][ thisNo ].startMin;
                                    formObj.endHour = dataObj[ aimID ][ cgiT ][ thisNo ].endHour;
                                    formObj.endMin = dataObj[ aimID ][ cgiT ][ thisNo ].endMin;
                                    formObj.action = "1";
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                        // remove data after callback
                                        
                                    });
                                    
                                    // temp do out side 
                                    dataObj[ aimID ][ cgiT ].splice( thisNo, 1);
                                    dataObj[ aimID ].guiTimeTNum--;
                                    
                                    break;
                                case 'address':
                                    cgiGetID = 'common_addr_list';
                                    cgiPostID = 'common_updateAddr';
                                    cgiT = 'guiAddrT';
                                    formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                    formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                    formObj.name = "";
                                    formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                    formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                    formObj.startIp = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                    formObj.endIp = dataObj[ aimID ][ cgiT ][ thisNo ].endIp;
                                    formObj.netmask = dataObj[ aimID ][ cgiT ][ thisNo ].netmask;
                                    formObj.mac = dataObj[ aimID ][ cgiT ][ thisNo ].mac;
                                    formObj.action = "1";
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                        // remove data after callback
                                        
                                    });
                                    
                                    // temp do out side 
                                    dataObj[ aimID ][ cgiT ].splice( thisNo, 1);
                                    dataObj[ aimID ].guiAddrTNum--;
                                    dataObj[ aimID ].guiMacTNum--;
                                    
                                    break;
                                case 'group_address':
                                    cgiGetID = 'common_gAddr_list';
                                    cgiPostID = 'common_updateGAddr';
                                    cgiT = 'guiGAddrT';
                                    formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                    formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                    formObj.name = "";
                                    formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                    formObj.num = dataObj[ aimID ][ cgiT ][ thisNo ].num;
                                    formObj.idList = dataObj[ aimID ][ cgiT ][ thisNo ].idList;
                                    formObj.action = "1";
                                    
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                        // remove data after callback
                                        
                                    });
                                    
                                    // temp do out side 
                                    dataObj[ aimID ][ cgiT ].splice( thisNo, 1);
                                    dataObj[ aimID ].guiGAddrTNum--;
                                    
                                    break;
                                case 'service':
                                    cgiGetID = 'common_service_list';
                                    cgiPostID = 'common_updateService';
                                    cgiT = 'guiServiceT';
                                    
                                    formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                    formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                    formObj.name = "";
                                    formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                    formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                    formObj.param1 = dataObj[ aimID ][ cgiT ][ thisNo ].param1;
                                    formObj.param2 = dataObj[ aimID ][ cgiT ][ thisNo ].param2;
                                    formObj.action = "1";
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                        // remove data after callback
                                        
                                    });
                                    
                                    // temp do out side 
                                    dataObj[ aimID ][ cgiT ].splice( thisNo, 1);
                                    dataObj[ aimID ].guiServiceTNum--;

                                    break;
                                case 'group_service':
                                    cgiGetID = 'common_gService_list';
                                    cgiPostID = 'common_updateGService';
                                    cgiT = 'guiGServiceT';

                                    formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                    formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                    formObj.name = "";
                                    formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                    formObj.num = dataObj[ aimID ][ cgiT ][ thisNo ].num;
                                    formObj.idList = dataObj[ aimID ][ cgiT ][ thisNo ].idList;
                                    formObj.action = "1";
                                    
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                        // remove data after callback
                                        
                                    });
                                    
                                    // temp do out side 
                                    dataObj[ aimID ][ cgiT ].splice( thisNo, 1);
                                    dataObj[ aimID ].guiGServiceTNum--;

                                    break;
                                case 'wan':
                                    cgiT = 'wanIpIfT';
                                    cgiRef[ aimID ].free[ dataObj[ aimID ][ cgiT ][ thisNo ].name ] = true;
                                    cgiRef[ aimID ].wan.splice( cgiRef[ aimID ].wan.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ), 1);
                                    $('#Create-wan').prop('disabled', false);
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiT ].splice( thisNo, 1);
                                        dataObj[ aimID ].ipAliasT.splice( thisNo, 1);
                                        dataObj[ aimID ].staticipT.splice( thisNo, 1);
                                        dataObj[ aimID ].dhcpcT.splice( thisNo, 1);
                                        dataObj[ aimID ].staticip6T.splice( thisNo, 1);
                                    }
                                    break;
                                case 'lan':
                                    cgiT = 'guiLanIfT';
                                    cgiTNum = 'guiLanIfTNum'
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                        dataObj[ aimID ].guiIpAliasTNum--;
                                        dataObj[ aimID ].guiIpAliasT.splice(thisNo,1);
                                        dataObj[ aimID ].guiDhcpsTNum--;
                                        dataObj[ aimID ].guiDhcpsT.splice(thisNo,1);
                                    }
                                    break;
                                case 'vlan_interfaces':
                                    cgiT = 'guiVlanIfT';
                                    cgiTNum = 'guiVlanIfTNum'
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                        dataObj[ aimID ].guiIpAliasTNum--;
                                        dataObj[ aimID ].guiIpAliasT.splice(thisNo,1);
                                        dataObj[ aimID ].guiDhcpsTNum--;
                                        dataObj[ aimID ].guiDhcpsT.splice(thisNo,1);
                                    }
                                    break;
                                case 'zone':
                                    cgiT = 'guiZoneIfT';
                                    cgiTNum = 'guiZoneIfTNum'
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    break;
                                case 'ipsec_policies':
                                    cgiT = 'guiS2svpnT';
                                    cgiTNum = 'guiS2svpnTNum';
                                    
                                    if ( cgiRef.s2svpn.free.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ) != -1 )
                                        cgiRef.s2svpn.free.splice( cgiRef.s2svpn.free.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ), 1);
                                    if ( cgiRef.s2svpn.freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ) != -1 )
                                        cgiRef.s2svpn.freez.splice( cgiRef.s2svpn.freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ), 1);
                                    if ( cgiRef.s2svpn.freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyName ) != -1 )
                                        cgiRef.s2svpn.freez.splice( cgiRef.s2svpn.free.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyName ), 1);

                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    
                                    break;
                                case 'ike_policy':
                                    cgiT = 'guiIpsecikeT';
                                    cgiTNum = 'guiIpsecikeTNum';
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    break;
                                case 'transform_policy':
                                    cgiT = 'guiIpsectransformT';
                                    cgiTNum = 'guiIpsectransformTNum';
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    
                                    break;
                                case 'rules':
                                    cgiT = 'guiRulesT';
                                    cgiTNum = 'guiRulesTNum';
                                    cgiRef[ aimID ].move.splice( cgiRef[ aimID ].move.indexOf( thisNo ), 1);
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    break;
                                case 'advanced_nat':
                                    cgiT = 'guiAdvancedNatT';
                                    cgiTNum = 'guiAdvancedNatTNum';
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    break;
                                case 'port_forwarding':
                                    cgiT = 'guiPortForwardingT';
                                    cgiTNum = 'guiPortForwardingTNum';
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    break;
                                case 'static_nat':
                                    cgiT = 'guiStaticNatT';
                                    cgiTNum = 'guiStaticNatTNum';
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 )
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    break;
                                case 'user':
                                    cgiT = 'userListT';

                                    if ( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid ) != 0) {  
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                        console.log( dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction );
                                    }else {
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    
                                    tmplTabs.tabs({"disabled": [0]});
                                    break;
                                case 'group':
                                    cgiT = 'groupListT';

                                    for (var i=0, len=dataObj.user.userListT.length; i<len; i++)
                                    {
                                        if (dataObj.user.userListT[ i ].groupId == dataObj[ aimID ].groupListT[ thisNo ].gid) 
                                            dataObj.user.userListT[ i ].groupId = cgiRef.group.defaultGroupGid;
                                    }

                                    if ( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0) 
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    else {
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    tmplTabs.tabs({"disabled": [1]});
                                    break;
                                case 'address_exceptions':
                                    cgiT = 'excepT';
                                    cgiTNum = 'excepNum';
                                    $('#Create-address_exceptions').prop('disabled', false);
                                    if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].entryId) != 0 ) {
                                        dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                    }else {
                                        dataObj[ aimID ][ cgiTNum ]--;
                                        dataObj[ aimID ][ cgiT ].splice(thisNo,1);
                                    }
                                    break;
                                case 'mime':
                                    cgiT = 'mimeExcepT';
                                    dataObj.file_extensions.mimeExcepT.splice(thisNo,1);
                                    dataObj.file_extensions.mimeExcepNum = dataObj.file_extensions.mimeExcepT.length;
                                    break;
                                case 'file_extension':
                                    cgiT = 'fileExcepT';
                                    dataObj.file_extensions.fileExcepT.splice(thisNo,1);
                                    dataObj.file_extensions.fileExcepNum = dataObj.file_extensions.fileExcepT.length;
                                    break;
                                }
                                // redraw table
                                cgiRedraw( aimID );
                                break;
                            case 'Remove':
                                var thisTr;
                                var thisNo;
                                var cgiGetID;
                                var cgiPostID;
                                var cgiT;
                                var cgiTNum;
                                $('#table-' + aimID + ' tr').each(function() {
                                    
                                    thisTr = $(this);
                                    thisNo = $(this).find('td:eq(0) input:checkbox').val();
                                    switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
                                    {
                                    case true:
                                        cgiGetID;
                                        cgiPostID;
                                        cgiT;
                                        cgiTNum;
                                        
                                        switch( aimID )
                                        {
                                        case 'schedule':
                                            
                                            cgiGetID = 'common_time_list';
                                            cgiPostID = 'common_updateTime';
                                            cgiT = 'guiTimeT';
        
                                            formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                            formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                            formObj.name = "";
                                            formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                            formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                            formObj.day = dataObj[ aimID ][ cgiT ][ thisNo ].day;
                                            formObj.startHour = dataObj[ aimID ][ cgiT ][ thisNo ].startHour;
                                            formObj.startMin = dataObj[ aimID ][ cgiT ][ thisNo ].startMin;
                                            formObj.endHour = dataObj[ aimID ][ cgiT ][ thisNo ].endHour;
                                            formObj.endMin = dataObj[ aimID ][ cgiT ][ thisNo ].endMin;
                                            formObj.action = "1";
                                            jsonObj = yui3.JSON.stringify(formObj);
                                            $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                // remove data after callback
                                                
                                            });
                                            
                                            // temp do out side 
                                            dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            dataObj[ aimID ].guiTimeTNum--;
                                                                                        
                                            break;
                                        case 'address':
                                            
                                            cgiGetID = 'common_addr_list';
                                            cgiPostID = 'common_updateAddr';
                                            cgiT = 'guiAddrT';
                                            formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                            formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                            formObj.name = "";
                                            formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                            formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                            formObj.startIp = dataObj[ aimID ][ cgiT ][ thisNo ].startIp;
                                            formObj.endIp = dataObj[ aimID ][ cgiT ][ thisNo ].endIp;
                                            formObj.netmask = dataObj[ aimID ][ cgiT ][ thisNo ].netmask;
                                            formObj.mac = dataObj[ aimID ][ cgiT ][ thisNo ].mac;
                                            formObj.action = "1";
                                            jsonObj = yui3.JSON.stringify(formObj);
                                            $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                // remove data after callback
                                                
                                            });
                                            
                                            // temp do out side 
                                            dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            dataObj[ aimID ].guiAddrTNum--;
                                            dataObj[ aimID ].guiMacTNum--;
                                                                                        
                                            break;
                                        case 'group_address':

                                            cgiGetID = 'common_gAddr_list';
                                            cgiPostID = 'common_updateGAddr';
                                            cgiT = 'guiGAddrT';
                                            formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                            formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                            formObj.name = "";
                                            formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                            formObj.num = dataObj[ aimID ][ cgiT ][ thisNo ].num;
                                            formObj.idList = dataObj[ aimID ][ cgiT ][ thisNo ].idList;
                                            formObj.action = "1";
                                            
                                            jsonObj = yui3.JSON.stringify(formObj);
                                            $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                // remove data after callback
                                                
                                            });
                                            
                                            // temp do out side 
                                            dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            dataObj[ aimID ].guiGAddrTNum--;
                                            
                                            break;
                                        case 'service':
                                            cgiGetID = 'common_service_list';
                                            cgiPostID = 'common_updateService';
                                            cgiT = 'guiServiceT';
                                            
                                            formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                            formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                            formObj.name = "";
                                            formObj.type = dataObj[ aimID ][ cgiT ][ thisNo ].type;
                                            formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                            formObj.param1 = dataObj[ aimID ][ cgiT ][ thisNo ].param1;
                                            formObj.param2 = dataObj[ aimID ][ cgiT ][ thisNo ].param2;
                                            formObj.action = "1";
                                            jsonObj = yui3.JSON.stringify(formObj);
                                            $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                // remove data after callback
                                                
                                            });
                                            
                                            // temp do out side 
                                            dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            dataObj[ aimID ].guiServiceTNum--;
                                            
                                            break;
                                        case 'group_service':
                                            cgiGetID = 'common_gService_list';
                                            cgiPostID = 'common_updateGService';
                                            cgiT = 'guiGServiceT';
        
                                            formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                            formObj.gid = dataObj[ aimID ][ cgiT ][ thisNo ].gid;
                                            formObj.name = "";
                                            formObj.userDefined = dataObj[ aimID ][ cgiT ][ thisNo ].userDefined;
                                            formObj.num = dataObj[ aimID ][ cgiT ][ thisNo ].num;
                                            formObj.idList = dataObj[ aimID ][ cgiT ][ thisNo ].idList;
                                            formObj.action = "1";
                                            
                                            jsonObj = yui3.JSON.stringify(formObj);
                                            $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                // remove data after callback
                                                
                                            });
                                            
                                            // temp do out side 
                                            dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            dataObj[ aimID ].guiGServiceTNum--;
                                            
                                            break;
                                        case 'wan':
                                            cgiT = 'wanIpIfT';
                                            cgiRef[ aimID ].free[ dataObj[ aimID ][ cgiT ][ thisNo ].name ] = true;
                                            cgiRef[ aimID ].wan.splice( cgiRef[ aimID ].wan.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ), 1);
                                            
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) 
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            else    {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                                dataObj[ aimID ].ipAliasT[ thisNo ].removeTag = true;
                                                dataObj[ aimID ].staticipT[ thisNo ].removeTag = true;
                                                dataObj[ aimID ].dhcpcT[ thisNo ].removeTag = true;
                                                dataObj[ aimID ].staticip6T[ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'zone':
                                            cgiT = 'guiZoneIfT';
                                            cgiTNum = 'guiZoneIfTNum';
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'lan':
                                            cgiT = 'guiLanIfT';
                                            cgiTNum = 'guiLanIfTNum';
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                                dataObj[ aimID ].guiIpAliasT[ thisNo ].removeTag = true;
                                                dataObj[ aimID ].guiDhcpsT[ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'vlan_interfaces':
                                            cgiT = 'guiVlanIfT';
                                            cgiTNum = 'guiVlanIfTNum';
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                                dataObj[ aimID ].guiIpAliasT[ thisNo ].removeTag = true;
                                                dataObj[ aimID ].guiDhcpsT[ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'ipsec_policies':
                                            cgiT = 'guiS2svpnT';
                                            cgiTNum = 'guiS2svpnTNum';
                                            if ( cgiRef.s2svpn.free.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ) != -1 )
                                                cgiRef.s2svpn.free.splice( cgiRef.s2svpn.free.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ), 1);
                                            if ( cgiRef.s2svpn.freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ) != -1 )
                                                cgiRef.s2svpn.freez.splice( cgiRef.s2svpn.freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].name ), 1);
                                            if ( cgiRef.s2svpn.freez.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyName ) != -1 )
                                                cgiRef.s2svpn.freez.splice( cgiRef.s2svpn.free.indexOf( dataObj[ aimID ][ cgiT ][ thisNo ].backupPolicyName ), 1);
                                                
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            
                                            break;
                                        case 'ike_policy':
                                            cgiT = 'guiIpsecikeT';
                                            cgiTNum = 'guiIpsecikeTNum';
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'transform_policy':
                                            cgiT = 'guiIpsectransformT';
                                            cgiTNum = 'guiIpsectransformTNum';
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            
                                            break;
                                        case 'rules':
                                            cgiT = 'guiRulesT';
                                            cgiTNum = 'guiRulesTNum'
                                            cgiRef[ aimID ].move.splice( cgiRef[ aimID ].move.indexOf( thisNo ), 1);
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'advanced_nat':
                                            cgiT = 'guiAdvancedNatT';
                                            cgiTNum = 'guiAdvancedNatTNum'
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'port_forwarding':
                                            cgiT = 'guiPortForwardingT';
                                            cgiTNum = 'guiPortForwardingTNum';
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'static_nat':
                                            cgiT = 'guiStaticNatT';
                                            cgiTNum = 'guiStaticNatTNum';
                                            if (parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid) != 0 ) {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            }else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            break;
                                        case 'user':
                                            cgiT = 'userListT';
                                            
                                            if ( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid != 0) )
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }

                                            tmplTabs.tabs({"disabled": [0]});
                                            break;
                                        case 'group':
                                            cgiT = 'groupListT';
                                            for (var i=0, len=dataObj.user.userListT.length; i<len; i++)
                                            {
                                                if (dataObj.user.userListT[ i ].groupId == dataObj[ aimID ].groupListT[ thisNo ].gid)
                                                    dataObj.user.userListT[ i ].groupId = cgiRef.group.defaultGroupGid;
                                            }
                                            if ( parseInt( dataObj[ aimID ][ cgiT ][ thisNo ].gid != 0) )
                                                dataObj[ aimID ][ cgiT ][ thisNo ].cgiAction = "3";
                                            else {
                                                dataObj[ aimID ][ cgiT ][ thisNo ].removeTag = true;
                                            }
                                            

                                            tmplTabs.tabs({"disabled": [1]});
                                            break;
                                        }
                                        $(this).remove();
                                        break;
                                    }
                                });
                                
                                
                                switch(aimID)
                                {
                                case 'schedule':
                                case 'address':
                                case 'group_address':
                                case 'service':
                                case 'group_service':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;

                                    break;
                                case 'wan':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ].ipAliasT)
                                    {
                                        if (!dataObj[ aimID ].ipAliasT[ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ].ipAliasT[ node ] );
                                    }
                                    
                                    dataObj[ aimID ].ipAliasT = cacheObj;
                                    
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ].staticipT)
                                    {
                                        if (!dataObj[ aimID ].staticipT[ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ].staticipT[ node ] );
                                    }
                                    
                                    dataObj[ aimID ].staticipT = cacheObj;
                                    
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ].dhcpcT)
                                    {
                                        if (!dataObj[ aimID ].dhcpcT[ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ].dhcpcT[ node ] );
                                    }
                                    
                                    dataObj[ aimID ].dhcpcT = cacheObj;
                                    
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ].staticip6T)
                                    {
                                        if (!dataObj[ aimID ].staticip6T[ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ].staticip6T[ node ] );
                                    }
                                    
                                    dataObj[ aimID ].staticip6T = cacheObj;
                                    $('#Create-wan').prop('disabled', false);
                                    break;
                                case 'zone':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    break;
                                case 'lan':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ].guiIpAliasT)
                                    {
                                        if (!dataObj[ aimID ].guiIpAliasT[ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ].guiIpAliasT[ node ] );
                                    }
                                    
                                    dataObj[ aimID ].guiIpAliasT = cacheObj;
                                    dataObj[ aimID ].guiIpAliasTNum = dataObj[ aimID ].guiIpAliasT.length;
                                    
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ].guiDhcpsT)
                                    {
                                        if (!dataObj[ aimID ].guiDhcpsT[ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ].guiDhcpsT[ node ] );
                                    }
                                    
                                    dataObj[ aimID ].guiDhcpsT = cacheObj;
                                    dataObj[ aimID ].guiDhcpsTNum = dataObj[ aimID ].guiDhcpsT.length;
                                    
                                    break;
                                case 'vlan_interfaces':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ].guiIpAliasT)
                                    {
                                        if (!dataObj[ aimID ].guiIpAliasT[ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ].guiIpAliasT[ node ] );
                                    }
                                    
                                    dataObj[ aimID ].guiIpAliasT = cacheObj;
                                    dataObj[ aimID ].guiIpAliasTNum = dataObj[ aimID ].guiIpAliasT.length;
                                    
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ].guiDhcpsT)
                                    {
                                        if (!dataObj[ aimID ].guiDhcpsT[ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ].guiDhcpsT[ node ] );
                                    }
                                    
                                    dataObj[ aimID ].guiDhcpsT = cacheObj;
                                    dataObj[ aimID ].guiDhcpsTNum = dataObj[ aimID ].guiDhcpsTNum.length;

                                    break;
                                case 'ipsec_policies':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    break;
                                case 'ike_policy':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    break;
                                case 'transform_policy':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    break;
                                case 'rules':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    break;
                                case 'advanced_nat':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    break;
                                case 'port_forwarding':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    break;
                                case 'static_nat':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    break;
                                case 'user':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    tmplTabs.tabs({"disabled": [0]});
                                    break;
                                case 'group':
                                    cacheObj = [];
                                    for (var node in dataObj[ aimID ][ cgiT ])
                                    {
                                        if (!dataObj[ aimID ][ cgiT ][ node ].removeTag)
                                            cacheObj.push( dataObj[ aimID ][ cgiT ][ node ] );
                                    }
                                    
                                    dataObj[ aimID ][ cgiT ] = cacheObj;
                                    dataObj[ aimID ][ cgiTNum ] = dataObj[ aimID ][ cgiT ].length;
                                    tmplTabs.tabs({"disabled": [1]});
                                    break;
                                }
                                cgiRedraw( aimID );
                                break;
                            case 'Refresh':
                            console.log( btClass + ' @ ' + aimID );
                                switch( aimID )
                                {
                                case 'ipsec_policies':
                                
                                    break;
                                default:
                                    cgiRefresh( aimID );
                                    break;
                                }
                                break;
                            case 'Query':
                                switch( aimID )
                                {
                                case 'rules':
                                    $(tableBD + ' tr').hide();
                                    cgiRef.rules.move = [];
                                    cgiRef.rules.query = false;
                                    switch( isNaN( parseInt( $('#query-fromZone').val() ) ) )
                                    {
                                    case true:
                                        switch( isNaN( parseInt( $('#query-toZone').val() ) ) )
                                        {
                                        case true:
                                            $(tableBD + ' tr').show();
                                            $(tableBD + ' tr').each(function() {
                                                cgiRef.rules.move.push( parseInt($(this).find('td:eq(0) input:checkbox').val()) );
                                            });
                                            break;
                                        case false:
                                            $(tableBD + ' tr').each(function() {
                                                switch($(this).hasClass('toZone' + $('#query-toZone').val()))
                                                {
                                                case true:
                                                    $(this).show();
                                                    cgiRef.rules.query = true;
                                                    cgiRef.rules.move.push( parseInt($(this).find('td:eq(0) input:checkbox').val()) );
                                                    break;
                                                case false:
                                                    $(this).hide();
                                                    break;
                                                }
                                            });
                                            break; 
                                        }
                                        break;
                                    case false:
                                        switch( isNaN( parseInt( $('#query-toZone').val() ) ) )
                                        {
                                        case true:
                                            $(tableBD + ' tr').each(function() {
                                                switch($(this).hasClass('fromZone' + $('#query-fromZone').val()))
                                                {
                                                case true:
                                                    $(this).show();
                                                    cgiRef.rules.query = true;
                                                    cgiRef.rules.move.push( parseInt($(this).find('td:eq(0) input:checkbox').val()) );
                                                    break;
                                                case false:
                                                    $(this).hide();
                                                    break;
                                                }
                                            });
                                            break;
                                        case false:
                                            switch($('#query-fromZone').val() != $('#query-toZone').val())
                                            {
                                            case true:
                                                $(tableBD + ' tr').each(function() {
                                                    switch($(this).hasClass('toZone' + $('#query-toZone').val()))
                                                    {
                                                    case true:
                                                        switch($(this).hasClass('fromZone' + $('#query-fromZone').val()))
                                                        {
                                                        case true:
                                                            $(this).show();
                                                            cgiRef.rules.query = true;
                                                            cgiRef.rules.move.push( parseInt($(this).find('td:eq(0) input:checkbox').val()) );
                                                            break;
                                                        case false:
                                                            $(this).hide();
                                                            break; 
                                                        }
                                                        break;
                                                    case false:
                                                        $(this).hide();
                                                        break;
                                                    }
                                                });
                                                break;
                                            case false:
                                                $(tableBD + ' tr').hide();
                                                break;
                                            }
                                            break; 
                                        }
                                        break;
                                    }
                                    
                                    break; 
                                }
                                break;
                            case 'Connect':
                                var thisTr = $(this).parents('tr');
                                var thisNo = btID.replace(btClass + '-' + aimID + '-', '');
                                $('#Connect-' + aimID + '-' + thisNo).prop('disabled', true);
                                $('#Disconnect-' + aimID + '-' + thisNo).prop('disabled', false);
                                formObj = {};
                                switch(aimID)
                                {
                                case 'active_sessions':
                                    formObj.guiIpsecSessionUpDownTNum = "1";
                                    formObj.guiIpsecSessionUpDownT = [{ "sessionName": dataObj[ aimID ].guiIpsecSessionT[ thisNo ].sessionName, "instno": dataObj[ aimID ].guiIpsecSessionT[ thisNo ].instno, "actionType": "1" }];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/ipsecSessionUpDown.cgi', jsonObj);
                                    break;
                                case 'ipsec_policies':
                                    formObj.name = dataObj[ aimID ].guiS2svpnT[ thisNo ].name;
                                    formObj.actionType = "1";
                                    dataObj[ aimID ].guiS2svpnT[ thisNo ].infoStatus = "1";
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/s2svpnUpDown.cgi', jsonObj);
                                    break;
                                }
                                break;
                            case 'Disconnect':
                                var thisTr = $(this).parents('tr');
                                var thisNo = btID.replace(btClass + '-' + aimID + '-', '');
                                $('#Connect-' + aimID + '-' + thisNo).prop('disabled', false);
                                $('#Disconnect-' + aimID + '-' + thisNo).prop('disabled', true);
                                formObj = {};
                                switch(aimID)
                                {
                                case 'active_sessions':
                                    formObj.guiIpsecSessionUpDownTNum = "1";
                                    formObj.guiIpsecSessionUpDownT = [{ "sessionName": dataObj[ aimID ].guiIpsecSessionT[ thisNo ].sessionName, "instno": dataObj[ aimID ].guiIpsecSessionT[ thisNo ].instno, "actionType": "0" }];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/ipsecSessionUpDown.cgi', jsonObj);
                                    break;
                                case 'ipsec_policies':
                                    formObj.name = dataObj[ aimID ].guiS2svpnT[ thisNo ].name;
                                    formObj.actionType = "0";
                                    dataObj[ aimID ].guiS2svpnT[ thisNo ].infoStatus = "0";
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/s2svpnUpDown.cgi', jsonObj);
                                    break;
                                }
                                break;
                            case 'Disconnects':
                                formObj = {};
                                switch(aimID)
                                {
                                case 'active_sessions':
                                    formObj.guiIpsecSessionUpDownT = [];
                                    $('#table-' + aimID + ' tbody tr').each(function() {
                                        switch($(this).find('td:eq(0) input:checkbox').is(':checked'))
                                        {
                                        case true:
                                            var idx = $(this).find('td:eq(0) input:checkbox').val();
                                            formObj.guiIpsecSessionUpDownT.push( {"sessionName": dataObj[ aimID ].guiIpsecSessionT[ idx ].sessionName, "instno": dataObj[ aimID ].guiIpsecSessionT[ idx ].instno, "actionType": "0" } );
                                            $('#Connect-' + aimID + '-' + idx).prop('disabled', false);
                                            $('#Disconnect-' + aimID + '-' + idx).prop('disabled', true);
                                            $(this).find('td:eq(0) input:checkbox').attr('checked', false);
                                            break;
                                        }
                                    });
                                    
                                    formObj.guiIpsecSessionUpDownTNum = formObj.guiIpsecSessionUpDownT.length;
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/ipsecSessionUpDown.cgi', jsonObj);
                                    break;
                                
                                }
                                break;
                            case 'MoveUp':
                                var thisNo = parseInt( $(this).attr('id').replace( btClass + '-' + aimID + '-', '') );
                                var idx = cgiRef.rules.move.indexOf( thisNo );
                                var newIdx = idx - 1;
                                if (idx > 0) {
                                    var tmp = dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ newIdx ] ];
                                    dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ newIdx ] ] = dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ idx ] ];
                                    if (parseInt(dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ newIdx ] ].gid)>0)
                                        dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ newIdx ] ].cgiAction = "2";
                                    dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ idx ] ] = tmp;
                                    if (parseInt(dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ idx ] ].gid)>0)
                                        dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ idx ] ].cgiAction = "2";
                                    cgiRedraw( aimID );
                                }
                                
                                break;
                            case 'MoveDown':
                                var thisNo = parseInt( $(this).attr('id').replace( btClass + '-' + aimID + '-', '') );
                                var idx = cgiRef.rules.move.indexOf( thisNo );
                                var newIdx = idx + 1;
                                if (newIdx < cgiRef.rules.move.length) {
                                    var tmp = dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ newIdx ] ];
                                    dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ newIdx ] ] = dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ idx ] ];
                                    if (parseInt(dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ newIdx ] ].gid)>0)
                                        dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ newIdx ] ].cgiAction = "2";
                                    dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ idx ] ] = tmp;
                                    if (parseInt(dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ idx ] ].gid)>0)
                                        dataObj[ aimID ].guiRulesT[ cgiRef.rules.move[ idx ] ].cgiAction = "2";
                                    cgiRedraw( aimID );
                                }
                                break;
                            case 'Move2Add':
                                var vSel;
                                switch(aimID)
                                {
                                case 'group_service':
                                case 'group_address':
                                
                                    vSel = $('#' + aimID + '-idListPool option:selected');
                                    vSel.clone().appendTo('#' + aimID + '-idList');
                                    break;
                                case 'zone':
                                    vSel = $('#' + aimID + '-memberPool option:selected');
                                    vSel.clone().appendTo('#' + aimID + '-member');
                                    break;
                                case 'lan':
                                    vSel = $('#' + aimID + '-interfacesPool option:selected');
                                    vSel.clone().appendTo('#' + aimID + '-interfaces');
                                    break;
                                default:
                                    vSel = $('#' + aimID + 'Pool option:selected');
                                    vSel.clone().appendTo('#' + aimID);
                                }
                                vSel.remove();
                                break;
                            case 'Move2Del':
                                var vSel;
                                switch(aimID)
                                {
                                case 'group_service':
                                case 'group_address':
                                    vSel = $('#' + aimID + '-idList option:selected');
                                    vSel.clone().appendTo('#' + aimID + '-idListPool');
                                    break;
                                case 'zone':
                                    vSel = $('#' + aimID + '-member option:selected');
                                    vSel.clone().appendTo('#' + aimID + '-memberPool');
                                    break;
                                case 'lan':
                                    vSel = $('#' + aimID + '-interfaces option:selected');
                                    vSel.clone().appendTo('#' + aimID + '-interfacesPool');
                                    break;
                                default:
                                    vSel = $('#' + aimID + ' option:selected');
                                    vSel.clone().appendTo('#' + aimID + 'Pool');
                                }

                                vSel.remove();
                                break;
                            case 'Save':
                                // temp set differ by id, will build with form action later
                                var isPass = true;
                                console.log('Save: ' + aimID );    
                                formObj = {};
                                switch(aimID)
                                {
                                case 'properties':
                                    $(formID).find('input').each(function() {
                                        formObj[$(this).attr('id')] = $(this).attr('value');
                                    });
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/sysPorperty.cgi', jsonObj);
                                    break;
                                case 'ports':
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/port.cgi', jsonObj);
                                    break;
                                case 'wan':
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/wan.cgi', jsonObj);
                                    break;
                                
                                case 'multiwan':
                                    formObj.mode = $(formID + ' input[name=mode]:checked').val();
                                    switch( parseInt(formObj.mode) )
                                    {
                                    case 0:
                                        formObj.period   = $('#period').val();
                                        formObj.count    = $('#count').val();
                                        break;
                                    case 1:
                                        formObj.period   = "";
                                        formObj.count    = ""
                                        break;
                                    }
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/multiwan.cgi', jsonObj);
                                    break;
                                case 'lan':
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/lan.cgi', jsonObj);
                                    break;
                                case 'vlan_interfaces':
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/vlan.cgi', jsonObj);
                                    break;
                                case 'zone':
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/zone.cgi', jsonObj);
                                    break;
                                case 'routing':
                                    formObj.routeMode = $(formID + ' input[name=routeMode]:checked').val() ;
                                    formObj.protoType = $(formID + ' input[name=protoType]:checked').val() ;
                                    cgiRef.routing = formObj;
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/routing.cgi', jsonObj);
                                    break;
                                case 'ipsec_policies':
                                    dataObj[ aimID ].s2svpnEnable = ($('#s2svpnEnable').is(':checked'))? "1" : " 0";
                                    formObj = dataObj[aimID];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/s2svpn.cgi', jsonObj);
                                    break;
                                case 'transform_policy':
                                    formObj = dataObj[aimID];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/ipsectransform.cgi', jsonObj);
                                    break;
                                case 'ike_policy':
                                    formObj = dataObj[aimID];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/ipsecike.cgi', jsonObj);
                                    break;
                                // firewall
                                case 'rules':
                                    formObj = dataObj[aimID];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/rules.cgi', jsonObj);
                                    break;
                                case 'advanced_nat':
                                    formObj = dataObj[aimID];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/advancedNat.cgi', jsonObj);
                                    break;
                                case 'port_forwarding':
                                    formObj = dataObj[aimID];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/portForwarding.cgi', jsonObj);
                                    break;
                                case 'static_nat':
                                    formObj = dataObj[aimID];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/staticNat.cgi', jsonObj);
                                    break;
                                    // dyanmic pat 
                                case 'pat_settings':
                                    
                                    formObj = $.extend({}, dataObj.dynamic_pat);
                                    
                                    for (var i=0, len=parseInt(formObj.guiDynamicPatTNum); i<len; i++)
                                    {
                                        var isMod = false;
                                        for (var node in formObj.guiDynamicPatT[ i ])
                                        {
                                            switch(node)
                                            {
                                            case 'enableWan1':
                                            case 'enableWan2':
                                            case 'enableWan3':
                                            case 'enableWan4':
                                            case 'enableWan5':
                                            case 'enableWan6':
                                                switch ($('#' + node + '-' + i).is(':checked')) 
                                                {
                                                case true:    
                                                    if (parseInt(formObj.guiDynamicPatT[ i ][ node ]) == 0)
                                                        isMod = true;
                                                    formObj.guiDynamicPatT[ i ][ node ] = "1";
                                                    break;
                                                case false:
                                                    if (parseInt(formObj.guiDynamicPatT[ i ][ node ]) == 1)
                                                        isMod = true;
                                                    formObj.guiDynamicPatT[ i ][ node ] = "0";
                                                    break;
                                                }
                                                break;
                                            case 'cgiAction':
                                                if (isMod)
                                                    formObj.guiDynamicPatT[ i ][ node ] = "2";
                                                else
                                                    formObj.guiDynamicPatT[ i ][ node ] = "0";
                                                break;
                                            }
                                        }
                                    }
                                    
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/dynamicPat.cgi', jsonObj);
                                    break;
                                case 'wan_address_settings':
                                    formObj = dataObj.dynamic_pat;
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/dynamicPat.cgi', jsonObj);
                                    break;
                                case 'default_policy':
                                    formObj = $.extend({}, dataObj[ aimID ]);
                                    var trNo = 0;
                                    $(tableBD + ' tr').each(function() {
                                        $(this).find('td').each(function() {
                                            var tID;
                                            switch($(this).hasClass('selectTD'))
                                            {
                                            case true:
                                                switch(parseInt( dataObj[ aimID ].guiDefaultPolicyT[ trNo ].policy ) == parseInt( $('#policy-' + trNo).val() ) )
                                                {
                                                case false:
                                                    formObj.guiDefaultPolicyT[ trNo ].policy = $('#policy-' + trNo).val();
                                                    formObj.guiDefaultPolicyT[ trNo ].cgiAction = "2";
                                                    break;
                                                }
                                                break;

                                            }
                                        });
                                        
                                        trNo++;
                                    });
                                    
                                    formObj = dataObj.default_policy;
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/defaultPolicy.cgi', jsonObj);
                                    break;
                                // antivirus
                                case 'general_settings':
                                    isPass = true;
                                    $('.error').html("");
                                    
                                    if (isNaN(parseInt($('#maxFileSize').val())) || parseInt($('#maxFileSize').val()) < 0 || parseInt($('#maxFileSize').val()) > 10240) {
                                        isPass = false;
                                        $('.error').html('range error');
                                        $('#maxFileSize').focus();
                                    }
                                    
                                    if (isPass) {
                                        for (var node in dataObj[ aimID ])
                                        {
                                            switch(node)
                                            {
                                            case 'selectedZonesNum':
                                            case 'licensed':
                                                break;
                                            case 'selectedZonesT':
                                                dataObj[ aimID ][ node ] = [];
                                                $('#' + node + ' option').each(function() {
                                                    dataObj[ aimID ][ node ].push( {"gid": $(this).val() } );
                                                });
                                                
                                                dataObj[ aimID ].selectedZonesNum = dataObj[ aimID ][ node ].length;
                                                break;
                                            case 'maxFileSize':
                                            case 'httpAct':
                                            case 'ftpAct':
                                            case 'smtpAct':
                                            case 'pop3Act':
                                                dataObj[ aimID ][ node ] = $('#' + node).val();
                                                break;
                                            default:
                                                switch($('#' + node).attr('checked') == 'checked')
                                                {
                                                case true:
                                                    dataObj[ aimID ][ node ] = "1";
                                                    break;
                                                case false:
                                                    dataObj[ aimID ][ node ] = "0";
                                                    break;
                                                }
                                            }
                                        }
                                        
                                        formObj = dataObj[aimID];
                                        jsonObj = yui3.JSON.stringify(formObj);
                                        $.post('cgi-bin/av_general.cgi', jsonObj);
                                    }
                                    break;
                                case 'http_notification':
                                    dataObj[aimID].httpNotify = $('#httpNotify').val();
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/av_http_notify.cgi', jsonObj);
                                    break;
                                case 'email_notification':
                                    dataObj[ aimID ].mailTag = $('#mailTag').val();
                                    dataObj[ aimID ].mailContent = $('#mailContent').val();
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/av_email_notify.cgi', jsonObj);
                                    break;
                                case 'address_exceptions':
                                    formObj = {};
                                    formObj.excepT = [];
                                    console.log(dataObj[ aimID ].excepT);
                                    for (var i=0, len=parseInt(dataObj[ aimID ].excepNum); i<len; i++)
                                    {
                                        if (parseInt(dataObj[ aimID ].excepT[ i ].cgiAction) > 0)
                                            formObj.excepT.push(dataObj[ aimID ].excepT[ i ]);
                                    }
                                    formObj.excepNum = formObj.excepT.length;
                                    formObj.licensed = dataObj[ aimID ].licensed;
                                
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/av_addr_exception.cgi', jsonObj);
                                    
                                    // rebuild after sent
                                    cgiRedraw( aimID );
                                    break;
                                case 'file_extensions':
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/av_file_exception.cgi', jsonObj);
                                    break;
                                case 'signature':
                                    if ($('#autoUpdate').is(':checked'))
                                        dataObj[ aimID ].autoUpdate = "1";
                                    else
                                        dataObj[ aimID ].autoUpdate = "0";

                                    if ($('#schedules').is(':checked'))
                                        dataObj[ aimID ].schedule = "1";
                                    else
                                        dataObj[ aimID ].schedule = "0";
                                    dataObj[ aimID ].time = $('#time').val();
                                    dataObj[ aimID ].day    = $('#day').val();
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/av_sig.cgi', jsonObj);
                                    break;
                                // admin
                                case 'administrator_settings':
                                    var isPass = true;
                                    checkObj = {};
                                    $('.errorLabel').remove();
                                    
                                    
                                    if ($('#adminNewPwd').val().length > 0 || $('#confirmNewPwd').val().length > 0) {
                                        // pwd change, check
                                        checkObj.adminNewPwd = $('#adminNewPwd').val();
                                        checkObj.confirmNewPwd = $('#confirmNewPwd').val();
                                        if ( checkObj.adminNewPwd == checkObj.confirmNewPwd ) {
                                            if ($('#adminOldPwd').val().length > 0 && $('#adminName').val().length > 0) {
                                                
                                                checkObj.name = $('#adminName').val();
                                                checkObj.password = $('#adminOldPwd').val();
                                                jsonObj = yui3.JSON.stringify(checkObj);
                                                $.post('cgi-bin/checkCurrentPwd.cgi', jsonObj, function(data) {
                                                    // suppose i'll get valid
                                                    checkObj.result = data.result;
                                                    if (checkObj.result != 'success') {
                                                        $('#adminOldPwd').parents('td').append('<label class="errorLabel" for="adminOldPwd"><span class="error">check fail</span></label>')
                                                        if (isPass)
                                                            $('#adminOldPwd').focus();
                                                        isPass = false;
                                                    }
                                                
                                                    if ($('#loginInactiveTimeout').val().length == 0 || parseInt($('#loginInactiveTimeout').val()) < 0 || parseInt($('#loginInactiveTimeout').val()) > 1000) {
                                                        $('#loginInactiveTimeout').parents('td').append('<label class="errorLabel" for="loginInactiveTimeout"><span class="error">range error</span></label>')
                                                        if (isPass)
                                                            $('#loginInactiveTimeout').focus();
                                                        isPass = false;
                                                    }
                                                    
                                                    if ($('#loginSessionLimit').val().length == 0 || parseInt($('#loginSessionLimit').val()) < 0 || parseInt($('#loginSessionLimit').val()) > 1000) {
                                                        $('#loginSessionLimit').parents('td').append('<label class="errorLabel" for="loginSessionLimit"><span class="error">range error</span></label>')
                                                        if (isPass)
                                                            $('#loginSessionLimit').focus();
                                                        isPass = false;
                                                    }
                                                    
                                                    if ($('#loginFailBlockMaxAttempts').val().length == 0 || parseInt($('#loginFailBlockMaxAttempts').val()) < 0 || parseInt($('#loginFailBlockMaxAttempts').val()) > 1000) {
                                                        $('#loginFailBlockMaxAttempts').parents('td').append('<label class="errorLabel" for="loginFailBlockMaxAttempts"><span class="error">range error</span></label>')
                                                        if (isPass)
                                                            $('#loginFailBlockMaxAttempts').focus();
                                                        isPass = false;
                                                    }
                                                    
                                                    if ($('#loginFailBlockTime').val().length == 0 || parseInt($('#loginFailBlockTime').val()) < 0 || parseInt($('#loginFailBlockTime').val()) > 3600) {
                                                        $('#loginFailBlockTime').parents('td').append('<label class="errorLabel" for="loginFailBlockTime"><span class="error">range error</span></label>')
                                                        if (isPass)
                                                            $('#loginFailBlockTime').focus();
                                                        isPass = false;
                                                    }
                                                    
                                                    if (isPass) {
                                                        dataObj[ aimID ].setPassword = "1";
                                                        dataObj[ aimID ].adminName = $('#adminName').val();
                                                        dataObj[ aimID ].adminNewPwd = $('#adminNewPwd').val();
                                                            
                                                        dataObj[ aimID ].loginInactiveTimeout = $('#loginInactiveTimeout').val();
                                                        dataObj[ aimID ].loginSessionLimitEnable = ($('#loginSessionLimitEnable').is(':checked'))? "1" : "0";
                                                        dataObj[ aimID ].loginSessionLimit = $('#loginSessionLimit').val();
                                                        dataObj[ aimID ].loginFailBlockMaxAttempts = $('#loginFailBlockMaxAttempts').val();
                                                        dataObj[ aimID ].loginFailBlockTime = $('#loginFailBlockTime').val();
                                                        
                                                        formObj = dataObj[ aimID ];
                                                        
                                                        jsonObj = yui3.JSON.stringify(formObj);
                                                        $.post('cgi-bin/adminsetting.cgi', jsonObj);
                                                    }
                                                });
                                            }else {
                                                $('#adminOldPwd').parents('td').append('<label class="errorLabel" for="adminOldPwd"><span class="error">check fail</span></label>')
                                                if (isPass)
                                                    $('#adminOldPwd').focus();
                                                isPass = false;
                                            }
                                        }else {
                                            $('#confirmNewPwd').parents('td').append('<label class="errorLabel" for="confirmNewPwd"><span class="error">match fail</span></label>')
                                            if (isPass)
                                                $('#confirmNewPwd').focus();
                                            isPass = false;
                                        }
                                    }else {
                                    
                                        if ($('#loginInactiveTimeout').val().length == 0 || parseInt($('#loginInactiveTimeout').val()) < 0 || parseInt($('#loginInactiveTimeout').val()) > 1000) {
                                            $('#loginInactiveTimeout').parents('td').append('<label class="errorLabel" for="loginInactiveTimeout"><span class="error">range error</span></label>')
                                            if (isPass)
                                                $('#loginInactiveTimeout').focus();
                                            isPass = false;
                                        }
                                        
                                        if ($('#loginSessionLimit').val().length == 0 || parseInt($('#loginSessionLimit').val()) < 0 || parseInt($('#loginSessionLimit').val()) > 1000) {
                                            $('#loginSessionLimit').parents('td').append('<label class="errorLabel" for="loginSessionLimit"><span class="error">range error</span></label>')
                                            if (isPass)
                                                $('#loginSessionLimit').focus();
                                            isPass = false;
                                        }
                                        
                                        if ($('#loginFailBlockMaxAttempts').val().length == 0 || parseInt($('#loginFailBlockMaxAttempts').val()) < 0 || parseInt($('#loginFailBlockMaxAttempts').val()) > 1000) {
                                            $('#loginFailBlockMaxAttempts').parents('td').append('<label class="errorLabel" for="loginFailBlockMaxAttempts"><span class="error">range error</span></label>')
                                            if (isPass)
                                                $('#loginFailBlockMaxAttempts').focus();
                                            isPass = false;
                                        }
                                        
                                        if ($('#loginFailBlockTime').val().length == 0 || parseInt($('#loginFailBlockTime').val()) < 0 || parseInt($('#loginFailBlockTime').val()) > 3600) {
                                            $('#loginFailBlockTime').parents('td').append('<label class="errorLabel" for="loginFailBlockTime"><span class="error">range error</span></label>')
                                            if (isPass)
                                                $('#loginFailBlockTime').focus();
                                            isPass = false;
                                        }
                                        
                                        // if pwd change, do this under callback            
                                        if (isPass) {

                                            dataObj[ aimID ].setPassword = "0";
                                                
                                            dataObj[ aimID ].loginInactiveTimeout = $('#loginInactiveTimeout').val();
                                            dataObj[ aimID ].loginSessionLimitEnable = ($('#loginSessionLimitEnable').is(':checked'))? "1" : "0";
                                            dataObj[ aimID ].loginSessionLimit = $('#loginSessionLimit').val();
                                            dataObj[ aimID ].loginFailBlockMaxAttempts = $('#loginFailBlockMaxAttempts').val();
                                            dataObj[ aimID ].loginFailBlockTime = $('#loginFailBlockTime').val();
                                            
                                            formObj = dataObj[ aimID ];
                                            
                                            jsonObj = yui3.JSON.stringify(formObj);
                                            $.post('cgi-bin/adminsetting.cgi', jsonObj);
                                        }
                                    }
                                    break;
                                case 'date_and_time':
                                    for (var node in dataObj[aimID])
                                    {
                                        switch( node )
                                        {
                                        case 'mode':
                                        case 'ntpServerType':
                                            $('input[name=' + node + ']').each(function() {
                                                switch($(this).is(':checked'))
                                                {
                                                case true:
                                                    formObj[node] = $(this).val();
                                                    break;
                                                }
                                            });
                                            break;
                                        case 'dstEnable':
                                            switch($('#' + node).is(':checked'))
                                            {
                                            case true:
                                                switch($('#' + node).is(':disabled'))
                                                {
                                                case true:
                                                    formObj[node] = "0";
                                                    break;
                                                case false:
                                                    formObj[node] = "1";
                                                    break;
                                                }
                                                break;
                                            case false:
                                                formObj[node] = "0";
                                                break;
                                            }
                                            break;
                                        case 'ntpDefaultSever':
                                            formObj[node] = dataObj[aimID][node];
                                            break;
                                        case 'year':
                                        case 'month':
                                        case 'day':
                                            break;
                                        default: 
                                            formObj[node] = $('#' + node).val();
                                        }
                                    }
                                    var arr = $('#sysDate').val().split(regDash);
                                    formObj.year = arr[0];
                                    formObj.month = arr[1];
                                    formObj.day = arr[2];

                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/systime.cgi', jsonObj);
                                    break;
                                case 'user':
                                    formObj = dataObj[ aimID ];
                                    for (var x in formObj.userListT) {
                                        console.log(formObj.userListT[ x ].cgiSetPwd + ' @ ' + formObj.userListT[ x ].password);
                                        if (formObj.userListT[ x ].cgiSetPwd  == 0)
                                            formObj.userListT[ x ].password = "";
                                    }
                                    console.log(formObj);
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/userList.cgi', jsonObj).done( function() {});
                                        $.ajax({
                                            url: 'cgi-bin/userList.cgi',
                                            dataType: 'json',
                                            success: function(data) {
                                                dataObj.user = $.extend({}, data);
                                                $.ajax({
                                                    url: 'cgi-bin/groupList.cgi',
                                                    dataType: 'json',
                                                    success: function(data) {
                                                        dataObj.group = $.extend({}, data);
                                                        tmplTabs.tabs('enable', 0);
                                                        cgiRedraw( aimID );
                                                    }
                                                });
                                            }
                                        });
                                    //});
                                    break;
                                case 'group':
                                    formObj = dataObj[ aimID ];
                                    jsonObj = yui3.JSON.stringify(formObj);
                                    $.post('cgi-bin/userList.cgi', jsonObj).done( function() {});
                                        $.ajax({
                                            url: 'cgi-bin/userList.cgi',
                                            dataType: 'json',
                                            success: function(data) {
                                                dataObj.user = $.extend({}, data);
                                                $.ajax({
                                                    url: 'cgi-bin/groupList.cgi',
                                                    dataType: 'json',
                                                    success: function(data) {
                                                        dataObj.group = $.extend({}, data);
                                                        tmplTabs.tabs('enable', 1);
                                                        cgiRedraw( aimID );
                                                    }
                                                });
                                            }
                                        });
                                    //});
                                    
                                }
                                break;
                            }
                        });

                        /* node event handler */
                        // check if input text length change
                        $('input').live('blur', function() {
                            var iID = $(this).attr('id');
                            switch ($('#' + iID).length > 0) 
                            {
                            case true:
                                switch(iID)
                                {
                                case 'vlan_interfaces-address':
                                    if (regIpv4.test($(this).val()) && regIpv4.test($('#vlan_interfaces-netmask').val()))
                                        $('#div-ip_alias button').prop('disabled', false);
                                    else
                                        $('#div-ip_alias button').prop('disabled', true);    
                                    break;
                                case 'vlan_interfaces-netmask':
                                    if (regIpv4.test($(this).val()) && regIpv4.test($('#vlan_interfaces-address').val()))
                                        $('#div-ip_alias button').prop('disabled', false);
                                    else
                                        $('#div-ip_alias button').prop('disabled', true);    
                                    break;
                                case 'lan-address':
                                    if (regIpv4.test($(this).val()) && regIpv4.test($('#lan-netmask').val()))
                                        $('#div-ip_alias button').prop('disabled', false);
                                    else
                                        $('#div-ip_alias button').prop('disabled', true);    
                                    break;
                                case 'lan-netmask':
                                    if (regIpv4.test($(this).val()) && regIpv4.test($('#lan-address').val()))
                                        $('#div-ip_alias button').prop('disabled', false);
                                    else
                                        $('#div-ip_alias button').prop('disabled', true);    
                                    break;
                                case 'ports-address':
                                    if (regIpv4.test($(this).val()) && regIpv4.test($('#ports-netmask').val()))
                                        $('#div-ip_alias button').prop('disabled', false);
                                    else
                                        $('#div-ip_alias button').prop('disabled', true);    
                                    break;
                                case 'ports-netmask':
                                    if (regIpv4.test($(this).val()) && regIpv4.test($('#ports-address').val()))
                                        $('#div-ip_alias button').prop('disabled', false);
                                    else
                                        $('#div-ip_alias button').prop('disabled', true);    
                                    break;
                                }
                                break;
                            }
                        });
                        /* select change */
                        $('select').live('change', function(e) {
                            var sID = $(this).attr('id');
                            var pID = sID.split(regDash)[0];
                            var cgiID;
                            var oVal = $(this).find("option:selected").val();
                            var cgiGetID;
                            var cgiPostID;
                            var cgiT;
                            var cgiTNum;
                            var aimID;
                            var tmp;
                            
                            switch(oVal)
                            {
                            case 'cAddr':
                                $('#extra').empty();
                                cgiGetID = 'common_addr_list';
                                cgiPostID = 'common_updateAddr';
                                cgiT = 'guiAddrT';
                                cgiTNum = 'guiAddrTNum';
                                aimID = 'address';
                                selID = pID;
                                $('#extra').load('forms/address.html .extraForm', function() {
                                    $('.extraForm').dialog({
                                        width: 600,
                                        height:600,
                                        position: "center",
                                        resizable: false,
                                        modal: true,
                                        buttons: {
                                            OK: function() {
                                                
                                                calcObj = {};
                                                isPass = true;
                                                $('.errorLabel').remove();
                                                if ($('#' + aimID + '-name').val().length == 0) {
                                                    isPass = false;
                                                    $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID + '-name"><span class="error">name required</span></label>');
                                                    $('#' + aimID + '-name').focus();
                                                }
                                                
                                                var types = parseInt( $('#' + aimID + '-type option:selected').val() );
                                                var arr = [];
                                                switch(parseInt( $('#' + aimID + '-type option:selected').val() ))
                                                {
                                                case 1:
                                                    
                                                    if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                        arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                        for (var i=0, ilen=arr.length; i<ilen; i++)
                                                        {
                                                            arr[i] = parseInt(arr[i]);
                                                            switch (arr[i] > 255 || arr[i] < 0) 
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                isPass = false;
                                                                break;
                                                            case false:
                                                                switch(i)
                                                                {
                                                                case 3:
                                                                    switch(arr[i] == 255 || arr[i] == 0 )
                                                                    {
                                                                    case true:
                                                                        $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                        isPass = false;
                                                                        break; 
                                                                    }
                                                                    break; 
                                                                }
                                                                break;
                                                            }
                                                        }
                                                        if (isPass)
                                                            $('#' + aimID + '-type-' + types + '-startIp').val( arr.join('.') );

                                                    }else {
                                                        $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                        if (isPass)
                                                             $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                        isPass = false;
                                                    }
                                                    break;
                                                case 2:
                                                    if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                        arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                        for (var i=0, ilen=arr.length; i<ilen; i++)
                                                        {
                                                            switch (arr[i] > 255 || arr[i] < 0) 
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                isPass = false;
                                                                break;
                                                            case false:
                                                                calcObj["ip_" + (i+1)] = parseInt(arr[i]);
                                                                break;
                                                            }
                                                        }
                                                    }else {
                                                        $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                        if (isPass)
                                                             $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                        isPass = false;
                                                    }
                                                    
                                                    if (regIpv4.test($('#' + aimID + '-type-' + types + '-netmask').val()) && $('#' + aimID + '-type-' + types + '-netmask').val() != '255.255.255.255' ) {
                                                        arr = $('#' + aimID + '-type-' + types + '-netmask').val().split(regDot);
                                                        for (var i=0, ilen=arr.length; i<ilen; i++)
                                                        {
                                                            switch (arr[i] > 255 || arr[i] < 0) 
                                                            {
                                                            case true:
                                                                $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                isPass = false;
                                                                break;
                                                            case false:
                                                                calcObj["snm_" + (i+1)] = parseInt(arr[i]);
                                                                break;
                                                            }
                                                        }
                                                    }else {
                                                        $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                        if (isPass)
                                                             $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                        isPass = false;
                                                    }
                                                    
                                                    if (isPass) {
                                                        calcNWbits(calcObj);
                                                        
                                                        if (calcObj.result != 'invalid') {
                                                            calcObj.bits = calcObj.result;
                                                            calcNBFL(calcObj);
                                                            
                                                            switch(calcObj.numofaddr)
                                                            {
                                                            case 'ERR':
                                                                $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                isPass = false;
                                                                break;
                                                            case 'one':
                                                            case 'two':
                                                                calcObj.startIp = calcObj.firstadr_1 + '.' + calcObj.firstadr_2 + '.' + calcObj.firstadr_3 + '.' + calcObj.firstadr_4;
                                                                calcObj.endIp     = calcObj.lastadr_1 + '.' + calcObj.lastadr_2 + '.' + calcObj.lastadr_3 + '.' + calcObj.lastadr_4;
                                                                break;                                                                
                                                            default:
                                                                calcObj.startIp = calcObj.nwadr_1 + '.' + calcObj.nwadr_2 + '.' + calcObj.nwadr_3 + '.' + calcObj.nwadr_4;
                                                                calcObj.endIp     = calcObj.bcast_1 + '.' + calcObj.bcast_2 + '.' + calcObj.bcast_3 + '.' + calcObj.bcast_4;
                                                            }
                                                            
                                                            if (isPass && calcObj.startIp != $('#' + aimID + '-type-' + types + '-startIp').val() ) {
                                                                $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error"> match fail</span></label>');
                                                                $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                                isPass = false;
                                                                
                                                            }

                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-netmask').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-netmask"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                $('#' + aimID + '-type-' + types + '-netmask').focus();
                                                            isPass = false;
                                                        }
                                                    }
                                                    break;
                                                case 3:
                                                    calcObj.start = [];
                                                    calcObj.end = [];
                                                    if ($('#' + aimID + '-type-' + types + '-startIp').val() == $('#' + aimID + '-type-' + types + '-endIp').val()) {
                                                        $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                        if (isPass)
                                                            $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                        isPass = false;
                                                    }else {
                                                        if (regIpv4.test($('#' + aimID + '-type-' + types + '-startIp').val())) {
                                                            arr = $('#' + aimID + '-type-' + types + '-startIp').val().split(regDot);
                                                            for (var i=0, ilen=arr.length; i<ilen; i++)
                                                            {
                                                                switch (isNaN(arr[i]) || arr[i] > 255 || arr[i] < 0) 
                                                                {
                                                                case true:
                                                                    $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case false:
                                                                    calcObj.start.push( parseInt(arr[i]) );
                                                                    break;
                                                                }
                                                            }
                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-startIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-startIp"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-startIp').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (regIpv4.test($('#' + aimID + '-type-' + types + '-endIp').val())) {
                                                            arr = $('#' + aimID + '-type-' + types + '-endIp').val().split(regDot);
                                                            for (var i=0, ilen=arr.length; i<ilen; i++)
                                                            {
                                                                switch (isNaN(arr[i]) || arr[i] > 255 || arr[i] < 0) 
                                                                {
                                                                case true:
                                                                    $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                    isPass = false;
                                                                    break;
                                                                case false:
                                                                    calcObj.end.push( parseInt(arr[i]) );
                                                                    break;
                                                                }
                                                            }
                                                        }else {
                                                            $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                            if (isPass)
                                                                 $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                            isPass = false;
                                                        }
                                                        
                                                        if (isPass) {
                                                            if (calcObj.start[0] > calcObj.end[0]) {
                                                                $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                if (isPass)
                                                                    $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                    isPass = false;
                                                            }else if (calcObj.start[0]== calcObj.end[0]) {
                                                                if (calcObj.start[1] > calcObj.end[1]) {
                                                                    $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                    if (isPass)
                                                                        $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                        isPass = false;
                                                                }else if (calcObj.start[1] == calcObj.end[1]) {
                                                                    if (calcObj.start[2] > calcObj.end[2]) {
                                                                        $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                        if (isPass)
                                                                            $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                            isPass = false;
                                                                    }else if ( calcObj.start[2] == calcObj.end[2]) {
                                                                        if ( calcObj.start[3] > calcObj.end[3] ) {
                                                                            $('#' + aimID + '-type-' + types + '-endIp').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-endIp"><span class="error">range error</span></label>');
                                                                            if (isPass)
                                                                                $('#' + aimID + '-type-' + types + '-endIp').focus();
                                                                                isPass = false;
                                                                        }
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                    break;
                                                case 4:
                                                    if (!regMac.test($('#' + aimID + '-type-' + types + '-mac').val())) {
                                                        $('#' + aimID + '-type-' + types + '-mac').parents('td').append('<label class="errorLabel" for="address-type-' + types + '-mac"><span class="error">range error</span></label>');
                                                        if (isPass)
                                                             $('#' + aimID + '-type-' + types + '-mac').focus();
                                                        isPass = false;
                                                    }
                                                    break;
                                                }

                                                if (isPass) {

                                                    formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                    formObj.gid = "0";
                                                    formObj.userDefined = "1";
                                                    formObj.name = $('#address-name').val();
                                                    formObj.action = "0";
                                                    formObj.type = $('#' + aimID + '-type').val();
                                                    
                                                    switch(parseInt($('#' + aimID + '-type').val()))
                                                    {
                                                    case 1:
                                                        formObj.startIp = $('#' + aimID + '-type-' + types + '-startIp').val();
                                                        formObj.endIp = $('#' + aimID + '-type-' + types + '-startIp').val();
                                                        formObj.netmask = '255.255.255.255';
                                                        break;
                                                    case 2:
                                                        formObj.startIp = calcObj.startIp;
                                                        formObj.endIp = calcObj.endIp;
                                                        formObj.netmask = $('#' + aimID + '-type-' + types + '-netmask').val();
                                                        break;
                                                    case 3:
                                                        formObj.startIp = $('#' + aimID + '-type-' + types + '-startIp').val();
                                                        formObj.endIp = $('#' + aimID + '-type-' + types + '-endIp').val();
                                                        break;
                                                    case 4:
                                                        formObj.mac = $('#' + aimID + '-type-' + types + '-mac').val();
                                                        break;
                                                    }
                                                    
                                                    jsonObj = yui3.JSON.stringify(formObj);
                                                    
                                                    checkObj = {};
                                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                        
                                                    });
                                                    // supposed to be here, but temporary move out 
                                                        // need to update gid after callback
                                                        //checkObj.gid = data.gid;
                                                    checkObj.gid = e.timeStamp;
                                                    tmp = '<option value="' + checkObj.gid + '">' + formObj.name + '</opiont>';
                                                    
                                                    cgiList.common_addr_list.guiAddrTNum++;
                                                    cgiList.common_addr_list.guiMacTNum++;
                                                    cgiList.common_addr_list.guiAddrT.push({"gid": checkObj.gid, "name": formObj.name, "userDefined": "1", "type": formObj.type, "startIp": formObj.startIp, "endIp": formObj.endIp, "netmask": formObj.netmask, "mac": formObj.mac} );
                                                    
                                                    $('#' + sID).append(tmp).val(checkObj.gid).trigger('change');
                                                    switch(sID)
                                                    {
                                                    case 'sourceAddress':
                                                        $('#destinationAddress').append(tmp);
                                                        break;
                                                    case 'destinationAddress':
                                                        $('#sourceAddress').append(tmp);
                                                        break;
                                                    default:
                                                         
                                                    }
                                                    
                                                    $( this ).dialog( "close" );
                                                    
                                                }
                                            },
                                            Cancel: function() {
                                                $( this ).dialog( "close" );
                                            }
                                        },
                                        close: function(event, ui) {
                                            $(this).dialog('destroy').remove();
                                        }
                                     
                                    });
                                    console.log( pID + ' @ ' + sID );
                                    switch(pID)
                                    {
                                    case 'ipsec_policies':
                                        $('#' + aimID + '-type').append( genSelectOption('addressType3') ).val(1).trigger('change');
                                        break;
                                    default:
                                        $('#' + aimID + '-type').append( genSelectOption('addressType2') ).val(1).trigger('change');
                                    }
                                    
                                });
                                break;
                            case 'cGAddr':
                                $('#extra').empty();
                                cgiGetID = 'common_gAddr_list';
                                cgiPostID = 'common_updateGAddr';
                                cgiT = 'guiGAddrT';
                                cgiTNum = 'guiGAddrTNum';
                                aimID = 'group_address';
                                $('#extra').load('forms/group_address.html .extraForm', function() {
                                    $('.extraForm').dialog({
                                        width: 600,
                                        height:600,
                                        position: "center",
                                        resizable: false,
                                        modal: true,
                                        buttons: {
                                            OK: function() {
                                                isPass = false;
                                                $('.errorLabel').remove();
                                                if ($('#' + aimID + '-name').val().length > 0) {
                                                    isPass = true;                                                        
                                                }else {
                                                    isPass = false;
                                                    $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="group_address-name"><span class="error">name required</span></label>');
                                                    $('#' + aimID + '-name').focus();
                                                }
                                                var arr = [];
                                                $('#' + aimID + '-idList option').each(function() {
                                                    arr.push($(this).val());
                                                });
                                                
                                                if (isPass) {
                                                    formObj = $.extend({}, cgiRef.tmpl[ aimID ]);//cgiRef.tmpl[ aimID ];
                                                    formObj.gid = "0";
                                                    formObj.name = $('#' + aimID + '-name').val();
                                                    formObj.userDefined = "1";
                                                    formObj.num = arr.length;
                                                    formObj.idList = arr.join(';');
                                                    formObj.action = "0";
                                                    
                                                    checkObj = {};
                                                    jsonObj = yui3.JSON.stringify(formObj);
                                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(){
                                                        
                                                    });
                                                    checkObj.gid = e.timeStamp;
                                                    cgiList.common_gAddr_list.guiGAddrTNum++;
                                                    cgiList.common_gAddr_list.guiGAddrT.push({"gid": checkObj.gid, "name": formObj.name, "userDefined": "1", "num": formObj.num, "idList": formObj.idList} );
                                                    tmp = '<option value="' + checkObj.gid + '">' + formObj.name + '</opiont>';
                                                    $('#' + sID).append(tmp).val(checkObj.gid).trigger('change');
                                                    switch(sID)
                                                    {
                                                    case 'sourceAddress':
                                                        $('#destinationAddress').append(tmp);
                                                        break;
                                                    case 'destinationAddress':
                                                        $('#sourceAddress').append(tmp);
                                                        break;
                                                    default:
                                                        
                                                         
                                                    }
                                                    
                                                    $( this ).dialog( "close" );
                                                    
                                                }
                                            },
                                            Cancel: function() {
                                                $( this ).dialog( "close" );
                                            }
                                        },
                                        close: function(event, ui) {
                                            $(this).dialog('destroy').remove();
                                        }
                                    });
                                    
                                    var tmp = "";                                
                                    for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++)
                                        tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[i].gid + '">' + cgiList.common_addr_list.guiAddrT[i].name + '</option>';
                                    $('#group_address-idListPool').append(tmp);
                                });
                                break;
                            case 'cService':
                                $('#extra').empty();
                                    
                                cgiGetID = 'common_service_list';
                                cgiPostID = 'common_updateService';
                                cgiT = 'guiServiceT';
                                cgiTNum = 'guiServiceTNum';
                                aimID = 'service';
                                $('#extra').load('forms/service.html .extraForm', function() {    
                                    $('.extraForm').dialog({
                                        width: 600,
                                        height:600,
                                        position: "center",
                                        resizable: false,
                                        modal: true,
                                        buttons: {
                                            OK: function() {
                                                isPass = true;
                                                $('.errorLabel').remove();
                                                if ($('#service-name').val().length == 0) {
                                                    isPass = false;
                                                    $('#service-name').parents('td').append('<label class="errorLabel" for="service-name"><span class="error">name required</span></label>');
                                                    $('#service-name').focus();
                                                }
                                                
                                                var types = parseInt($('#service-type option:selected').val());
                                                var param;
                                                switch(types)
                                                {
                                                case 0:
                                                case 1:
                                                case 2:
                                                    param = parseInt($('#service-type-' + types + '-param1').val());
                                                    if ( param < 1 || param > 65535 || isNaN(param)) {
                                                        $('#service-type-' + types + '-param1').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param1"><span class="error">range error</span></label>');
                                                        if (isPass)
                                                            $('#service-type-' + types + '-parma1').focus();
                                                        isPass = false;
                                                    }
                                                    param = parseInt($('#service-type-' + types + '-param2').val());
                                                    if ( param < 1 || param > 65535 || isNaN(param)) {
                                                        $('#service-type-' + types + '-param2').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param2"><span class="error">range error</span></label>');
                                                        if (isPass)
                                                            $('#service-type-' + types + '-parma2').focus();
                                                        isPass = false;
                                                    }
                                                    break;
                                                case 3:
                                                case 4:
                                                    param = parseInt($('#service-type-' + types + '-param1').val());
                                                    if ( param < 1 || param > 255 || isNaN(param)) {
                                                        $('#service-type-' + types + '-param1').parents('td').append('<label class="errorLabel" for="service-type-' + types + '-param1"><span class="error">range error</span></label>');
                                                        if (isPass)
                                                            $('#service-type-' + types + '-parma1').focus();
                                                        isPass = false;
                                                    }
                                                    break;
                                                }
                                
                                                if (isPass) {

                                                    formObj = $.extend({}, cgiRef.tmpl[ cgiPostID ]);
                                                    
                                                    formObj.gid = "0";
                                                    
                                                    formObj.userDefined = "1";

                                                    formObj.name = $('#' + aimID + '-name').val();
                                                    
                                                    formObj.type = $('#' + aimID + '-type option:selected').val();
                                                    
                                                    formObj.param1 = $('#' + aimID + '-type-' + types + '-param1').val();
                                                    
                                                    formObj.param2 = ( types < 3 )? $('#' + aimID + '-type-' + types + '-param2').val() : "0";
                                                    
                                                    formObj.action    = "0";                                                        
                                                    
                                                    jsonObj = yui3.JSON.stringify(formObj);
                                                                                                        
                                                    checkObj = {};
                                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(data) {
                                                        // supposed to be here, but temporary move out 
                                                        // need to update gid after callback
                                                        //checkObj.gid = data.gid;
                                                    });    
                                                    checkObj.gid = e.timeStamp;
                                                    cgiList.common_service_list.guiServiceTNum++;
                                                    cgiList.common_service_list.guiServiceT.push({"gid": checkObj.gid, "name": formObj.name, "type": formObj.type, "userDefined": "1", "param1": formObj.param1, "param2": formObj.param2} );
                                                    
                                                    tmp = '<option value="' + checkObj.gid + '">' + formObj.name + '</opiont>';
                                                    $('#' + sID).append(tmp).val(checkObj.gid).trigger('change');
                                                    cgiTypes[ checkObj.gid ] = formObj.type;
                                                    switch( sID )
                                                    {
                                                    case 'port_forwarding-originalService':
                                                        $('#port_forwarding-translatedService').append(tmp);
                                                        break;
                                                    case 'port_forwarding-translatedService':
                                                        $('#port_forwarding-originalService').append(tmp);
                                                        break;
                                                    default:
                                                    }
                                                    
                                                    
                                                    /* should be move insiide callback */
                                                                                                            
                                                    $( this ).dialog( "close" );
                                                    
                                                    /* ---- */
                                                }
                                            },
                                            Cancel: function() {
                                                $( this ).dialog( "close" );
                                            }
                                        },
                                        close: function(event, ui) {
                                            $(this).dialog('destroy').remove();
                                        }
                                        
                                    });
                                    $('#' + aimID + '-type').val(0).trigger('change');
                                });
                                    

                                break;
                            case 'cGService':
                                $('#extra').empty();
                                
                                cgiGetID = 'common_gService_list';
                                cgiPostID = 'common_updateGService';
                                cgiT = 'guiGServiceT';
                                cgiTNum = 'guiGServiceTNum';
                                aimID = 'group_service';
                                $('#extra').load('forms/group_service.html .extraForm', function() {
                                    $('.extraForm').dialog({
                                        width: 600,
                                        height:600,
                                        position: "center",
                                        resizable: false,
                                        modal: true,
                                        buttons: {
                                            OK: function() {
                                                isPass = false;
                                                $('.errorLabel').remove();
                                                if ($('#' + aimID + '-name').val().length > 0) {
                                                    isPass = true;                                                        
                                                }else {
                                                    isPass = false;
                                                    $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="group_service-name"><span class="error">name required</span></label>');
                                                    $('#' + aimID + '-name').focus();
                                                }
                                                var arr = [];
                                                $('#' + aimID + '-idList option').each(function() {
                                                    arr.push($(this).val());
                                                });
                                                
                                                if (isPass) {
                                                    formObj = $.extend({}, cgiRef.tmpl[ aimID ]);
                                                    formObj.gid = "0";
                                                    formObj.userDefined = "1";
                                                    formObj.name = $('#' + aimID + '-name').val();
                                                    formObj.num = arr.length;
                                                    formObj.idList = arr.join(';');
                                                    formObj.action = "0";
                                                    
                                                    checkObj = {};
                                                    jsonObj = yui3.JSON.stringify(formObj);
                                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(){
                                                        
                                                    });
                                                    checkObj.gid = e.timeStamp;
                                                    cgiList.common_gService_list.guiGServiceTNum++;
                                                    cgiList.common_gService_list.guiGServiceT.push({"gid": checkObj.gid, "name": formObj.name, "userDefined": "1", "num": formObj.num, "idList": formObj.idList} );
                                                    tmp = '<option value="' + checkObj.gid + '">' + formObj.name + '</opiont>';
                                                    $('#' + sID).append(tmp).val(checkObj.gid).trigger('change');
                                                    

                                                    $( this ).dialog( "close" );
                                                }
                                            },
                                            Cancel: function() {
                                                $( this ).dialog( "close" );
                                            }
                                        },
                                        close: function(event, ui) {
                                            $(this).dialog('destroy').remove();
                                        }
                                    });
                                    
                                    tmp = "";                                
                                    for (var i=0; i < parseInt(cgiList.common_service_list.guiServiceTNum); i++)
                                        tmp += '<option value="' + cgiList.common_service_list.guiServiceT[i].gid + '">' + cgiList.common_service_list.guiServiceT[i].name + '</option>';
                                    $('#' + aimID + '-idListPool').append(tmp);
                                });
                                break;
                            case 'cSchedule':
                                $('#extra').empty();
                                cgiGetID = 'common_time_list';
                                cgiPostID = 'common_updateTime';
                                cgiT = 'guiTimeT';
                                cgiTNum = 'guiTimeTNum';
                                aimID = 'schedule';
                                $('#extra').load('forms/schedule.html .extraForm', function() {
                                    $('.extraForm').dialog({
                                        width: 600,
                                        height:600,
                                        position: "center",
                                        resizable: false,
                                        modal: true,
                                        buttons: {
                                            OK: function() {
                                                isPass = false;
                                                $('.errorLabel').remove();
                                                if ($('#' + aimID + '-name').val().length > 0) {
                                                    isPass = true;
                                                    formObj = dataObj[ aimID ];
                                                }else {
                                                    isPass = false;
                                                    $('#' + aimID + '-name').parents('td').append('<label class="errorLabel" for="' + aimID +'-name"><span class="error">name required</span></label>');
                                                    $('#' + aimID + '-name').focus();
                                                }
    
                                                switch(isPass)
                                                {
                                                case true:
                                                    formObj = $.extend({}, cgiRef.tmpl[ aimID ]);//cgiRef.tmpl[ aimID ];
                                                    
                                                    for (var node in formObj)
                                                    {
                                                        switch(node)
                                                        {
                                                        case 'name':
                                                            formObj[ node ] = $('#' + aimID + '-name').val();
                                                            break;
                                                        case 'gid':
                                                            formObj[ node ] = "0";
                                                            break;
                                                        case 'userDefined':
                                                            formObj[ node ] = "1";
                                                            break;
                                                        case 'action':
                                                            formObj[ node ] = "0";
                                                            break;
                                                        case 'name':
                                                            formObj[ node ] = $('#names').val();
                                                            break;
                                                        case 'type':
                                                            switch($('#days option:selected').val())
                                                            {
                                                            case "0":
                                                                switch($('#times option:selected').val())
                                                                {
                                                                case "0":
                                                                    formObj[ node ] = "1";
                                                                    break;
                                                                case "1":
                                                                    formObj[ node ]= "2";
                                                                    break;
                                                                }
                                                                break;
                                                            case "1":
                                                                switch($('#times option:selected').val())
                                                                {
                                                                case "0":
                                                                    formObj[ node ] = "3";
                                                                    break;
                                                                case "1":
                                                                    formObj[ node ]= "4";
                                                                    break;
                                                                }
                                                                break;
                                                            }
                                                            
                                                            break;
                                                        case 'day':
                                                            formObj[ node ] = 0;
                                                            for (var x in cgiRef[ aimID ].days)
                                                            {
                                                                switch($('#'+ cgiRef[ aimID ].days[ x ] ).is(':checked'))
                                                                {
                                                                case true:
                                                                
                                                                    formObj[ node ]+= parseInt( $('#' + cgiRef[ aimID ].days[ x ] ).val() );
                                                                    break;
                                                                }
                                                            }
                                                            break;
                                                        default:
                                                            formObj[ node ] = $('#' + node).val();
                                                        }
                                                    }
                                                    
                                                    checkObj = {};
                                                    jsonObj = yui3.JSON.stringify(formObj);
                                                    $.post('cgi-bin/' + cgiPostID + '.cgi', jsonObj, function(){
                                                        
                                                    });
                                                    checkObj.gid = e.timeStamp;
                                                    cgiList.common_time_list.guiTimeTNum++;
                                                    cgiList.common_time_list.guiTimeT.push({"gid": checkObj.gid, "name": formObj.name, "type": formObj.type, "userDefined": "1", "day": formObj.day, "startHour": formObj.startHour, "startMin": formObj.startMin, "endHour": formObj.endHour, "endMin": formObj.endMin} );
                                                    tmp = '<option value="' + checkObj.gid + '">' + formObj.name + '</opiont>';
                                                    $('#' + sID).append(tmp).val(checkObj.gid).trigger('change');
                                                    
                                                    
                                                    $( this ).dialog( "close" );
                                                    break;
                                                }
                                            },
                                            Cancel: function() {
                                                $( this ).dialog( "close" );
                                            }
                                        },
                                        close: function(event, ui) {
                                            $(this).dialog('destroy').remove();
                                        }
                                     
                                    });
                                    
                                    $('#days').val(0).trigger('change');
                                    $('#times').val(0).trigger('change');
                                    
                                    $('#startHour').append( genSelectOption('startHour') );
                                    $('#startMin').append( genSelectOption('startMin') );
                                    $('#endHour').append( genSelectOption('endHour') );
                                    $('#endMin').append( genSelectOption('endMin') );
                                });
                                break;
                         
                            default:
                                switch(sID)
                                {
                                case 'ipsec_policies-remoteGwType':
                                
                                    var relClass = '.' + sID; 
                                    switch(oVal)
                                    {
                                    case '0':
                                        $(relClass).prop('disabled', true);
                                        break;
                                    default:
                                        $(relClass).prop('disabled', false);
                                    }
                                    break;
                                case 'advanced_nat-originalSrc':
                                case 'advanced_nat-originalDst':
                                case 'advanced_nat-translatedSrc':
                                case 'advanced_nat-translatedDst':
                                console.log( sID + ' @ ' + oVal);
                                    break;
                                case 'group_service-idList':
                                
                                    $('#serviceName').html("");
                                    $('#serviceProtocol').html("");
                                    $('#serviceValue').html("");
                                    if (!dataObj.service)
                                        dataObj.service = cgiList.common_service_list;
                                    for (var i=0, ilen=parseInt(dataObj.service.guiServiceTNum); i<ilen; i++)
                                    {
                                        switch(parseInt($('#' + sID + ' option:selected').val()) == parseInt(dataObj.service.guiServiceT[ i ].gid))
                                        {
                                        case true:
                                            $('#serviceName').html(dataObj.service.guiServiceT[ i ].name);
                                            $('#serviceProtocol').html( cgiRef.service.type[ dataObj.service.guiServiceT[ i ].type ] );
                                            
                                            switch( parseInt( dataObj.service.guiServiceT[ i ].type ) )
                                            {
                                            case 0:
                                            case 1:
                                            case 2:
                                                $('#serviceValue').html( dataObj.service.guiServiceT[ i ].param1 + '-' + dataObj.service.guiServiceT[ i ].param2);
                                                break;
                                            case 3:
                                            case 4:
                                                $('#serviceValue').html( dataObj.service.guiServiceT[ i ].param1);
                                                break;
                                            }
                                            
                                            break;
                                        }
                                    }
                                    break;
                                case 'group_service-idListPool':
                                    $('#serviceName').html("");
                                    $('#serviceProtocol').html("");
                                    $('#serviceValue').html("");
                                    if (!dataObj.service)
                                        dataObj.service = cgiList.common_service_list;
                                    for (var i=0, ilen=parseInt(dataObj.service.guiServiceTNum); i<ilen; i++)
                                    {
                                        switch(parseInt($('#' + sID + ' option:selected').val()) == parseInt(dataObj.service.guiServiceT[ i ].gid))
                                        {
                                        case true:
                                            $('#serviceName').html(dataObj.service.guiServiceT[ i ].name);
                                            $('#serviceProtocol').html( cgiRef.service.type[ dataObj.service.guiServiceT[ i ].type ] );
                                            
                                            switch( parseInt( dataObj.service.guiServiceT[ i ].type ) )
                                            {
                                            case 0:
                                            case 1:
                                            case 2:
                                                $('#serviceValue').html( dataObj.service.guiServiceT[ i ].param1 + '-' + dataObj.service.guiServiceT[ i ].param2);
                                                break;
                                            case 3:
                                            case 4:
                                                $('#serviceValue').html( dataObj.service.guiServiceT[ i ].param1);
                                                break;
                                            }
                                            
                                            break;
                                        }
                                    }
                                    break;
                                case 'group_address-idList':
                                
                                    $('#addressName').html("");
                                    $('#addressType').html("");
                                    $('#addressValue').html("");
                                    
                                    if (dataObj.address) {
                                    
                                        for (var i=0, ilen=parseInt(dataObj.address.guiAddrTNum); i<ilen; i++)
                                        {
                                            switch(parseInt($('#' + sID + ' option:selected').val()) == parseInt(dataObj.address.guiAddrT[ i ].gid))
                                            {
                                            case true:
                                                $('#addressName').html(dataObj.address.guiAddrT[ i ].name);
                                                $('#addressType').html( cgiRef.address.type[ dataObj.address.guiAddrT[ i ].type ] );
                                                
                                                
                                                switch( parseInt( dataObj.address.guiAddrT[ i ].type ) )
                                                {
                                                case 1:
                                                    $('#addressValue').html( dataObj.address.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                                    break;
                                                case 2:
                                                    $('#addressValue').html( dataObj.address.guiAddrT[ i ].startIp + '/' + dataObj.address.guiAddrT[ i ].netmask );
                                                    break;
                                                case 3:
                                                    $('#addressValue').html( dataObj.address.guiAddrT[ i ].startIp + '-' + dataObj.address.guiAddrT[ i ].endIp );
                                                    break;
                                                case 4:
                                                    $('#addressValue').html( dataObj.address.guiAddrT[ i ].mac);
                                                    break;
                                                }
                                                break;
                                            }
                                        }
                                    }else {
                                        for (var i=0, ilen=parseInt(cgiList.common_addr_list.guiAddrTNum); i<ilen; i++)
                                        {
                                            switch(parseInt($('#' + sID + ' option:selected').val()) == parseInt(cgiList.common_addr_list.guiAddrT[ i ].gid))
                                            {
                                            case true:
                                                $('#addressName').html( cgiList.common_addr_list.guiAddrT[ i ].name);
                                                $('#addressType').html( cgiRef.address.type[ cgiList.common_addr_list.guiAddrT[ i ].type ] );
                                                
                                                
                                                switch( parseInt( cgiList.common_addr_list.guiAddrT[ i ].type ) )
                                                {
                                                case 1:
                                                    $('#addressValue').html( cgiList.common_addr_list.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                                    break;
                                                case 2:
                                                    $('#addressValue').html( cgiList.common_addr_list.guiAddrT[ i ].startIp + '/' + cgiList.common_addr_list.guiAddrT[ i ].netmask );
                                                    break;
                                                case 3:
                                                    $('#addressValue').html( cgiList.common_addr_list.guiAddrT[ i ].startIp + '-' + cgiList.common_addr_list.guiAddrT[ i ].endIp );
                                                    break;
                                                case 4:
                                                    $('#addressValue').html( cgiList.common_addr_list.guiAddrT[ i ].mac);
                                                    break;
                                                }
                                                break;
                                            }
                                        }
                                    }
                                    break;
                                case 'group_address-idListPool':
                                    $('#addressName').html("");
                                    $('#addressType').html("");
                                    $('#addressValue').html("");
                                    
                                    if (dataObj.address) {
                                    
                                        for (var i=0, ilen=parseInt(dataObj.address.guiAddrTNum); i<ilen; i++)
                                        {
                                            switch(parseInt($('#' + sID + ' option:selected').val()) == parseInt(dataObj.address.guiAddrT[ i ].gid))
                                            {
                                            case true:
                                                $('#addressName').html( dataObj.address.guiAddrT[ i ].name);
                                                $('#addressType').html( cgiRef.address.type[ dataObj.address.guiAddrT[ i ].type ] );
                                                
                                                switch( parseInt( dataObj.address.guiAddrT[ i ].type ) )
                                                {
                                                case 1:
                                                    $('#addressValue').html( dataObj.address.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                                    break;
                                                case 2:
                                                    $('#addressValue').html( dataObj.address.guiAddrT[ i ].startIp + '/' + dataObj.address.guiAddrT[ i ].netmask );
                                                    break;
                                                case 3:
                                                    $('#addressValue').html( dataObj.address.guiAddrT[ i ].startIp + '-' + dataObj.address.guiAddrT[ i ].endIp );
                                                    break;
                                                case 4:
                                                    $('#addressValue').html( dataObj.address.guiAddrT[ i ].mac);
                                                    break;
                                                }
                                                
                                                break;
                                            }
                                        }
                                        
                                    }else {
                                        for (var i=0, ilen=parseInt(cgiList.common_addr_list.guiAddrTNum); i<ilen; i++)
                                        {
                                            switch(parseInt($('#' + sID + ' option:selected').val()) == parseInt(cgiList.common_addr_list.guiAddrT[ i ].gid))
                                            {
                                            case true:
                                                $('#addressName').html( cgiList.common_addr_list.guiAddrT[ i ].name );
                                                $('#addressType').html( cgiRef.address.type[ cgiList.common_addr_list.guiAddrT[ i ].type ] );
                                                
                                                
                                                switch( parseInt( cgiList.common_addr_list.guiAddrT[ i ].type ) )
                                                {
                                                case 1:
                                                    $('#addressValue').html( cgiList.common_addr_list.guiAddrT[ i ].startIp + '/255.255.255.255' );
                                                    break;
                                                case 2:
                                                    $('#addressValue').html( cgiList.common_addr_list.guiAddrT[ i ].startIp + '/' + cgiList.common_addr_list.guiAddrT[ i ].netmask );
                                                    break;
                                                case 3:
                                                    $('#addressValue').html( cgiList.common_addr_list.guiAddrT[ i ].startIp + '-' + cgiList.common_addr_list.guiAddrT[ i ].endIp );
                                                    break;
                                                case 4:
                                                    $('#addressValue').html( cgiList.common_addr_list.guiAddrT[ i ].mac);
                                                    break;
                                                }
                                                break;
                                            }
                                        } 
                                    }
                                    break;
                                case 'ports-speed':
                                    switch( parseInt( $(this).val() ) )
                                    {
                                    case 0:
                                    case 1000:
                                        $('#ports-duplex').val(0).prop('disabled', true);
                                        break;
                                    default:
                                        $('#ports-duplex').prop('disabled', false);
                                    }
                                    break;
                                case 'port_forwarding-wan':
                                    var relClass = '.' + sID; 
                                    switch( parseInt( oVal ) )
                                    {
                                    case 0:
                                        $(relClass).hide();
                                        break;
                                    default:
                                        cgiRecallSelectOption('port_forwarding-wanIpId');
                                        $(relClass).show();
                                    }
                                    break;
                                case 'static_nat-wanInterface':
                                    cgiComboSelectOption('static_nat-publicIp');
                                    cgiComboSelectOption('static_nat-privateIp');
                                    break;
                                // for passing
                                case 'tzName':
                                    if (cgiRef.systime.dstEnable.indexOf( $(this).val() ) != -1 ) {
                                        $('#dstEnable').prop('disabled', true);
                                    }else {
                                        if ( $('#mode-1').is(':checked') )
                                            $('#dstEnable').prop('disabled', false);
                                        else 
                                            $('#dstEnable').prop('disabled', true);
                                    }
                                    break;
                                case 'address-type':
                                    switch(selID)
                                    {
                                    case 'ipsec_policies':
                                        $('.' + sID + '-3').hide();
                                    case 'advanced_nat':
                                    case 'sourceAddress':
                                    case 'destinationAddress':
                                    case 'rules':
                                        $('.' + sID + '-4').hide();
                                        $(this).find('option').each(function() {
                                            var relClass = '.' + sID + '-' + $(this).val();
                                            
                                            switch($(this).val() == oVal)
                                            {
                                            case true:
                                                $(relClass).show();
                                                break;
                                            case false:
                                                $(relClass).hide();
                                                break;
                                            }
                                        });
                                        break;
                                    default:
                                        $(this).find('option').each(function() {
                                            var relClass = '.' + sID + '-' + $(this).val();
                                            
                                            switch($(this).val() == oVal)
                                            {
                                            case true:
                                                $(relClass).show();
                                                break;
                                            case false:
                                                $(relClass).hide();
                                                break;
                                            }
                                        });
                                    }
                                    break;
                                default:
                                    $(this).find('option').each(function() {
                                        var relClass = '.' + sID + '-' + $(this).val();
                                        
                                        switch($(this).val() == oVal)
                                        {
                                        case true:
                                            $(relClass).show();
                                            break;
                                        case false:
                                            $(relClass).hide();
                                            break;
                                        }
                                    });

                                }
                            }
                        });
                        /* input checkbox click */
                        $('input:checkbox').live('click', function(e) {
                            var pID = $(this).parents('.Confirm').attr('id');
                            var cID = $(this).attr('id');
                            var relClass = '.' + cID + '-checked';
                            switch(pID)
                            {
                            case 'div-general_settings':
                                switch(cID)
                                {
                                case 'enable':
                                    switch($(this).is(':checked') && dataObj.general_settings.licensed == "1")
                                    {
                                    case true:
                                        $(relClass + ' input').prop('disabled', false);
                                        $(relClass + ' select').prop('disabled', false);
                                        $(relClass + ' textarea').prop('disabled', false);
                                        $(relClass + ' button').prop('disabled', false);
                                        break;
                                    case false:
                                        $(relClass + ' input').prop('disabled', true);
                                        $(relClass + ' select').prop('disabled', true);
                                        $(relClass + ' textarea').prop('disabled', true);
                                        $(relClass + ' button').prop('disabled', true);
                                        break;
                                    }
                                    break;
                                }
                                break;
                            default:
                            console.log(relClass + ' @ ' + $(relClass).length  + ' @ ' + $(this).is(':checked'));
                                switch($(relClass).length > 0)
                                {
                                case true:
                                    switch($(this).is(':checked'))
                                    {
                                    case true:
                                        $(relClass).prop('disabled', false);
                                        $(relClass).each(function() {
                                            switch($(this).attr('type'))
                                            {
                                            case 'radio':
                                                switch($(this).is(':checked'))
                                                {
                                                case false:
                                                    $('.' + $(this).attr('name') + '-' + $(this).val()).prop('disabled', true);
                                                    break;
                                                }
                                                break;
                                            }
                                        });
                                        
                                        break;
                                    case false:
                                        $(relClass).prop('disabled', true);
                                        break;
                                    }

                                }
                                
                            }
                        });

                        /* input radio click */
                        $('input:radio').live('click', function(e) {
                            var pID = $(this).parents('table').attr('id');
                            var rID = $(this).attr('id');
                            var rName = $(this).attr('name');
                            $('input[name=' + rName + ']').each(function() {
                                var relVal     = $(this).attr('value');
                                var relClass = '.' + rName + '-' + relVal;
                                var relInput = '.' + rName + '-' + relVal + ' input';
                                var relSelect = '.' + rName + '-' + relVal + ' select';
                                switch($(this).is(':checked'))
                                {
                                case true:
                                    //$(relClass).show();
                                    $(relClass).prop('disabled', false);
                                    $(relInput).prop('disabled', false); 
                                    $(relSelect).prop('disabled', false); 
                                    
                                    $(relClass).each(function() {
                                        switch($(this).attr('type'))
                                        {
                                        case 'radio':
                                            switch($(this).is(':checked'))
                                            {
                                            case false:
                                                $('.' + $(this).attr('name') + '-' + $(this).val()).prop('disabled', true);
                                                break;
                                            }
                                            break;
                                        case 'checkbox':
                                            if (pID == 'table-time_settings') {
                                                if ( rID == 'mode-0' )
                                                    $('#dstEnable').prop('disabled', true);
                                                else {
                                                    if (cgiRef.systime.dstEnable.indexOf( $('#tzName').val() ) != -1)
                                                        $('#dstEnable').prop('disabled', true);
                                                    else
                                                        $('#dstEnable').prop('disabled', false);
                                                }
                                            }
                                            break;
                                        }
                                    });
                                    break;
                                case false:
                                    //$(relClass).hide(); 
                                    $(relClass).prop('disabled', true);
                                    $(relInput).prop('disabled', true); 
                                    $(relSelect).prop('disabled', true); 
                                    break;
                                }
                            });
                        });

                        /* achor click, for menu & accordions */
                        $('a').live('click', function(e) {
                            e.preventDefault();
                        });
                        /* img click, for dashboard */
                        $('img').live('click', function(e) {
                            e.preventDefault();
                            var iID = $(this).attr('id');
                            var iClass = $(this).attr('class');
                            switch(iClass)
                            {
                            case 'time_settings':
                            
                                break;
                            case 'Link':
                                var arr = iID.split(regDash);
                                switch(arr.length)
                                {
                                case 2:
                                    $('#' + arr[1] + ' h4').click();
                                    break;
                                case 3:
                                    $('#' + arr[2] + ' h5').click();
                                    break;
                                }
                                break;
                            case 'Close':
                                $(this).parents('div.accordions').hide();
                                break;
                            }
                        });

                        // trigger system_dashboard as default
                        $('#system_dashboard h4').click();
                    }, error:function(error) {}}).done(function() {
                        // check routing 
                        $.ajax({url: 'cgi-bin/routing.cgi', dataType: 'json', success: function(data) {
                            cgiRef.routing = data;
                            console.log(cgiRef.routing);
                        }});
                    });
                
                });

                $('#ft').load('templates/ft.html .content', function() {

                });
    
                // trigger timer
                timerStart();
                getVisitor();
                launchYUI();
            });
        });
    });
}

function loadTemplate(id, template) {
    /* clear template & data before */
    $('#board').empty();
    $('#dialog').empty();
    $('#extra').empty();
    cgiRefreshStop();
    dataObj     = {};
    cgiList     = {};
    cgiHash     = {};
    cgiGids     = {};
    cgiTypes    = {};
    cgiIpAlias  = [];
    // get needed cgi common list
    console.log('load ' + id );
    getCgiRef(id);
    $('#board').load(template + ' #template-' + id, function() {
    // list of cases, ordered by xmind tabs & nodes
        $('#template-'+id+' div.accordions').accordion({collapsible: true,autoHeight: false });
        tmplTabs = $('.tabs').tabs().css({'width': '760px', 'height': '540px'});
        switch(id)
        {
        // dahsboard
        case 'system_dashboard':
            genList('system_information');
            genChart('resource_utilizations');
            genList('site_to_site_vpns');
            genTable('recent_system_logs');
            genTable('physical_ports');
            genTable('wan_interface');
            genTable('lan_interface');
            break;
        case 'network_dashboard':
            genTable('top_traffic_direction');
            genTable('top_source');
            genTable('top_destination');
            break;
        case 'security_dashboard':
            genTable('top_file_extension');
            genTable('top_affected_host');
            genTable('top_virus_name');
            genTable('top_blocked_host');
            break;
        // reports
        case 'show_arp_table':
            genTable(id);
            break;
        case 'show_routing_table':
            genTable(id);
            break;
        case 'dhcp_bindings':
            genTable(id);
        
            break;
        case 'status_summary':
            genTable('port');
            genTable('vlan');
            genTable('wan');
            genTable('lan');
            break;
        case 'traffic_statistics':
            cgiCombo(id);
            break;
        case 'wan_bandwidth_report':
            genChart('wan1');
            break;
        case 'process':
            cgiTable(id);
            break;
        case 'resource_utilization':
            genChart('cpu_utilization');
            break;
        case 'nat_status':
            cgiTable(id);
            break;
        case 'active_users':
            genTable(id);
            break;
        case 'active_sessions':
            cgiTable(id);
        break;
        case 'ipsec_vpn_statistics':
            cgiTable(id);
        break;
        case 'traffic_direction':
            genTable(id);
        
            break;
        case 'source':
            genTable(id);
        
            break;
        case 'destination':
            genTable(id);
        
            break;
        case 'file_extension':
            genTable(id);
        
            break;
        case 'blocked_host':
            genTable(id);
        
            break;
        case 'affected_host':
            genTable(id);
        
            break;
        case 'antivirus_report': 
            genTable(id);
        
            break;
        // interface
        case 'ports':
            cgiTable(id);
            break;
        case 'vlan_interfaces':
            cgiTable(id);
            break;
        case 'lan':
            cgiTable(id);
            break;
        case 'wan':
            cgiTable(id);
            cgiForm('multiwan');
            break;
        case 'zone':
            cgiTable(id);
            break;
        // networking
        case 'routing':
            cgiForm(id);
            break;
        case 'ipsec_policies':
            cgiTable(id);
            break;
        case 'ike_policy':
            cgiTable(id);
            break;
        case 'transform_policy':
            cgiTable(id);
            break;
        // firewall
        case 'rules':
            cgiCombo(id);
            break;
        case 'dynamic_pat':
            cgiCombo(id);
            break;
        case 'static_nat':
            cgiTable(id);
            break;
        case 'port_forwarding':
            cgiTable(id);
    
            break;
        case 'port_trigger':
            genTable(id);
        
            break;
        case 'advanced_nat':
            cgiTable(id);
            break;
        // security
        case 'antivirus':
            cgiTable('address_exceptions');
            cgiForm('http_notification');
            cgiForm('email_notification');
            cgiCombo('file_extensions');
            cgiForm('signature');
            cgiForm('general_settings');
            break;
        // users
        case 'users_and_groups':
            cgiCombo(id);
        break;
        // device
        case 'administrator_settings':
            cgiForm(id);
            break;
        case 'management_interface_settings':
            genTable(id);
            break;
        case 'properties':
            genForm(id);
            break;
        case 'date_and_time':
            cgiForm(id);
        break;
        case 'loggings':
            genTable('view_logs');
            genTable('logs_facility');
            break;
        case 'address':
            cgiCombo(id);
            break;
        case 'service':
            cgiCombo(id);
            break;
        case 'schedule':
            cgiTable(id);
            break;
        case 'license':
            genList('base_license');
            genList('antivirus');
            genList('support_service');
            break;
        default: 
    
        }
    
        $('.Confirm').each(function() {
            var divID = $(this).attr('id').replace('div-', '');
            $(this).append('<div class="formAction" role="button" ><button id="Save-'+ divID + '" class="Save">Save</button><button id="Cancel-' + divID + '" class="Cancel">Cancel</button></div>');
        });
    /* query listener */
        $('.query-start').datepicker({
            minDate: -30,
            maxDate: 0,
            onSelect: function( selectedDate ) {
                $('.query-end').datepicker( "option", "minDate", selectedDate);
            }
        });
        $('.query-end').datepicker({
            minDate: -30,
            maxDate: 0,
            onSelect: function( selectedDate ) {
                $('.query-start').datepicker( "option", "maxDate", selectedDate);
            }
        });
    });
}

/* based on template head, filter from data, with actions */

function cgiTable(id) {
    var tableID = '#table-' + id;
    // if not tbody, create one
    var tableBD = tableID + ' > tbody';
    var tableHD = tableID + ' > thead';
    var cgiID;
    var cgiLen = 0;
    var cgiT;

    switch(id)
    {
    // report
    case 'process':
        cgiID   = 'process';
        cgiT    = 'guiProcessT';
        break;
    case 'nat_status':
        cgiID   = 'natStatus';
        cgiT    = 'guiNatStatusT';
        break;
    case 'ipsec_vpn_statistics':
        cgiID   = 'ipsecStat';
        cgiT    = 'guiIpsecStatT';
        break;
    case 'active_sessions':
        cgiID   = 'ipsecSession';
        cgiT    = 'guiIpsecSessionT';
        break;
    // interface
    case 'ports':
        cgiID   = 'port';
        cgiT    = 'guiPortIfT';
        break;
    case 'lan':
        cgiID   = 'lan';
        cgiT    = 'guiLanIfT';
        break;
    case 'vlan_interfaces':
        cgiID   = 'vlan';
        cgiT    = 'guiVlanIfT';
        break;
    case 'wan':
        cgiID   = id;
        cgiT    = 'wanIpIfT';
        
        for (var x in cgiRef[ id ].free)
            cgiRef[ id ].free[ x ] = true;
        cgiRef[ id ].wan = [];
        break;
    case 'zone':
        cgiID   = 'zone';
        cgiT    = 'guiZoneIfT';

        break;
    // networking
    case 'ipsec_policies':
        cgiID   = 's2svpn';
        cgiT    = 'guiS2svpnT';
        
        cgiRef[ cgiID ].free  = [];
        cgiRef[ cgiID ].freez = [];
        break;
    case 'transform_policy':
        cgiID   = 'ipsectransform';
        cgiT    = 'guiIpsectransformT';
        break;
    case 'ike_policy':
        cgiID   = 'ipsecike';
        cgiT    = 'guiIpsecikeT';
        break;
    // firewall
    case 'port_forwarding':
        cgiID   = 'portForwarding';
        cgiT    = 'guiPortForwardingT';
        break;
    case 'static_nat':
        cgiID   = 'staticNat';
        cgiT    = 'guiStaticNatT'; 
        break;
    case 'advanced_nat':
        cgiID   = 'advancedNat';
        cgiT    = 'guiAdvancedNatT';
        break;
    // security
    case 'address_exceptions':
        cgiID   = 'av_addr_exception';
        cgiT    = 'excepT';
        break;
    // admin
    case 'schedule':
        cgiID   = 'common_time_list';
        cgiT    = 'guiTimeT';
        break;
    }

    $.ajax({
        url: 'cgi-bin/' + cgiID + '.cgi',
        dataType: 'json',
        success: function(data) {
            dataObj[id] = $.extend({}, data);
            switch(id)
            {
            case 'process':
                cgiLen = data[ cgiT ].length;
                break;
            case 'nat_status':
                cgiLen = data[ cgiT ].length;
                break;
            case 'ipsec_vpn_statistics':
                cgiLen = parseInt( data.guiIpsecStatTNum );
                break;
            case 'active_sessions':
                cgiLen = parseInt( data.guiIpsecSessionTNum );
                break;
            case 'ports':
                cgiLen = parseInt( data.guiPortIfTNum );
                break;
            case 'lan':
                cgiLen = parseInt( data.guiLanIfTNum );
                break;
            case 'vlan_interfaces':
                cgiLen = parseInt( data.guiVlanIfTNum );
                break;
            case 'wan':
                cgiLen = data[ cgiT ].length;
                break;
            case 'zone':
                cgiLen = parseInt( data.guiZoneIfTNum );
                break;
            case 'ipsec_policies':
                cgiLen = parseInt( data.guiS2svpnTNum );
                break;
            case 'transform_policy':
                cgiLen = parseInt( data.guiIpsectransformTNum );
                break;
            case 'ike_policy':
                cgiLen = parseInt( data.guiIpsecikeTNum );
                break;
            case 'port_forwarding':
                cgiLen = parseInt( data.guiPortForwardingTNum );
                break;
            case 'static_nat':
                cgiLen = parseInt( data.guiStaticNatTNum );
                break;
            case 'advanced_nat':
                cgiLen = parseInt( data.guiAdvancedNatTNum );
                break;
            case 'address_exceptions':
                cgiLen = data[ cgiT ].length;
                break;                    
            case 'schedule':
                cgiLen = parseInt( data.guiTimeTNum );
                break;
            }
            
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
     
            for (var i=0; i < cgiLen; i++) {
                var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                $(tableID + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    switch(thClass == undefined)
                    {
                    case true:
                 
                        switch(id)
                        {
                        case 'ports':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'speedDuplex':
                                tmp += cgiRef[ cgiID ].speed[ data[ cgiT ][ i ].speed ] + '/' + cgiRef[ cgiID ].duplex[ data[ cgiT ][ i ].duplex ];
                                break;
                            case 'linkStatus':
                                tmp += cgiRef[ cgiID ][ thID ][ data[ cgiT ][ i ][ thID ] ];
                                break;
                            case 'zoneId':
                                for (var j=0; j < parseInt( cgiList.common_zoneIf_list.guiZoneIfTNum ); j++)
                                {
                                    switch(parseInt(cgiList.common_zoneIf_list.guiZoneIfT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]))
                                    {
                                    case true:
                                        tmp += cgiList.common_zoneIf_list.guiZoneIfT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            default:
                                tmp += data[ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case 'lan':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'interfaces':
                                var arr = data[ cgiT ][ i ][ thID ].split(regSemicolon);
                                for (var k=0, len=arr.length; k<len; k++)
                                {
                                    for (var j=0; j < parseInt( cgiList.common_portIf_list.guiPortIfTNum ); j++)
                                    {
                                        switch(parseInt(cgiList.common_portIf_list.guiPortIfT[ j ].gid) == parseInt( arr[k] ))
                                        {
                                        case true:
                                            tmp += cgiList.common_portIf_list.guiPortIfT[ j ].name + ' ';
                                            break;
                                        }
                                    }
                                    for (var j=0; j < parseInt( cgiList.common_vlanIf_list.guiVlanIfTNum ); j++)
                                    {
                                        switch(parseInt(cgiList.common_vlanIf_list.guiVlanIfT[ j ].gid) == parseInt( arr[k]))
                                        {
                                        case true:
                                            tmp += cgiList.common_vlanIf_list.guiVlanIfT[ j ].name + ' ';
                                            break;
                                        }
                                    }
                                }
                                break;
                            case 'zone':
                                
                                for (var j=0; j < parseInt( cgiList.common_zoneIf_list.guiZoneIfTNum ); j++)
                                {
                                    switch(parseInt(cgiList.common_zoneIf_list.guiZoneIfT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]))
                                    {
                                    case true:
                                        tmp += cgiList.common_zoneIf_list.guiZoneIfT[ j ].name;
                                        break;
                                    
                                    }
                                }
                                break;
                            default:
                                tmp += data[ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case 'vlan_interfaces':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'zone':
                                for (var j=0; j < parseInt( cgiList.common_zoneIf_list.guiZoneIfTNum ); j++)
                                {
                                    switch(parseInt(cgiList.common_zoneIf_list.guiZoneIfT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]))
                                    {
                                    case true:
                                        tmp += cgiList.common_zoneIf_list.guiZoneIfT[ j ].name;
                                        break;
                                    }
                                }
                                break;                            
                            default:
                                tmp += data[ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case 'wan':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'name':
                                cgiRef[ id ].free[ data[ cgiT ][ i ][ thID ] ] = false;
                                cgiRef[ id ].wan.push( data[ cgiT ][ i ][ thID ] );
                                tmp += data[ cgiT ][i][ thID ];
                                break;
                            case 'wanProto':
                                tmp += cgiRef[ cgiID ][ thID ][ data[ cgiT ][i][ thID ] ];
                                break;
                            case 'address':
                                switch( parseInt( data[ cgiT ][ i ].wanProto ) )
                                {
                                case 0:
                                    tmp += data.staticipT[ i ].ip;
                                    break;
                                case 1:
                                    tmp += data[ cgiT ][ i ][ thID ];
                                    break;
                                }
                                break;
                            case 'portId':
                            case 'zoneId':
                                tmp += cgiHash[ data[ cgiT ][ i ][ thID ] ];
                                break;
                            case 'weight':
                                tmp += cgiRef[ cgiID ][ thID ][ ( data[ cgiT ][ i ][ thID ] < 21 )? 0 : ( ( data[ cgiT ][ i ][ thID ] < 41 )? 1 : ( ( data[ cgiT ][ i ][ thID ] < 61 )? 2 : ( data[ cgiT ][ i ][ thID ] < 81 )? 3 : 4 ) ) ];
                                break;
                            default:
                                tmp += data[ cgiT ][i][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case 'zone':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'member':
                                
                                var arr = data[ cgiT ][ i ][ thID ].split(regSemicolon);
                                var mems = [];
                                for (var k=0, len=arr.length; k<len; k++)
                                {
                                    if (arr[ k ].length > 0) {
                                        mems.push(cgiHash[ arr[ k ] ]);
                                    }
                                }
                                tmp += mems.join(';');
                                
                                
                                break;
                            default:
                                tmp += data[ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case 'ipsec_policies':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'name':
                                tmp += data[ cgiT ][i][ thID ];
                                cgiRef[ cgiID ].free.push( [ data[ cgiT ][ i ].name ] );
                                if (data[ cgiT ][ i ].backupPolicyName.length > 0)
                                    cgiRef[ cgiID ].freez.push( data[ cgiT ][ i ].backupPolicyName );
                                break;
                            case 'enable':
                            case 'infoStatus':
                                tmp += cgiRef[ cgiID ][ thID ][ data[ cgiT ][ i ][ thID ] ];
                                break;
                            case 'wanId':
                                for (var j=0, len=parseInt(cgiList.common_wanIf_list.guiWanIfTNum); j<len; j++)
                                {
                                    switch(cgiList.common_wanIf_list.guiWanIfT[ j ].gid == data[ cgiT ][ i ][ thID ])
                                    {
                                    case true:
                                        tmp += cgiList.common_wanIf_list.guiWanIfT[ j ].name;
                                        break;
                                    }
                                }
                                
                                break;
                            case 'localNetworkId':
                            case 'remoteNetworkId':
                                for (var j=0, len=parseInt(cgiList.common_addr_list.guiAddrTNum); j<len; j++)
                                {
                                    switch(cgiList.common_addr_list.guiAddrT[ j ].gid == data[ cgiT ][ i ][ thID ])
                                    {
                                    case true:
                                        tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            case 'ikePolicyId':
                                for (var j=0, len=parseInt(cgiList.ipsecike.guiIpsecikeTNum); j<len; j++)
                                {
                                    switch(cgiList.ipsecike.guiIpsecikeT[ j ].gid== data[ cgiT ][ i ][ thID ])
                                    {
                                    case true:
                                        tmp += cgiList.ipsecike.guiIpsecikeT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            case 'transformPolicyId':
                                for (var j=0, len=parseInt(cgiList.ipsectransform.guiIpsectransformTNum); j<len; j++)
                                {
                                    switch(cgiList.ipsectransform.guiIpsectransformT[ j ].gid == data[ cgiT ][ i ][ thID ])
                                    {
                                    case true:
                                        tmp += cgiList.ipsectransform.guiIpsectransformT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            default:
                                tmp += data[ cgiT ][i][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        
                        case 'ike_policy':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'cipher':
                            case 'hash':
                            case 'dhgroup':
                                tmp += cgiRef[ cgiID ][ thID ][ data[ cgiT ][ i ][ thID ] ];
                                break;
                            default:
                                tmp += data[ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case 'transform_policy':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'cipher':
                            case 'hash':
                            case 'pfsgroup':
                                tmp += cgiRef[ cgiID ][ thID ][ data[ cgiT ][ i ][ thID ] ];
                                break;
                            default:
                                tmp += data[ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case 'port_forwarding':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'description':
                                tmp += data[ cgiT ][ i ][ thID ];
                                break;
                            case 'seq':
                                tmp += i+1;
                                break;
                            case 'originalService':
                            case 'translatedService':
                                for (var j=0; j < parseInt( cgiList.common_service_list.guiServiceTNum ); j++)
                                {
                                    switch( parseInt(cgiList.common_service_list.guiServiceT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]) )
                                    {
                                    case true:
                                        tmp += cgiList.common_service_list.guiServiceT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            case 'privateIp':
                            case 'wanIpId':
                                for (var j=0; j < parseInt( cgiList.common_addr_list.guiAddrTNum ); j++)
                                {
                                    switch( parseInt(cgiList.common_addr_list.guiAddrT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]) )
                                    {
                                    case true:
                                        tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            case 'wan':
                                tmp += cgiRef[ thID ].interfaces[ data[ cgiT ][ i ][ thID ] ];
                                break;
                            }
                            
                            tmp += '</td>';
                            break;
                        case 'static_nat':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch( thID )
                            {
                            case 'seq':
                                tmp += i + 1;
                                break;
                            case 'publicIp':
                            case 'privateIp':
                                for (var j=0; j < parseInt( cgiList.common_addr_list.guiAddrTNum ); j++)
                                {
                                    switch( parseInt(cgiList.common_addr_list.guiAddrT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]) )
                                    {
                                    case true:
                                        tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                        break;
                                    }
                                }
                                
                                break;
                            case 'wanInterface':
                                tmp += data[ cgiT ][ i ][ thID ];
                                break;
                            }
                            tmp += '</td>';
                            break;
                        case 'advanced_nat':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch( thID )
                            {
                            case 'enabled':
                                tmp += cgiRef[ cgiID ][ thID ][ data[ cgiT ][ i ][ thID ] ];
                                break;
                            case 'seq':
                                tmp += i+1;
                                break;
                            case 'fromIf':
                            case 'toIf':
                            
                                for (var j=0; j < parseInt( cgiList.common_portIf_list.guiPortIfTNum ); j++)
                                {
                                    switch( parseInt( data[ cgiT ][ i ][ thID ] ) == parseInt( cgiList.common_portIf_list.guiPortIfT[ j ].gid ) )
                                    {
                                    case true:
                                        tmp += cgiList.common_portIf_list.guiPortIfT[ j ].name;
                                        break;
                                    }
                                }
                                for (var j=0; j < parseInt( cgiList.common_wanIf_list.guiWanIfTNum ); j++)
                                {
                                    switch( parseInt( data[ cgiT ][ i ][ thID ] ) == parseInt( cgiList.common_wanIf_list.guiWanIfT[ j ].gid ) )
                                    {
                                    case true:
                                        tmp += cgiList.common_wanIf_list.guiWanIfT[ j ].name;
                                        break;
                                    }
                                }
                                for (var j=0; j < parseInt( cgiList.common_lanIf_list.guiLanIfTNum ); j++)
                                {
                                    switch( parseInt( data[ cgiT ][ i ][ thID ] ) == parseInt( cgiList.common_lanIf_list.guiLanIfT[ j ].gid ) )
                                    {
                                    case true:
                                        tmp += cgiList.common_lanIf_list.guiLanIfT[ j ].name;
                                        break;
                                    }
                                }
                                for (var j=0; j < parseInt( cgiList.common_vlanIf_list.guiVlanIfTNum ); j++)
                                {
                                    switch( parseInt( data[ cgiT ][ i ][ thID ] ) == parseInt( cgiList.common_vlanIf_list.guiVlanIfT[ j ].gid ) )
                                    {
                                    case true:
                                        tmp += cgiList.common_vlanIf_list.guiVlanIfT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            case 'originalSrc':
                            case 'originalDst':
                            case 'translatedSrc':
                            case 'translatedDst':
                                for (var j=0; j < parseInt( cgiList.common_addr_list.guiAddrTNum ); j++)
                                {
                                    switch( parseInt(cgiList.common_addr_list.guiAddrT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]) )
                                    {
                                    case true:
                                        tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                        break;
                                    }
                                }
                                
                                break;
                            case 'originalService':
                            case 'translatedService':
                                for (var j=0; j < parseInt( cgiList.common_service_list.guiServiceTNum ); j++)
                                {
                                    switch( parseInt(cgiList.common_service_list.guiServiceT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]) )
                                    {
                                    case true:
                                        tmp += cgiList.common_service_list.guiServiceT[ j ].name;
                                        break;
                                    }
                                }
                                for (var j=0; j < parseInt( cgiList.common_gService_list.guiGServiceTNum ); j++)
                                {
                                    switch( parseInt(cgiList.common_gService_list.guiGServiceT[ j ].gid) == parseInt(data[ cgiT ][ i ][ thID ]) )
                                    {
                                    case true:
                                        tmp += cgiList.common_gService_list.guiGServiceT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            case 'wanInterface':
                                tmp += data[ cgiT ][ i ][ thID ];
                                break;
                            }
                            tmp += '</td>';
                            break;
                        case 'address_exceptions':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'Log':
                                tmp += cgiRef.antivirus.Log[ data[ cgiT ][ i ][ thID ] ];
                                break;
                            case 'srcAddrType':
                                switch(parseInt( data[ cgiT ][ i ][ thID ] ))
                                {
                                case 0:
                                    for (var j=0, jlen = parseInt( cgiList.common_addr_list.guiAddrTNum ); j < jlen; j++)
                                    {
                                        if (parseInt( data[ cgiT ][ i ].srcAddrGid ) == parseInt( cgiList.common_addr_list.guiAddrT[ j ].gid ))
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                    }
                                    break;
                                case 1:
                                    for (var j=0, jlen = parseInt( cgiList.common_gAddr_list.guiGAddrTNum ); j < jlen; j++)
                                    {
                                        if (parseInt( data[ cgiT ][ i ].srcGAddrGid ) == parseInt( cgiList.common_gAddr_list.guiGAddrT[ j ].gid ))
                                            tmp += cgiList.common_gAddr_list.guiGAddrT[ j ].name;
                                    }
                                    break;   
                                }
                                break;
                            case 'dstAddrType':
                                switch(parseInt( data[ cgiT ][ i ][ thID ] ))
                                {
                                case 0:
                                    for (var j=0, jlen = parseInt( cgiList.common_addr_list.guiAddrTNum ); j < jlen; j++)
                                    {
                                        if (parseInt( data[ cgiT ][ i ].dstAddrGid ) == parseInt( cgiList.common_addr_list.guiAddrT[ j ].gid ))
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                    }
                                    break;
                                case 1:
                                    for (var j=0, jlen = parseInt( cgiList.common_gAddr_list.guiGAddrTNum ); j < jlen; j++)
                                    {
                                        if (parseInt( data[ cgiT ][ i ].dstGAddrGid ) == parseInt( cgiList.common_gAddr_list.guiGAddrT[ j ].gid ))
                                            tmp += cgiList.common_gAddr_list.guiGAddrT[ j ].name;
                                    }
                                    break;   
                                }
                                break;
                            }
                            tmp += '</td>';
                            break;
                        case 'schedule':
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'startTime':
                                if (parseInt(data[cgiT][i].type) == 1 || parseInt(data[cgiT][i].type) == 3)
                                    tmp += '0:0';
                                else 
                                    tmp += data[ cgiT ][ i ].startHour + ':' + data[ cgiT ][ i ].startMin;
                                break;
                            case 'endTime':
                                if (parseInt(data[cgiT][i].type) == 1 || parseInt(data[cgiT][i].type) == 3)
                                    tmp += '23:59';
                                else
                                    tmp += data[ cgiT ][ i ].endHour + ':' + data[ cgiT ][ i ].endMin;
                                break;
                            case 'day':
                                var arr = [];
                                var days = parseInt( data[ cgiT ][ i ][ thID ] );
                                switch(days>0)
                                {
                                case true:
                                    while(days > 0) {
                                        switch(true)
                                        {
                                        case (days >= 64):
                                            days -= 64;
                                            arr.push(cgiRef[ id ][ thID ]["64"]);
                                            break;
                                        case (days >= 32):
                                            days -= 32;
                                            arr.push(cgiRef[ id ][ thID ]["32"]);
                                            break;
                                        case (days >= 16):
                                            days -= 16;
                                            arr.push(cgiRef[ id ][ thID ]["16"]);
                                            break;
                                        case (days >= 8):
                                            days -= 8;
                                            arr.push(cgiRef[ id ][ thID ]["8"]);
                                            break;
                                        case (days >= 4):
                                            days -= 4;
                                            arr.push(cgiRef[ id ][ thID ]["4"]);
                                            break;
                                        case (days >= 2):
                                            days -= 2;
                                            arr.push(cgiRef[ id ][ thID ]["2"]);
                                            break;
                                        case (days >= 1):
                                            days -= 1;
                                            arr.push(cgiRef[ id ][ thID ]["1"]);
                                            break;
                                        }
                                    }
                                    tmp += arr.reverse().join(",");
                                    break;
                                case false:
                                    tmp += cgiRef[ id ][ thID ]["0"];
                                    break;
                                }
                                break;
                            case 'num':
                                tmp += (i+1).toString();
                                break;
                            default:
                                tmp += data[ cgiT ][ i ][ thID ] ;
                            }
                            tmp += '</td>';
                            break;
                        default:
                            tmp += '<td id="' + thID + '-' + i + '">';
                            tmp += data[ cgiT ][ i ][ thID ];
                            tmp += '</td>';
                        }
                        break;
                    case false:
                        regObj = thClass.match(regRowAction);
                        switch(true)
                        {
                        case (regObj != null):
                            $(this).addClass('rowAction BT'+regObj.length);
                            tmp += '<td class="buttonTD">';
                            for (var x in regObj)
                            {
                                switch(regDigit.test(x))
                                {
                                case true:
                                    tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon" title="' + regObj[x] + '"></span></button>';
                                    break;
                                }
                            }
                            tmp += '</td>';
                            break;
                        case (regCheckbox.test(thClass)):
                            tmp += '<td class="checkTD">';
                            
                            switch(id)
                            {
                            case 'zone':
                            case 'lan':
                                if (parseInt(data[ cgiT ][ i ].userDefined) != 0) 
                                    tmp += '<input type="checkbox" value="' + i + '" />';
                                break;
                            default:
                                tmp += '<input type="checkbox" value="' + i + '" />';
                            }
                            tmp += '</td>';
                            break;
                        case (regSelect.test(thClass)):
                            tmp += '<td class="selectTD">'
                            tmp += '<select id="' + thID + '-' + i + '">';
                            tmp += genSelectOption(thID);
                            tmp += '</select>';
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                });
                tmp += '</tr>';
                $(tableBD).append(tmp);
                
                switch(id)
                {
                case 'zone':
                case 'lan':
                    if (parseInt(data[ cgiT ][ i ].userDefined) == 0) 
                        $('#Delete' + '-' + id + '-' + i).remove();
                    break;
                case 'ipsec_policies':
                case 'active_sessions':
                    switch( parseInt(data[ cgiT ][ i ].infoStatus) )
                    {
                    case 0:
                        $('#Disconnect-' + id + '-' + i).prop('disabled', true);
                        break;
                    case 1:
                        $('#Connect-' + id + '-' + i).prop('disabled', true);
                        break;
                    case 2:
                        $('#Connect-' + id + '-' + i).prop('disabled', true);
                        $('#Disconnect-' + id + '-' + i).prop('disabled', true);
                        break;
                    }
                    break;
                case 'ports':
                case 'vlan_interfaces':
                    switch(parseInt(data[ cgiT ][ i ].type))
                    {
                    case 0:
                    
                        break;
                    default:
                        $('#Edit-' + id + '-' + i).prop('disabled', true);
                        break;
                    }
                    break;
                }
            }
            
            if ($(tableHD).length > 0)
                $(tableHD + ' tr th').addClass('ui-state-default');
            
            genTableAction(id);
            
            switch(id)
            {
            case 'process':
            case 'nat_status':
                cgiRefreshStart(id);
                break;
            case 'address_exceptions':
                if (parseInt(dataObj[ id ].execpNum == 32))
                    $('#Create-address_exceptions').prop('disabled', true);
                break;   
            }
                            
        },
        error: function (xhr, ajaxOptions, thrownError) {
            console.log( id + ' @ error');
            console.log(xhr.status);
            console.log(thrownError);
        }
    });
}

function cgiRefreshStart(id) {
    refresher = setInterval(function(){ cgiRefresh(id) }, 10000);
}

function cgiRefreshStop() {
    clearInterval(refresher);
}

function cgiRefresh(id) {
    var tID;
    var tableID;
    var tableBD;
    var tableHD;
    var trNo;
    var cgiID;
    var cgiT;
    var cgiTNum;

    console.log('refresh ' + id);
    switch(id)
    {
    case 'process':
        tableID = '#table-' + id;
        tableBD = tableID + ' > tbody';
        tableHD = tableID + ' > thead';
        $(tableBD).remove();
        if ($(tableBD).length == 0)
            $(tableID).append('<tbody>');
        trNo = 0;
        cgiID = 'process';
        cgiT = 'guiProcessT';
        
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                cgiTNum = dataObj[ id ][ cgiT ].length;
                for (var i=0; i<cgiTNum; i++)
                {
                    var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                    trNo++;
                    $(tableHD + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';
                        
                    $(tableBD).append(tmp);
        
                }
            }
        });
        break;
    case 'nat_status':
        tableID = '#table-' + id;
        tableBD = tableID + ' > tbody';
        tableHD = tableID + ' > thead';
        trNo = 0;
        cgiID = 'natStatus';
        cgiT = 'guiNatStatusT';
        $(tableBD).remove();
        if ($(tableBD).length == 0)
            $(tableID).append('<tbody>');
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                cgiTNum = dataObj[ id ][ cgiT ].length;
                for (var i=0; i<cgiTNum; i++)
                {
                    var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                    trNo++;
                    $(tableHD + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';
                        
                    $(tableBD).append(tmp);
        
                }
            }
        });
        break;
    case 'traffic_statistics':
        tID     = 'port';
        tableID = '#table-' + tID;
        tableBD = tableID + ' > tbody';
        tableHD = tableID + ' > thead';
        trNo    = 0;
        cgiID   = 'trafficStatisticsPort';
        cgiT    = 'guiTrafficStatisticsPortT';
        $(tableBD).remove();
        if ($(tableBD).length == 0)
            $(tableID).append('<tbody>');
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.port = $.extend({}, data);
                cgiTNum = dataObj[ tID ][ cgiT ].length;
                for (var i=0; i<cgiTNum; i++)
                {
                    var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                    trNo++;
                    $(tableHD + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';
                        
                    $(tableBD).append(tmp);
        
                }
            }
        }).done(function() {
            trNo    = 0;
            cgiID = 'trafficStatisticsWan';
            cgiT = 'guiTrafficStatisticsWanT';
            tID = 'wan';
            tableID = '#table-' + tID;
            tableBD = tableID + ' > tbody';
            tableHD = tableID + ' > thead';
            $(tableBD).remove();
            if ($(tableBD).length == 0)
                $(tableID).append('<tbody>');
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    dataObj.wan = $.extend({}, data);
                    
                    cgiTNum = dataObj[ tID ][ cgiT ].length;
                    for (var i=0; i<cgiTNum; i++)
                    {
                        var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                        trNo++;
                        $(tableHD + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
                            
                        $(tableBD).append(tmp);
            
                    }
                }
            }).done( function() {
                trNo    = 0;
                cgiID = 'trafficStatisticsLan';
                cgiT = 'guiTrafficStatisticsLanT';
                tID = 'lan';
                tableID = '#table-' + tID;
                tableBD = tableID + ' > tbody';
                tableHD = tableID + ' > thead';
                $(tableBD).remove();
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                $.ajax({
                    url: 'cgi-bin/' + cgiID + '.cgi',
                    dataType: 'json',
                    success: function(data) {
                        dataObj.lan = $.extend({}, data);
                        
                        cgiTNum = dataObj[ tID ][ cgiT ].length;
                        for (var i=0; i<cgiTNum; i++)
                        {
                            var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                            trNo++;
                            $(tableHD + ' tr th').each(function(index) {
                                // each col
                                var thID = $(this).attr('id');
                                tmp += '<td id="' + thID + '-' + i + '">'; 
                                tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                                tmp += '</td>';
                            });
                            tmp += '</tr>';
                                
                            $(tableBD).append(tmp);
                
                        }
                    }
                }).done( function() {
                    trNo    = 0;
                    cgiID = 'trafficStatisticsVlan';
                    cgiT = 'guiTrafficStatisticsVlanT';
                    tID = 'vlan';
                    tableID = '#table-' + tID;
                    tableBD = tableID + ' > tbody';
                    tableHD = tableID + ' > thead';
                    $(tableBD).remove();
                    if ($(tableBD).length == 0)
                        $(tableID).append('<tbody>');
                    $.ajax({
                        url: 'cgi-bin/' + cgiID + '.cgi',
                        dataType: 'json',
                        success: function(data) {
                            dataObj.vlan = $.extend({}, data);
                            cgiTNum = dataObj[ tID ][ cgiT ].length;
                            for (var i=0; i<cgiTNum; i++)
                            {
                                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                                trNo++;
                                $(tableHD + ' tr th').each(function(index) {
                                    // each col
                                    var thID = $(this).attr('id');
                                    tmp += '<td id="' + thID + '-' + i + '">'; 
                                    tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                                    tmp += '</td>';
                                });
                                tmp += '</tr>';
                                    
                                $(tableBD).append(tmp);
                    
                            }
                        }
                    });
                });
            });
        });
        break;
    case 'port':
        trNo    = 0;
        cgiID = 'trafficStatisticsPort';
        cgiT = 'guiTrafficStatisticsPortT';
        tID = 'port';
        tableID = '#table-' + tID;
        tableBD = tableID + ' > tbody';
        tableHD = tableID + ' > thead';
        $(tableBD).remove();
        if ($(tableBD).length == 0)
            $(tableID).append('<tbody>');
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.port = $.extend({}, data);
                cgiTNum = dataObj[ tID ][ cgiT ].length;
                for (var i=0; i<cgiTNum; i++)
                {
                    var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                    trNo++;
                    $(tableHD + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';
                        
                    $(tableBD).append(tmp);
        
                }
            }
        });
        break;
    case 'lan':
        trNo    = 0;
        cgiID = 'trafficStatisticsLan';
        cgiT = 'guiTrafficStatisticsLanT';
        tID = 'lan';
        tableID = '#table-' + tID;
        tableBD = tableID + ' > tbody';
        tableHD = tableID + ' > thead';
        $(tableBD).remove();
        if ($(tableBD).length == 0)
            $(tableID).append('<tbody>');
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.lan = $.extend({}, data);
                cgiTNum = dataObj[ tID ][ cgiT ].length;
                for (var i=0; i<cgiTNum; i++)
                {
                    var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                    trNo++;
                    $(tableHD + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';
                        
                    $(tableBD).append(tmp);
        
                }
            }
        });
        break;
    case 'vlan':
        trNo    = 0;
        cgiID = 'trafficStatisticsVlan';
        cgiT = 'guiTrafficStatisticsVlanT';
        tID = 'vlan';
        tableID = '#table-' + tID;
        tableBD = tableID + ' > tbody';
        tableHD = tableID + ' > thead';
        $(tableBD).remove();
        if ($(tableBD).length == 0)
            $(tableID).append('<tbody>');
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.vlan = $.extend({}, data);
                cgiTNum = dataObj[ tID ][ cgiT ].length;
                for (var i=0; i<cgiTNum; i++)
                {
                    var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                    trNo++;
                    $(tableHD + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';
                        
                    $(tableBD).append(tmp);
        
                }
            }
        });
        break;
    case 'wan':
        trNo    = 0;
        cgiID = 'trafficStatisticsWan';
        cgiT = 'guiTrafficStatisticsWanT';
        tID = 'wan';
        tableID = '#table-' + tID;
        tableBD = tableID + ' > tbody';
        tableHD = tableID + ' > thead';
        $(tableBD).remove();
        if ($(tableBD).length == 0)
            $(tableID).append('<tbody>');
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.wan = $.extend({}, data);
                cgiTNum = dataObj[ tID ][ cgiT ].length;
                for (var i=0; i<cgiTNum; i++)
                {
                    var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                    trNo++;
                    $(tableHD + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';
                        
                    $(tableBD).append(tmp);
        
                }
            }
        });
        break;
    case 'rules':
        trNo    = 0;
        cgiID = 'rules';
        cgiT = 'guiRulesT';
        tID = 'rules';
        tableID = '#table-' + tID;
        tableBD = tableID + ' > tbody';
        tableHD = tableID + ' > thead';
        $(tableBD).remove();
        if ($(tableBD).length == 0)
            $(tableID).append('<tbody>');
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.rules = $.extend({}, data);
                cgiRedraw(id);
                /*
                cgiTNum = dataObj[ tID ].guiRulesTNum.length;
                for (var i=0; i<cgiTNum; i++)
                {
                    var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                    trNo++;
                    $(tableHD + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace( tID + '-','') ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';
                        
                    $(tableBD).append(tmp);
        
                }
                */
            }
        });
        break;   
    }
}

function cgiRedraw( id ) {
    var tableID = '#table-' + id;

    var tableBD = tableID + ' > tbody';
    var tableHD = tableID + ' > thead';
    var trNo = 0;
    var cgiID;
    var cgiT;
    var cgiTNum;
    
    $(tableBD).remove();
    $(tableID).append('<tbody>');
    switch( id ) 
    {
    case 'ip_alias':
        for (var i=0, len=cgiIpAlias.length; i<len; i++)
        {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';

            $(tableHD + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                regObj = thClass.match(regRowAction);
                
                switch(regObj != null)
                {
                case true:
                    $(this).addClass('rowAction BT'+regObj.length);
                    tmp += '<td class="buttonTD">';
                    for (var x in regObj){
                        switch(regDigit.test(x))
                        {
                        case true:
                            tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                            break;
                        }
                    }
                    tmp += '</td>';
                    break;
                case false:
                    tmp += '<td id="' + thID + '-' + i + '">' + cgiIpAlias[ i ][ thID.replace('ipAliasT-', '') ] + '</td>'; 
                    break;
                }
            });
            tmp += '</tr>';
            
            $(tableBD).append(tmp);
        }
        break;
    case 'schedule':
        cgiT = 'guiTimeT';
        cgiTNum = 'guiTimeTNum';
        
        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';

            $(tableHD + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                regObj = thClass.match(regRowAction);
                
                switch(regObj != null)
                {
                case true:
                    $(this).addClass('rowAction BT'+regObj.length);
                    tmp += '<td class="buttonTD">';
                    for (var x in regObj){
                        switch(regDigit.test(x))
                        {
                        case true:
                            tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                            break;
                        }
                    }
                    tmp += '</td>';
                    break;
                case false:
                    switch( regCheckbox.test(thClass) )
                    {
                    case true:
                        tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                        break;
                    case false:
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        switch( thID )
                        {
                        case 'num':
                            tmp += (i+1).toString();
                            break;
                        case 'startTime':
                            tmp += dataObj[ id ][ cgiT ][ i ].startHour + ':' + dataObj[ id ][ cgiT ][ i ].startMin;
                            break;
                        case 'endTime':
                            tmp += dataObj[ id ][ cgiT ][ i ].endHour + ':' + dataObj[ id ][ cgiT ][ i ].endMin;
                            break;
                        case 'day':
                            var arr = [];
                            var days = parseInt( dataObj[ id ][ cgiT ][ i ][ thID ] );
                            switch(days>0)
                            {
                            case true:
                                while(days > 0) {
                                    switch(true)
                                    {
                                    case (days >= 64):
                                        days -= 64;
                                        arr.push(cgiRef[ id ][ thID ]["64"]);
                                        break;
                                    case (days >= 32):
                                        days -= 32;
                                        arr.push(cgiRef[ id ][ thID ]["32"]);
                                        break;
                                    case (days >= 16):
                                        days -= 16;
                                        arr.push(cgiRef[ id ][ thID ]["16"]);
                                        break;
                                    case (days >= 8):
                                        days -= 8;
                                        arr.push(cgiRef[ id ][ thID ]["8"]);
                                        break;
                                    case (days >= 4):
                                        days -= 4;
                                        arr.push(cgiRef[ id ][ thID ]["4"]);
                                        break;
                                    case (days >= 2):
                                        days -= 2;
                                        arr.push(cgiRef[ id ][ thID ]["2"]);
                                        break;
                                    case (days >= 1):
                                        days -= 1;
                                        arr.push(cgiRef[ id ][ thID ]["1"]);
                                        break;
                                    }
                                }
                                tmp += arr.reverse().join(",");
                                break;
                            case false:
                                tmp += cgiRef[ id ][ thID ]["0"];
                                break;
                            }
                            break;
                        case 'name':
                            tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            break;
                        }
                        tmp += '</td>';
                        break;
                    }
                    break;
                }
                
            });
            tmp += '</tr>';
            
            $(tableBD).append(tmp);
        }

        break;
    case 'address':
        cgiT = 'guiAddrT';
        cgiTNum = 'guiAddrTNum';
        
        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';

            $(tableHD + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                regObj = thClass.match(regRowAction);
                
                switch(regObj != null)
                {
                case true:
                    $(this).addClass('rowAction BT'+regObj.length);
                    tmp += '<td class="buttonTD">';
                    for (var x in regObj){
                        switch(regDigit.test(x))
                        {
                        case true:
                            tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                            break;
                        }
                    }
                    tmp += '</td>';
                    break;
                case false:
                    switch( regCheckbox.test(thClass) )
                    {
                    case true:
                        tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                        break;
                    case false:
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        switch( thID )
                        {
                        case 'num':
                            tmp += (i+1).toString();
                            break;
                        case 'detail':
                            tmp += cgiRef[ id ].type[ dataObj[ id ][ cgiT ][ i ].type ] + ': ';
                            switch( parseInt( dataObj[ id ][ cgiT ][ i ].type ) )
                            {
                            case 1:
                                tmp += dataObj[ id ][ cgiT ][ i ].startIp;
                                break;
                            case 2:
                                tmp += dataObj[ id ][ cgiT ][ i ].startIp + '/' + dataObj[ id ][ cgiT ][ i ].netmask;
                                break;
                            case 3:
                                tmp += dataObj[ id ][ cgiT ][ i ].startIp + '-' + dataObj[ id ][ cgiT ][ i ].endIp;
                                break;
                            case 4:
                                tmp += dataObj[ id ][ cgiT ][ i ].mac;
                                break;    
                            }
                            break;
                        case 'type':
                            tmp += cgiRef[ id ][ thID ][ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                            break;
                        case 'name':
                            tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            break;
                        }
                        tmp += '</td>';
                        break;
                    }
                    break;
                }
                
            });
            tmp += '</tr>';
            
            $(tableBD).append(tmp);
        }

        break;
    case 'group_address':

        cgiT     = 'guiGAddrT';
        cgiTNum    = 'guiGAddrTNum';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
    
            $(tableHD + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                
                regObj = thClass.match(regRowAction);

                switch (regObj != null) 
                {
                case true:
                    $(this).addClass('rowAction BT'+regObj.length);
                    tmp += '<td class="buttonTD">';
                    for (var x in regObj){
                        switch(regDigit.test(x))
                        {
                        case true:
                            tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                            break;
                        }
                    }
                    tmp += '</td>';
                    break;
                case false:
                    switch(regTooltip.test(thClass))
                    {
                    case true:
                        switch(thID)
                        {
                        case 'groupName':
                            tmp += '<td id="' + thID + '-' + i +'" colspan="3" class="alignLeft">';
                            tmp +=     '<div class="tooltipAccordion">';
                            tmp +=        '<h4><a href="#">' + dataObj[ id ][ cgiT ][ i ].name + '</a></h4>';
                            tmp +=        '<div id="div-' + thID + '-' + i + '">';
                            tmp +=            tooltipTable( id, thID + '-' + i, dataObj[ id ][ cgiT ][ i ].idList);
                            tmp +=        '</div>';
                            tmp +=     '</div>';
                            tmp += '</td>';
                            break;
                        }
                        break;
                    case false:
                        switch(regCheckbox.test(thClass))
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch( thID )
                            {
                            case 'groupNum':
                                tmp += (i+1).toString();
                                break;
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                }
                
                
            });
            tmp += '</tr>';
            
            $(tableBD).append(tmp);
        }

        $('.tooltipAccordion').accordion({
            collapsible:true, 
            active:false, 
            autoHeight: false
        });
        break; 
    case 'service':
        cgiT = 'guiServiceT';
        cgiTNum = 'guiServiceTNum';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';

            $(tableHD + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                regObj = thClass.match(regRowAction);
                
                switch(regObj != null)
                {
                case true:
                    $(this).addClass('rowAction BT'+regObj.length);
                    tmp += '<td class="buttonTD">';
                    for (var x in regObj){
                        switch(regDigit.test(x))
                        {
                        case true:
                            tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                            break;
                        }
                    }
                    tmp += '</td>';
                    break;
                case false:
                    switch( regCheckbox.test(thClass) )
                    {
                    case true:
                        tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                        break;
                    case false:
                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        switch( thID )
                        {
                        case 'num':
                            tmp += (i+1).toString();
                            break;
                        case 'type':
                            tmp += cgiRef[ id ][ thID ][ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                            break;
                        default:
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                        }
                        tmp += '</td>';
                        break;
                    }
                    break;
                }
                
            });
            tmp += '</tr>';
            
            $(tableBD).append(tmp);
        }    
        break;
    case 'group_service':
        cgiT     = 'guiGServiceT';
        cgiTNum    = 'guiGServiceTNum';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
    
            $(tableHD + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                
                regObj = thClass.match(regRowAction);

                switch (regObj != null) 
                {
                case true:
                    $(this).addClass('rowAction BT'+regObj.length);
                    tmp += '<td class="buttonTD">';
                    for (var x in regObj){
                        switch(regDigit.test(x))
                        {
                        case true:
                            tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                            break;
                        }
                    }
                    tmp += '</td>';
                    break;
                case false:
                    switch(regTooltip.test(thClass))
                    {
                    case true:
                        switch(thID)
                        {
                        case 'groupName':
                            tmp += '<td id="' + thID + '-' + i +'" colspan="4" class="alignLeft">';
                            tmp +=     '<div class="tooltipAccordion">';
                            tmp +=        '<h4><a href="#">' + dataObj[ id ][ cgiT ][ i ].name + '</a></h4>';
                            tmp +=        '<div id="div-' + thID + '-' + i + '">';
                            tmp +=            tooltipTable( id, thID + '-' + i, dataObj[ id ][ cgiT ][ i ].idList);
                            tmp +=        '</div>';
                            tmp +=     '</div>';
                            tmp += '</td>';
                            break;
                        }
                        break;
                    case false:
                        switch(regCheckbox.test(thClass))
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch( thID )
                            {
                            case 'groupNum':
                                tmp += (i+1).toString();
                                break;
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                }
                
                
            });
            tmp += '</tr>';
            
            $(tableBD).append(tmp);
        }

        $('.tooltipAccordion').accordion({
            collapsible:true, 
            active:false, 
            autoHeight: false
        });
        break;
    // interface
 
    case 'lan':
        cgiT = 'guiLanIfT';
        cgiTNum = 'guiLanIfTNum';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                if (!(parseInt(dataObj[ id ][ cgiT ][ i ].userDefined) == 0 && regObj[x] == 'Delete'))
                                    tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD">';
                            if (parseInt(dataObj[ id ][ cgiT ][ i ].userDefined) != 0)
                                tmp += '<input type="checkbox" value="' + i + '" />';
                            tmp += '</td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch(thID)
                            {
                            case 'interfaces':
                                var arr = dataObj[ id ][ cgiT ][ i ][ thID ].split(regSemicolon);
                                var mems = [];
                                for (var k=0, len=arr.length; k<len; k++)
                                {
                                    if (arr[ k ].length > 0)
                                        mems.push(cgiHash[ arr[ k ] ]);
                                }
                                tmp += mems.join(';');
                                break;
                            case 'zone':
                                tmp += cgiHash[ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;
                            default:
                                if (dataObj[id][cgiT][i][thID])
                                    tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);
                break;
            }
        }
        
        break;
    case 'vlan_interfaces':
        cgiT = 'guiVlanIfT';
        cgiTNum = 'guiVlanIfTNum';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch(thID)
                            {
                            case 'zone':
                                for (var j=0; j < parseInt( cgiList.common_zoneIf_list.guiZoneIfTNum ); j++)
                                {
                                    switch(parseInt(cgiList.common_zoneIf_list.guiZoneIfT[ j ].gid) == parseInt(dataObj[ id ][ cgiT ][ i ][ thID ]))
                                    {
                                    case true:
                                        tmp += cgiList.common_zoneIf_list.guiZoneIfT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            default:
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);

                if (parseInt(dataObj[ id ][ cgiT ][ i ].type) > 0)
                    $('#Edit-' + id + '-' + i).prop('disabled', true);
                    
                break;
            }
        }
        
        break;
        
    case 'wan':
        cgiT = 'wanIpIfT';

        for (var i=0, len=dataObj[ id ][ cgiT ].length; i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch(thID)
                            {
                            case 'wanProto':
                                tmp += cgiRef[ id ][ thID ][ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;
                            case 'address':
                                tmp += (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ]) == 0)? dataObj[ id ].staticipT[ i ].ip : dataObj[ id ][ cgiT ][ i ][ thID ];
                                break;
                            case 'portId':
                            case 'zoneId':
                                tmp += cgiHash[ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;
                            case 'weight':
                                tmp += cgiRef[ id ][ thID ][ ( dataObj[ id ][ cgiT ][ i ][ thID ] < 21 )? 0 : ( ( dataObj[ id ][ cgiT ][ i ][ thID ] < 41 )? 1 : ( ( dataObj[ id ][ cgiT ][ i ][ thID ] < 61 )? 2 : ( dataObj[ id ][ cgiT ][ i ][ thID ] < 81 )? 3 : 4 ) ) ];

                                break;
                            default:
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);
                break;
            }
        }
        
        break;
    case 'zone':
        cgiT = 'guiZoneIfT';
        cgiTNum = 'guiZoneIfTNum';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                if (!(parseInt(dataObj[ id ][ cgiT ][ i ].userDefined) == 0 && regObj[ x ] == 'Delete'))
                                    tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD">';
                            if (parseInt(dataObj[ id ][ cgiT ][ i ].userDefined) != 0 )
                                tmp += '<input type="checkbox" value="' + i + '" />';
                            tmp += '</td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch(thID)
                            {
                            case 'member':
                            
                                var arr = dataObj[ id ][ cgiT ][ i ][ thID ].split(regSemicolon);
                                var mems = [];
                                for (var k=0, len=arr.length; k<len; k++)
                                {
                                    if (arr[ k ].length > 0) {
                                        mems.push(cgiHash[ arr[ k ] ]);
                                    }
                                }
                                tmp += mems.join(';');
                                    
                                break;
                            default:
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);
                break;
            }
        }
        
        break;
    case 'ipsec_policies':
        cgiT = 'guiS2svpnT';
        cgiTNum = 'guiS2svpnTNum';
        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 

                            switch(thID)
                            {

                            case 'enable':
                            case 'infoStatus':
                                tmp += cgiRef.s2svpn[ thID ][ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;
                            case 'wanId':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.common_wanIf_list.guiWanIfTNum); j<len; j++)
                                    {
                                        switch(cgiList.common_wanIf_list.guiWanIfT[ j ].gid == dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.common_wanIf_list.guiWanIfT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            case 'localNetworkId':
                            case 'remoteNetworkId':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.common_addr_list.guiAddrTNum); j<len; j++)
                                    {
                                        switch(cgiList.common_addr_list.guiAddrT[ j ].gid == dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            case 'ikePolicyId':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.ipsecike.guiIpsecikeTNum); j<len; j++)
                                    {
                                        switch(cgiList.ipsecike.guiIpsecikeT[ j ].gid== dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.ipsecike.guiIpsecikeT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            case 'transformPolicyId':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.ipsectransform.guiIpsectransformTNum); j<len; j++)
                                    {
                                        switch(cgiList.ipsectransform.guiIpsectransformT[ j ].gid == dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.ipsectransform.guiIpsectransformT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            default:
                                tmp += dataObj[ id ][ cgiT ][i][ thID ];
                            }
                            
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);
                
                switch( parseInt(dataObj[ id ][ cgiT ][ i ].infoStatus) )
                {
                case 0:
                    $('#Disconnect-' + id + '-' + i).prop('disabled', true);
                    break;
                case 1:
                    $('#Connect-' + id + '-' + i).prop('disabled', true);
                    break;
                case 2:
                    $('#Connect-' + id + '-' + i).prop('disabled', true);
                    $('#Disconnect-' + id + '-' + i).prop('disabled', true);
                    break;
                }
                break;
            }
        }
        
        break;
    case 'ike_policy':
        cgiID = 'ipsecike';
        cgiT = 'guiIpsecikeT';
        cgiTNum = 'guiIpsecikeTNum';
        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="';
                tmp +=  ((trNo %2==0)? 'odd' : 'even');

                tmp += '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'cipher':
                            case 'hash':
                            case 'dhgroup':
                                tmp += cgiRef[ cgiID ][ thID ][ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;
                            default:
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            }

                            
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);

                break;
            }
        } 

        break;
    case 'transform_policy':
        cgiID = 'ipsectransform';
        cgiT = 'guiIpsectransformT';
        cgiTNum = 'guiIpsectransformTNum';
        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="';
                tmp +=  ((trNo %2==0)? 'odd' : 'even');

                tmp += '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">';
                            switch(thID)
                            {
                            case 'cipher':
                            case 'hash':
                            case 'pfsgroup':
                                tmp += cgiRef[ cgiID ][ thID ][ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;
                            default:
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            }

                            
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);

                break;
            }
        } 

        break;
    case 'rules':
        cgiT = 'guiRulesT';
        cgiTNum = 'guiRulesTNum';
        cgiRef.rules.move = [];

        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="';
                tmp +=  ((trNo %2==0)? 'odd' : 'even');
                if (!isNaN(parseInt(dataObj[ id ][ cgiT ][ i ].fromZone)))
                    tmp += ' fromZone' + dataObj[ id ][ cgiT ][ i ].fromZone;
                if (!isNaN(parseInt(dataObj[ id ][ cgiT ][ i ].toZone)))
                    tmp += ' toZone' + dataObj[ id ][ cgiT ][ i ].toZone;
                tmp += '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 

                            switch( thID )
                            {
                            case 'priority':
                                tmp += trNo;
                                break;
                            case 'enabled':
                            case 'log':
                            case 'matchAction':
                            
                                tmp += cgiRef[ id ][ thID ][ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;
                            case 'fromZone':
                            case 'toZone':
                                for (var j=0; j < parseInt(cgiList.common_zoneIf_list.guiZoneIfTNum); j++)
                                {
                                    switch( parseInt( dataObj[ id ][ cgiT ][ i ][ thID ] ) == parseInt( cgiList.common_zoneIf_list.guiZoneIfT[ j ].gid ) )
                                    {
                                    case true:
                                        tmp += cgiList.common_zoneIf_list.guiZoneIfT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            case 'serviceApplicationUrl':
                                if (parseInt( dataObj[ id ][ cgiT ][ i ].service ) > 0) {
                                    for (var j=0; j < parseInt(cgiList.common_service_list.guiServiceTNum); j++)
                                    {
                                        switch( parseInt( dataObj[ id ][ cgiT ][ i ].service ) == cgiList.common_service_list.guiServiceT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_service_list.guiServiceT[ j ].name;
                                            break;
                                        }
                                    }
                                    
                                    for (var j=0; j < parseInt(cgiList.common_gService_list.guiGServiceTNum); j++)
                                    {
                                        switch( parseInt( dataObj[ id ][ cgiT ][i ].service ) == cgiList.common_gService_list.guiGServiceT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_gService_list.guiGServiceT[ j ].name;
                                            break;
                                        }
                                    }
                                }else if ( parseInt( dataObj[ id ][ cgiT ][ i ].application ) > 0) 
                                    tmp += "Not this phase";
                                else if (parseInt( dataObj[ id ][ cgiT ][ i ].url ) > 0) 
                                    tmp += "Not this phase";
                                else 
                                    tmp += 'ANY';
                                break;
                            case 'sourceAddressUser':
                                
                                if (parseInt( dataObj[ id ][ cgiT ][ i ].sourceAddress) > 0) {
                                    for (var j=0; j < parseInt(cgiList.common_addr_list.guiAddrTNum); j++)
                                    {
                                        switch( parseInt( dataObj[ id ][ cgiT ][ i ].sourceAddress ) == cgiList.common_addr_list.guiAddrT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                    
                                    for (var j=0; j < parseInt(cgiList.common_gAddr_list.guiGAddrTNum); j++)
                                    {
                                        switch( parseInt( dataObj[ id ][ cgiT ][ i ].sourceAddress ) == cgiList.common_gAddr_list.guiGAddrT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_gAddr_list.guiGAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                }else if (parseInt( dataObj[ id ][ cgiT ][ i ].sourceUser ) > 0)
                                    tmp += "Not this phase";
                                else 
                                    tmp += 'ANY';
                                break;
                            case 'destinationAddressUser':
                            
                                if (parseInt(  dataObj[ id ][ cgiT ][ i ].destinationAddress) > 0) {
                                    for (var j=0; j < parseInt(cgiList.common_addr_list.guiAddrTNum); j++)
                                    {
                                        switch( parseInt( dataObj[ id ][ cgiT ][ i ].destinationAddress ) == cgiList.common_addr_list.guiAddrT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                    
                                    for (var j=0; j < parseInt(cgiList.common_gAddr_list.guiGAddrTNum); j++)
                                    {
                                        switch( parseInt( dataObj[ id ][ cgiT ][ i ].destinationAddress ) == cgiList.common_gAddr_list.guiGAddrT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_gAddr_list.guiGAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                }else if (parseInt( dataObj[ id ][ cgiT ][ i ].destinationUser ) > 0)
                                    tmp += "Not this phase";
                                else 
                                    tmp += 'ANY';
                                 
                                break;
                            case 'schedule':
                                for (var j=0; j < parseInt(cgiList.common_time_list.guiTimeTNum); j++)
                                {
                                    switch( parseInt( dataObj[ id ][ cgiT ][ i ][ thID ] ) == cgiList.common_time_list.guiTimeT[ j ].gid )
                                    {
                                    case true:
                                        tmp += cgiList.common_time_list.guiTimeT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            default:
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);
                /*
                if (!isNaN(parseInt(dataObj[ id ][ cgiT ][ i ].fromZone))) {
                    console.log('??????' + ' @ ' + dataObj[ id ][ cgiT ][ i ].fromZone);
                    $(tableBD + ' tr:eq(' + i + ')').addClass('fromZone' + dataObj[ id ][ cgiT ][ i ].fromZone);
                    console.log($(tableBD + ' tr:eq(' + i + ')'));
                }
                if (!isNaN(parseInt(dataObj[ id ][ cgiT ][ i ].toZone)))
                    $(tableBD + ' tr:eq(' + i + ')').addClass('toZone' + dataObj[ id ][ cgiT ][ i ].toZone);
                */
                cgiRef.rules.move.push( i );
                break;
            }
        }   
         
        if (cgiRef.rules.query)
            $('#Query-rules').click();
                 
        break;
    case 'static_nat':
        cgiT = 'guiStaticNatT';
        cgiTNum = 'guiStaticNatTNum';
        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 

                            switch(thID)
                            {
                            case 'seq':
                                tmp += trNo;
                                break;
                            case 'wanInterface':
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                            case 'publicIp':
                            case 'privateIp':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.common_addr_list.guiAddrTNum); j<len; j++)
                                    {
                                        switch(cgiList.common_addr_list.guiAddrT[ j ].gid == dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            }
                            
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);

                break;
            }
        }   
        break;
    case 'port_forwarding':
        cgiT = 'guiPortForwardingT';
        cgiTNum = 'guiPortForwardingTNum';
        
        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                           
                            switch(thID)
                            {
                            case 'seq':
                                tmp += trNo;
                                break;
                            case 'description':
                                tmp += dataObj[ id ][ cgiT ][ i ][ thID ];
                                break;
                            case 'wan':
                                tmp += cgiRef[ thID ].interfaces[ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;

                            case 'privateIp':
                            case 'wanIpId':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.common_addr_list.guiAddrTNum); j<len; j++)
                                    {
                                        switch(cgiList.common_addr_list.guiAddrT[ j ].gid == dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            case 'originalService':
                            case 'translatedService':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.common_service_list.guiServiceTNum); j<len; j++)
                                    {
                                        switch(cgiList.common_service_list.guiServiceT[ j ].gid== dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.common_service_list.guiServiceT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            }
                            
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);

                break;
            }
        }    
        
        break;
    case 'advanced_nat':
        cgiT = 'guiAdvancedNatT';
        cgiTNum = 'guiAdvancedNatTNum';
        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 

                            switch(thID)
                            {
                            case 'seq':
                                tmp += trNo;
                                break;
                            case 'enabled':
                                tmp += cgiRef.advancedNat[ thID ][ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                                break;
                            case 'fromIf':
                            case 'toIf':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.common_wanIf_list.guiWanIfTNum); j<len; j++)
                                    {
                                        switch(cgiList.common_wanIf_list.guiWanIfT[ j ].gid == dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.common_wanIf_list.guiWanIfT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            case 'originalSrc':
                            case 'originalDst':
                            case 'translatedSrc':
                            case 'translatedDst':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.common_addr_list.guiAddrTNum); j<len; j++)
                                    {
                                        switch(cgiList.common_addr_list.guiAddrT[ j ].gid == dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            case 'originalService':
                            case 'translatedService':
                                if (parseInt(dataObj[ id ][ cgiT ][ i ][ thID ])>0) {
                                    for (var j=0, len=parseInt(cgiList.common_service_list.guiServiceTNum); j<len; j++)
                                    {
                                        switch(cgiList.common_service_list.guiServiceT[ j ].gid== dataObj[ id ][ cgiT ][ i ][ thID ])
                                        {
                                        case true:
                                            tmp += cgiList.common_service_list.guiServiceT[ j ].name;
                                            break;
                                        }
                                    }
                                }
                                break;
                            }
                            
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);

                break;
            }
        }    
        break;
    case 'address_exceptions':
        cgiID = 'av_addr_exception';
        cgiT = 'excepT';
        cgiTNum = 'excepNum';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiTNum ]); i<len; i++)
        {
            switch( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) == 3)
            {
            case false:
                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        tmp += '<td id="' + thID + '-' + i + '">'; 
        
                        switch(thID)
                        {
                        
                        case 'Log':
                            tmp += cgiRef.antivirus.Log[ dataObj[ id ][ cgiT ][ i ][ thID ] ];
                            break;
                        case 'srcAddrType':
                            switch(parseInt( dataObj[ id ][ cgiT ][ i ][ thID ] ))
                            {
                            case 0:
                                for (var j=0, jlen = parseInt( cgiList.common_addr_list.guiAddrTNum ); j < jlen; j++)
                                {
                                    if (parseInt( dataObj[ id ][ cgiT ][ i ].srcAddrGid ) == parseInt( cgiList.common_addr_list.guiAddrT[ j ].gid ))
                                        tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                }
                                break;
                            case 1:
                                for (var j=0, jlen = parseInt( cgiList.common_gAddr_list.guiGAddrTNum ); j < jlen; j++)
                                {
                                    if (parseInt( dataObj[ id ][ cgiT ][ i ].srcGAddrGid ) == parseInt( cgiList.common_gAddr_list.guiGAddrT[ j ].gid ))
                                        tmp += cgiList.common_gAddr_list.guiGAddrT[ j ].name;
                                }
                                break;   
                            }
                            break;
                        case 'dstAddrType':
                            switch(parseInt( dataObj[ id ][ cgiT ][ i ][ thID ] ))
                            {
                            case 0:
                                for (var j=0, jlen = parseInt( cgiList.common_addr_list.guiAddrTNum ); j < jlen; j++)
                                {
                                    if (parseInt( dataObj[ id ][ cgiT ][ i ].dstAddrGid ) == parseInt( cgiList.common_addr_list.guiAddrT[ j ].gid ))
                                        tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                }
                                break;
                            case 1:
                                for (var j=0, jlen = parseInt( cgiList.common_gAddr_list.guiGAddrTNum ); j < jlen; j++)
                                {
                                    if (parseInt( dataObj[ id ][ cgiT ][ i ].dstGAddrGid ) == parseInt( cgiList.common_gAddr_list.guiGAddrT[ j ].gid ))
                                        tmp += cgiList.common_gAddr_list.guiGAddrT[ j ].name;
                                }
                                break;   
                            }
                            break;
                        }
                        tmp += '</td>';

                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);
        
                break;
            }
        }

        break;
    case 'mime':
        cgiID = 'av_file_exception';
        cgiT = 'mimeExcepT';
        cgiTNum = 'mimeExcepNum';
        for (var i=0, len=parseInt(dataObj.file_extensions.mimeExcepNum); i<len; i++)
        {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
            $(tableID + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                regObj = thClass.match(regRowAction);
                switch(regObj != null)
                {
                case true:
                    tmp += '<td class="buttonTD">';
                    for (var x in regObj){
                        switch(regDigit.test(x))
                        {
                        case true:
                            tmp += '<button id="' + regObj[x] + '-mime-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                            break;
                        }
                    }
                    tmp += '</td>';
                    break;
                case false:
                    // no class
                    tmp += '<td id="' + thID + '-' + i + '">'; 
                    tmp += dataObj.file_extensions.mimeExcepT[ i ][ thID ];
                    tmp += '</td>';
                    break;
                }
            });
            tmp += '</tr>';
            
            $(tableBD).append(tmp);
        }

        break;
    case 'file_extension':          
        // file ext
        cgiID = 'av_file_exception';
        cgiT = 'fileExcepT';
        cgiTNum = 'fileExcepNum';
        for (var i=0, len=parseInt(dataObj.file_extensions.fileExcepNum); i<len; i++)
        {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
            $(tableID + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                regObj = thClass.match(regRowAction);
                switch(regObj != null)
                {
                case true:
                    tmp += '<td class="buttonTD">';
                    for (var x in regObj){
                        switch(regDigit.test(x))
                        {
                        case true:
                            tmp += '<button id="' + regObj[x] + '-file_extension-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                            break;
                        }
                    }
                    tmp += '</td>';
                    break;
                case false:
                    // no class
                    tmp += '<td id="' + thID + '-' + i + '">'; 
                    tmp += dataObj.file_extensions.fileExcepT[ i ][ thID ];
                    tmp += '</td>';
                    break;
                }
            });
            tmp += '</tr>';
            
            $(tableBD).append(tmp);
        }

    
    
        break;
    case 'user':
        cgiT = 'userListT';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiT ].length); i<len; i++)
        {
            if ( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) != 3) {

                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
        
                            switch(thID)
                            {
                            case 'userName':
                                tmp += dataObj[ id ][ cgiT ][ i ].name;
                                break;
                            case 'userGroup':
                                for (var j=0, glen=dataObj.group.groupListT.length; j<glen; j++)
                                {
                                    if ( dataObj.group.groupListT[ j ].gid == dataObj[ id ][ cgiT ][ i ].groupId )
                                        tmp += dataObj.group.groupListT[ j ].name;
                                }
                                break;
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);
        
            }
        }
        
        break;
    case 'group':
        cgiT = 'groupListT';

        for (var i=0, len=parseInt(dataObj[ id ][ cgiT ].length); i<len; i++)
        {
            if ( parseInt(dataObj[ id ][ cgiT ][ i ].cgiAction) != 3) {

                var tmp = '<tr class="' + ((trNo %2==0)? 'odd' : 'even') + '">';
                trNo++;
                $(tableHD + ' tr th').each(function(index) {
                    // each col
                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                    
                    regObj = thClass.match(regRowAction);
                    
                    switch(regObj != null)
                    {
                    case true:
                        $(this).addClass('rowAction BT'+regObj.length);
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                if (!(i==0 && regObj[x] == 'Delete'))
                                    tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                    case false:
                        switch( regCheckbox.test(thClass) )
                        {
                        case true:
                            
                            tmp += '<td class="checkTD">' + ((i>0)? '<input type="checkbox" value="' + i + '" />' : "") + '</td>';
                            break;
                        case false:
                            tmp += '<td id="' + thID + '-' + i + '">'; 
        
                            switch(thID)
                            {
                            case 'groupName':
                                tmp += dataObj[ id ][ cgiT ][ i ].name;
                                if ( dataObj[ id ][ cgiT ][ i ].name == cgiRef.group.defaultGroup )
                                    cgiRef.group.defaultGrouGid = dataObj[ id ][ cgiT ][ i ].gid;
                                break;
                            case 'groupMember':
                                var arr = [];
                                for (var j=0, ulen=dataObj.user.userListT.length; j<ulen; j++)
                                {
                                    switch( dataObj.user.userListT[ j ].groupId == dataObj[ id ][ cgiT ][ i ].gid )
                                    {
                                    case true:
                                        arr.push( dataObj.user.userListT[ j ].name );
                                        break;
                                    }
                                }
                                tmp += arr.join(';');
                                break;
                            case 'groupServices':
                                switch( parseInt(dataObj[ id ][ cgiT ][ i ].webLoginPriv) )
                                {
                                case 0:
                                    tmp += 'Captive Portal:' + cgiRef.group.portalPriv[ dataObj[ id ][ cgiT ][ i ].portalPriv ];
                                    break;
                                default:
                                    tmp += 'Web Login:'+ cgiRef.group.webLoginPriv[ dataObj[ id ][ cgiT ][ i ].webLoginPriv ];
                                }
                                break;
                            }
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                    
                });
                tmp += '</tr>';
                
                $(tableBD).append(tmp);
        
            }
        }

        break;
    }
}

function cgiCombo(id) {
    switch(id)
    {
    case 'traffic_statistics':
        var cgiID = 'trafficStatisticsPort';
        var cgiT = 'guiTrafficStatisticsPortT';
        var tID = 'port';
        var tableID = '#table-' + tID;
        var tableBD = tableID + ' > tbody';
        var tableHD = tableID + ' > thead';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.port = $.extend({}, data);
                
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=dataObj[ tID ][ cgiT ].length; i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                    $(tableID + ' tr th').each(function(index) {
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');

                        tmp += '<td id="' + thID + '-' + i + '">'; 
                        tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace(tID + '-','') ];
                        tmp += '</td>';
                    });
                    tmp += '</tr>';

                    $(tableBD).append(tmp);
                    
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction(tID);
            }
        }).done(function() {
        
            var cgiID = 'trafficStatisticsWan';
            var cgiT = 'guiTrafficStatisticsWanT';
            var tID = 'wan';
            var tableID = '#table-' + tID;
            var tableBD = tableID + ' > tbody';
            var tableHD = tableID + ' > thead';
            $.ajax({
                url: 'cgi-bin/' + cgiID + '.cgi',
                dataType: 'json',
                success: function(data) {
                    dataObj.wan = $.extend({}, data);
                    
                    if ($(tableBD).length == 0)
                        $(tableID).append('<tbody>');
                    for (var i=0, len=dataObj[ tID ][ cgiT ].length; i<len; i++)
                    {
                        var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                        $(tableID + ' tr th').each(function(index) {
                            var thID = $(this).attr('id');
                            var thClass = $(this).attr('class');
    
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace(tID + '-','') ];
                            tmp += '</td>';
                        });
                        tmp += '</tr>';
    
                        $(tableBD).append(tmp);
                        
                    }
                    if ($(tableHD).length > 0)
                        $(tableHD + ' tr th').addClass('ui-state-default');
                    genTableAction(tID);
                }
            }).done( function() {
        
                var cgiID = 'trafficStatisticsLan';
                var cgiT = 'guiTrafficStatisticsLanT';
                var tID = 'lan';
                var tableID = '#table-' + tID;
                var tableBD = tableID + ' > tbody';
                var tableHD = tableID + ' > thead';
                $.ajax({
                    url: 'cgi-bin/' + cgiID + '.cgi',
                    dataType: 'json',
                    success: function(data) {
                        dataObj.lan = $.extend({}, data);
                        
                        if ($(tableBD).length == 0)
                            $(tableID).append('<tbody>');
                        for (var i=0, len=dataObj[ tID ][ cgiT ].length; i<len; i++)
                        {
                            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                            $(tableID + ' tr th').each(function(index) {
                                var thID = $(this).attr('id');
                                var thClass = $(this).attr('class');
        
                                tmp += '<td id="' + thID + '-' + i + '">'; 
                                tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace(tID + '-','') ];
                                tmp += '</td>';
                            });
                            tmp += '</tr>';
        
                            $(tableBD).append(tmp);
                            
                        }
                        if ($(tableHD).length > 0)
                            $(tableHD + ' tr th').addClass('ui-state-default');
                        genTableAction(tID);
                    }
                }).done( function() {
                
                    var cgiID = 'trafficStatisticsVlan';
                    var cgiT = 'guiTrafficStatisticsVlanT';
                    var tID = 'vlan';
                    var tableID = '#table-' + tID;
                    var tableBD = tableID + ' > tbody';
                    var tableHD = tableID + ' > thead';
                    $.ajax({
                        url: 'cgi-bin/' + cgiID + '.cgi',
                        dataType: 'json',
                        success: function(data) {
                            dataObj.vlan = $.extend({}, data);
                            
                            if ($(tableBD).length == 0)
                                $(tableID).append('<tbody>');
                            for (var i=0, len=dataObj[ tID ][ cgiT ].length; i<len; i++)
                            {
                                var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                                $(tableID + ' tr th').each(function(index) {
                                    var thID = $(this).attr('id');
                                    var thClass = $(this).attr('class');
            
                                    tmp += '<td id="' + thID + '-' + i + '">'; 
                                    tmp += dataObj[ tID ][ cgiT ][ i ][ thID.replace(tID + '-','') ];
                                    tmp += '</td>';
                                });
                                tmp += '</tr>';
            
                                $(tableBD).append(tmp);
                                
                            }
                            if ($(tableHD).length > 0)
                                $(tableHD + ' tr th').addClass('ui-state-default');
                            genTableAction(tID);
                        }
                    }).done(function() {
                        cgiRefreshStart(id);
                    });
                });
            });
        });
        break;
        
    case 'users_and_groups':

        // user & group need to be loaded before deal, due to some cols depends on each
        
        $.ajax({
            url: 'cgi-bin/userList.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.user = $.extend({}, data);
                $.ajax({
                    url: 'cgi-bin/groupList.cgi',
                    dataType: 'json',
                    success: function(data) {
                        dataObj.group = $.extend({}, data);

                        for (var node in dataObj)
                        {
                            var tableID = '#table-' + node ;
                            var tableBD = tableID + ' > tbody';
                            var tableHD = tableID + ' > thead';
                            var nodeList = node + 'ListT';
                            if ($(tableBD).length == 0)
                                $(tableID).append('<tbody>');
                            // group table
                            for (var i=0, len=dataObj[ node ][ nodeList ].length; i<len; i++)
                            {
                                var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                                $(tableID + ' tr th').each(function(index) {
                                    // each col
                                    var thID = $(this).attr('id');
                                    var thClass = $(this).attr('class');
                                    switch(thClass == undefined)
                                    {
                                    case true:
                                        // no class
                                        tmp += '<td id="' + thID + '-' + i + '">'; 
                                        switch(thID)
                                        {
                                        case 'groupName':
                                            tmp += dataObj[ node ][ nodeList ][ i ].name;
                                            if ( dataObj[ node ][ nodeList ][ i ].name == cgiRef.group.defaultGroup )
                                                cgiRef.group.defaultGrouGid = dataObj[ node ][ nodeList ][ i ].gid;
                                            break;
                                        case 'userName':
                                            tmp += dataObj[ node ][ nodeList ][ i ].name;
                                            break;
                                        case 'groupMember':
                                            var arr = [];
                                            for (var j=0, ulen=dataObj.user.userListT.length; j<ulen; j++)
                                            {
                                                switch( dataObj.user.userListT[ j ].groupId == dataObj[ node ][ nodeList ][ i ].gid )
                                                {
                                                case true:
                                                    arr.push( dataObj.user.userListT[ j ].name );
                                                    break;
                                                }
                                            }
                                            tmp += arr.join(';');
                                            break;
                                        case 'groupServices':
                                            switch( parseInt(dataObj[ node ][ nodeList ][ i ].webLoginPriv) )
                                            {
                                            case 0:
                                                tmp += 'Captive Portal:' + cgiRef.group.portalPriv[ dataObj[ node ][ nodeList ][ i ].portalPriv ];
                                                break;
                                            default:
                                                tmp += 'Web Login:'+ cgiRef.group.webLoginPriv[ dataObj[ node ][ nodeList ][ i ].webLoginPriv ];
                                            }
                                            break;
                                        case 'userGroup':
                                            for (var j=0, glen=dataObj.group.groupListT.length; j<glen; j++)
                                            {
                                                switch( dataObj.group.groupListT[ j ].gid == dataObj[ node ][ nodeList ][ i ].groupId )
                                                {
                                                case true:
                                                    tmp += dataObj.group.groupListT[ j ].name;
                                                    break;
                                                }
                                            }
                                            break;
                                        }
                                        tmp += '</td>';
                                        break;
                                    case false:
                                        regObj = thClass.match(regRowAction);
                                        switch(true)
                                        {
                                        case (regObj != null):
                                            $(this).addClass('rowAction BT'+regObj.length);
                                            tmp += '<td class="buttonTD">';
                                            for (var x in regObj){
                                                switch(regDigit.test(x))
                                                {
                                                case true:
                                                    if (!(i == 0 && regObj[x] == 'Delete' && node == 'group'))
                                                        tmp += '<button id="' + regObj[x] + '-' + node + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                                    break;
                                                }
                                            }
                                            tmp += '</td>';
                                            break;
                                        case (regCheckbox.test(thClass)):
                                            tmp += '<td class="checkTD">';
                                            if (! (i == 0 && node == 'group') )
                                                tmp += '<input type="checkbox" value="' + i + '" />';
                                                
                                            tmp += '</td>';
                                            break;
                                        }
                                        break;
                                    }
                                });
                                tmp += '</tr>';

                                $(tableBD).append(tmp);
                            }
                            if ($(tableHD).length > 0)
                                $(tableHD + ' tr th').addClass('ui-state-default');
                            genTableAction(node);
                        }
                    }
                });
            }
        });
        break;
    case 'rules':
        $.ajax({
            url: 'cgi-bin/rules.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.rules= $.extend({}, data);
                var cgiID     = 'rules';
                var tID         = 'rules';
                var tableID = '#table-' + tID;
                var guiID     = 'guiRulesT';
                var guiLen    = 'guiRulesTNum';
                var tableBD = tableID + ' > tbody';
                var tableHD = tableID + ' > thead';
                var zoneClass = " zone";
                cgiRef[ id ].move = [];
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=parseInt(data[ guiLen ]), max=parseInt(data[ guiLen ])-1; i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                    $(tableID + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');
                        
                        switch(thClass == undefined)
                        {
                        case true:
                            // no class
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch( thID )
                            {
                            case 'priority':
                                tmp += i + 1;
                                break;
                            case 'enabled':
                            case 'log':
                            case 'matchAction':
                            
                                tmp += cgiRef[ cgiID ][ thID ][ data[ guiID ][ i ][ thID ] ];
                                break;
                            case 'fromZone':
                            case 'toZone':
                                for (var j=0; j < parseInt(cgiList.common_zoneIf_list.guiZoneIfTNum); j++)
                                {
                                    switch( parseInt( data[ guiID ][ i ][ thID ] ) == parseInt( cgiList.common_zoneIf_list.guiZoneIfT[ j ].gid ) )
                                    {
                                    case true:
                                        tmp += cgiList.common_zoneIf_list.guiZoneIfT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            case 'serviceApplicationUrl':
                                if (parseInt( data[ guiID ][ i ].service ) > 0) {
                                    for (var j=0; j < parseInt(cgiList.common_service_list.guiServiceTNum); j++)
                                    {
                                        switch( parseInt( data[ guiID ][i ].service ) == cgiList.common_service_list.guiServiceT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_service_list.guiServiceT[ j ].name;
                                            break;
                                        }
                                    }
                                    
                                    for (var j=0; j < parseInt(cgiList.common_gService_list.guiGServiceTNum); j++)
                                    {
                                        switch( parseInt( data[ guiID ][i ].service ) == cgiList.common_gService_list.guiGServiceT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_gService_list.guiGServiceT[ j ].name;
                                            break;
                                        }
                                    }
                                }else if ( parseInt( data[ guiID ][ i ].application ) > 0) 
                                    tmp += "Not this phase";
                                else if (parseInt( data[ guidID ][ i ].url ) > 0) 
                                    tmp += "Not this phase";
                                else 
                                    tmp += 'ANY';
                                break;
                            case 'sourceAddressUser':
                                
                                if (parseInt( data[ guiID ][ i ].sourceAddress) > 0) {
                                    for (var j=0; j < parseInt(cgiList.common_addr_list.guiAddrTNum); j++)
                                    {
                                        switch( parseInt( data[ guiID ][i ].sourceAddress ) == cgiList.common_addr_list.guiAddrT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                    
                                    for (var j=0; j < parseInt(cgiList.common_gAddr_list.guiGAddrTNum); j++)
                                    {
                                        switch( parseInt( data[ guiID ][i ].sourceAddress ) == cgiList.common_gAddr_list.guiGAddrT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_gAddr_list.guiGAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                }else if (parseInt( data[ guiID ][ i ].sourceUser ) > 0)
                                    tmp += "Not this phase";
                                else 
                                    tmp += 'ANY';
                                break;
                            case 'destinationAddressUser':
                            
                                if (parseInt( data[ guiID ][ i ].destinationAddress) > 0) {
                                    for (var j=0; j < parseInt(cgiList.common_addr_list.guiAddrTNum); j++)
                                    {
                                        switch( parseInt( data[ guiID ][i ].destinationAddress ) == cgiList.common_addr_list.guiAddrT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                    
                                    for (var j=0; j < parseInt(cgiList.common_gAddr_list.guiGAddrTNum); j++)
                                    {
                                        switch( parseInt( data[ guiID ][i ].destinationAddress ) == cgiList.common_gAddr_list.guiGAddrT[ j ].gid )
                                        {
                                        case true:
                                            tmp += cgiList.common_gAddr_list.guiGAddrT[ j ].name;
                                            break;
                                        }
                                    }
                                }else if (parseInt( data[ guiID ][ i ].destinationUser ) > 0)
                                    tmp += "Not this phase";
                                else 
                                    tmp += 'ANY';
                                 
                                break;
                            case 'schedule':
                                for (var j=0; j < parseInt(cgiList.common_time_list.guiTimeTNum); j++)
                                {
                                    switch( parseInt( data[ guiID ][i ][ thID ] ) == cgiList.common_time_list.guiTimeT[ j ].gid )
                                    {
                                    case true:
                                        tmp += cgiList.common_time_list.guiTimeT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            default:
                                tmp += data[ guiID ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case false:
                            regObj = thClass.match(regRowAction);
                            switch(true)
                            {
                            case (regObj != null):
                                $(this).addClass('rowAction BT'+regObj.length);
                                tmp += '<td class="buttonTD">';
                                for (var x in regObj)
                                {
                                    switch(regDigit.test(x))
                                    {
                                    case true:
                                        tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon" title="' + regObj[x] + '"></span></button>';
                                        break;
                                    }
                                }
                                tmp += '</td>';
                                break;
                            case (regCheckbox.test(thClass)):
                                tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                                break;
                            case (regSelect.test(thClass)):
                                tmp += '<td class="selectTD">'
                                tmp += '<select id="' + thID + '-' + i + '">';
                                tmp += genSelectOption(thID);
                                tmp += '</select>';
                                tmp += '</td>';
                                break;
                            }
                            break;
                        }
                    });
                    tmp += '</tr>';
                    
                    $(tableBD).append(tmp);
                    
                    if (!isNaN(parseInt(dataObj[ id ][ guiID ][ i ].fromZone))) {
                        $(tableBD + ' tr:eq(' + i + ')').addClass('fromZone' + dataObj[ id ][ guiID ][ i ].fromZone);
                        console.log($(tableBD + ' tr:eq(' + i + ')'));
                    }
                    if (!isNaN(parseInt(dataObj[ id ][ guiID ][ i ].toZone)))
                        $(tableBD + ' tr:eq(' + i + ')').addClass('toZone' + dataObj[ id ][ guiID ][ i ].toZone);
                    
                    cgiRef.rules.move.push( i );
                    
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction(tID);
                
                cgiComboSelectOption('query-fromZone');
                cgiComboSelectOption('query-toZone');
            }
        });
        
        $.ajax({
            url: 'cgi-bin/defaultPolicy.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj.default_policy = $.extend({}, data);
                var cgiID = 'defaultPolicy';
                var tID         = 'default_policy';
                var tableID = '#table-' + tID;
                var guiID     = 'guiDefaultPolicyT';
                var guiLen    = 'guiDefaultPolicyTNum';
                var tableBD = tableID + ' > tbody';
                var tableHD = tableID + ' > thead';
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=parseInt(data[ guiLen ]); i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                    var arr = [];
                    $(tableID + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');
                        
                        switch(thClass == undefined)
                        {
                        case true:
                            // no class
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch( thID )
                            {
                            default:
                                tmp += data[ guiID ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case false:
                            regObj = thClass.match(regRowAction);
                            switch(true)
                            {
                            case (regObj != null):
                                $(this).addClass('rowAction BT'+regObj.length);
                                tmp += '<td class="buttonTD">';
                                for (var x in regObj)
                                {
                                    switch(regDigit.test(x))
                                    {
                                    case true:
                                        tmp += '<button id="' + regObj[x] + '-' + id + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon" title="' + regObj[x] + '"></span></button>';
                                        break;
                                    }
                                }
                                tmp += '</td>';
                                break;
                            case (regCheckbox.test(thClass)):
                                tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                                break;
                            case (regSelect.test(thClass)):
                                tmp += '<td class="selectTD">'
                                tmp += '<select id="' + thID + '-' + i + '">';
                                tmp += genSelectOption(thID);
                                tmp += '</select>';
                                tmp += '</td>';
                                break;
                            }
                            break;
                        }
                    });
                    tmp += '</tr>';
                    $(tableBD).append(tmp);
                    $('#policy-' + i).val( data[guiID ][ i ].policy);
                    
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction(tID);
            }
        });
        break;
    case 'dynamic_pat':
        var cgiID = 'dynamicPat';
        $.ajax({
            url: 'cgi-bin/' + cgiID +'.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);;
                // pat settings
                var tID         = 'pat_settings';
                var tableID = '#table-' + tID;
                var guiID     = 'guiDynamicPatT';
                var guiLen    = 'guiDynamicPatTNum';
                var tableBD = tableID + ' > tbody';
                var tableHD = tableID + ' > thead';
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=parseInt(data[ guiLen ]); i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                    var arr = [];
                    var off = [];
                    $(tableID + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');
                        
                        switch(thClass == undefined)
                        {
                        case true:
                            // no class
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += data[ guiID ][ i ][ thID ];
                            tmp += '</td>';
                            break;
                        case false:
                            tmp += '<td class="checkTD"><input type="checkbox" id="' + thID + '-' + i +'" value="' + i + '" /></td>';
                            switch( parseInt( data[ guiID ][ i ][ thID ] ) )
                            {
                            case 1:
                                arr.push( '#' + thID + '-' + i );
                                break;
                            case 0:
                                break;
                            default:
                                off.push( '#' + thID + '-' + i );
                                break;
                            }
                            break;
                        }
                    });
                    tmp += '</tr>';
                    
                    $(tableBD).append(tmp);
                    for (var node in arr)
                        $(arr[node]).attr('checked', true);
                    for (var node in off)
                        $(off[node]).prop('disabled', true);
                    
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction(tID);
                // wan address settings
                tID         = 'wan_address_settings';
                tableID = '#table-' + tID;
                guiID     = 'guiWanAddressSettingT';
                guiLen    = 'guiWanAddressSettingTNum';
                tableBD = tableID + ' tbody';
                tableHD = tableID + ' thead';
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=parseInt(data[ guiLen ]); i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                    $(tableID + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');
                        switch(thClass == undefined)
                        {
                        case true:
                            // no class
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch( thID )
                            {
                            case 'mode':
                                tmp += cgiRef[ cgiID ][ thID ][ data[ guiID ][ i ][ thID ] ];
                                break;
                            case 'addressId':
                                for (var j=0, len=parseInt(cgiList.common_addr_list.guiAddrTNum); j<len; j++)
                                {
                                    switch( parseInt(cgiList.common_addr_list.guiAddrT[ j ].gid) == parseInt( data[ guiID ][ i ][ thID ] ) )
                                    {
                                    case true:
                                        tmp += cgiList.common_addr_list.guiAddrT[ j ].name;
                                        break;
                                    }
                                }
                                break;
                            default:
                                tmp += data[ guiID ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case false:
                            regObj = thClass.match(regRowAction);
                            switch(true)
                            {
                            case (regObj != null):
                                $(this).addClass('rowAction BT'+regObj.length);
                                tmp += '<td class="buttonTD">';
                                for (var x in regObj){
                                    switch(regDigit.test(x))
                                    {
                                    case true:
                                        tmp += '<button id="' + regObj[x] + '-' + tID + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                        break;
                                    }
                                }
                                tmp += '</td>';
                                break;
                            }
                            break;
                        }
                    });
                    tmp += '</tr>';
                    
                    $(tableBD).append(tmp);
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction(tID);
            }
        });
        break;
    case 'file_extensions':
        $.ajax({
            url: 'cgi-bin/av_file_exception.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                
                // mime
                var tableID = '#table-mime';
                var tableBD = tableID + ' > tbody';
                var tableHD = tableID + ' > thead';
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=parseInt(data.mimeExcepNum); i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                    $(tableID + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');
                        switch(thClass == undefined)
                        {
                        case true:
                            // no class
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += data.mimeExcepT[ i ][ thID ];
                            tmp += '</td>';
                            break;
                        case false:
                            regObj = thClass.match(regRowAction);
                            switch(true)
                            {
                            case (regObj != null):
                                $(this).addClass('rowAction BT'+regObj.length);
                                tmp += '<td class="buttonTD">';
                                for (var x in regObj){
                                    switch(regDigit.test(x))
                                    {
                                    case true:
                                        tmp += '<button id="' + regObj[x] + '-mime-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                        break;
                                    }
                                }
                                tmp += '</td>';
                                break;
                            case (regCheckbox.test(thClass)):
                                tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                                break;
                            }
                            break;
                        }
                    });
                    tmp += '</tr>';
                    
                    $(tableBD).append(tmp);
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction('mime');
                
                // file ext
                tableID = '#table-file_extension';
                tableBD = tableID + ' tbody';
                tableHD = tableID + ' thead';
                
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=parseInt(data.fileExcepNum); i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                    $(tableID + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');
                        switch(thClass == undefined)
                        {
                        case true:
                            // no class
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            tmp += data.fileExcepT[ i ][ thID ];
                            tmp += '</td>';
                            break;
                        case false:
                            regObj = thClass.match(regRowAction);
                            switch(true)
                            {
                            case (regObj != null):
                                $(this).addClass('rowAction BT'+regObj.length);
                                tmp += '<td class="buttonTD">';
                                for (var x in regObj){
                                    switch(regDigit.test(x))
                                    {
                                    case true:
                                        tmp += '<button id="' + regObj[x] + '-file_extension-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                        break;
                                    }
                                }
                                tmp += '</td>';
                                break;
                            case (regCheckbox.test(thClass)):
                                tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                                break;
                            }
                            break;
                        }
                    });
                    tmp += '</tr>';
                    
                    $(tableBD).append(tmp);
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction('file_extension');
            }
        });
        break;
    case 'address':
        $.ajax({
            url: 'cgi-bin/common_addr_list.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({},data);
                dataObj.common_addr_list = $.extend({}, data);
                var tID         = 'address';
                var tableID = '#table-' + tID;
                var guiID     = 'guiAddrT';
                var guiLen    = 'guiAddrTNum';
                var tableBD = tableID + ' > tbody';
                var tableHD = tableID + ' > thead';
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=parseInt(data[ guiLen ]); i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';

                    $(tableID + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');
                        switch(thClass == undefined)
                        {
                        case true:
                            // no class
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch( thID )
                            {
                            case 'num':
                                tmp += (i+1).toString();
                                break;
                            case 'detail':
                                tmp += cgiRef[ id ].type[ data[ guiID ][ i ].type ] + ': ';
                                switch( parseInt( data[ guiID ][ i ].type ) )
                                {
                                case 1:
                                    tmp += data[ guiID ][ i ].startIp;
                                    break;
                                case 2:
                                    tmp += data[ guiID ][ i ].startIp + '/' + data[ guiId ][ i ].netmask;
                                    break;
                                case 3:
                                    tmp += data[ guiID ][ i ].startIp + '-' + data[ guiId ][ i ].endIp;
                                    break;
                                case 4:
                                    tmp += data[ guiID ][ i ].mac;
                                    break;    
                                }
                                break;
                            case 'type':
                                tmp += cgiRef[ id ][ thID ][ data[ guiID ][ i ][ thID ] ];
                                break;
                            case 'name':
                                tmp += data[ guiID ][ i ][ thID ];
                                break;
                            }
                            tmp += '</td>';
                            break;
                        case false:
                            regObj = thClass.match(regRowAction);
                            switch(true)
                            {
                            case (regObj != null):
                                $(this).addClass('rowAction BT'+regObj.length);
                                tmp += '<td class="buttonTD">';
                                for (var x in regObj){
                                    switch(regDigit.test(x))
                                    {
                                    case true:
                                        tmp += '<button id="' + regObj[x] + '-' + tID + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                        break;
                                    }
                                }
                                tmp += '</td>';
                                break;
                            case (regCheckbox.test(thClass)):
                                tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                                break;
                            }
                            break;
                        }
                    });
                    tmp += '</tr>';
                    
                    $(tableBD).append(tmp);
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction(tID);
            }
        }).done(function() {
            // for member list, have to wait untill get address
            $.ajax({
                url: 'cgi-bin/common_gAddr_list.cgi',
                dataType: 'json',
                success: function(data) {
                    dataObj.group_address = $.extend({}, data);
                    dataObj.common_gAddr_list = $.extend({}, data);
                    var tID         = 'group_address';
                    var tableID = '#table-' + tID;
                    var guiID     = 'guiGAddrT';
                    var guiLen    = 'guiGAddrTNum';
                    var tableBD = tableID + ' > tbody';
                    var tableHD = tableID + ' > thead';
                    if ($(tableBD).length == 0)
                        $(tableID).append('<tbody>');
                    for (var i=0, len=parseInt(data[ guiLen ]); i<len; i++)
                    {
                        var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
    
                        $(tableID + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            var thClass = $(this).attr('class');
                            switch(thClass == undefined)
                            {
                            case true:
                                // no class
                                tmp += '<td id="' + thID + '-' + i + '">'; 
                                switch( thID )
                                {
                                case 'groupNum':
                                    tmp += (i+1).toString();
                                    break;
                                }
                                tmp += '</td>';
                                break;
                            case false:
                                regObj = thClass.match(regRowAction);
                                switch(true)
                                {
                                case (regObj != null):
                                    $(this).addClass('rowAction BT'+regObj.length);
                                    tmp += '<td class="buttonTD">';
                                    for (var x in regObj){
                                        switch(regDigit.test(x))
                                        {
                                        case true:
                                            tmp += '<button id="' + regObj[x] + '-' + tID + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                            break;
                                        }
                                    }
                                    tmp += '</td>';
                                    break;
                                case (regTooltip.test(thClass)):
                                    switch(thID)
                                    {
                                    case 'groupName':
                                        tmp += '<td id="' + thID + '-' + i +'" colspan="3" class="alignLeft">';
                                        tmp +=     '<div class="tooltipAccordion">';
                                        tmp +=        '<h4><a href="#">' + data[ guiID ][ i ].name + '</a></h4>';
                                        tmp +=        '<div id="div-' + thID + '-' + i + '">';
                                        tmp +=            tooltipTable( tID, thID + '-' + i, data[ guiID ][ i ].idList);
                                        tmp +=        '</div>';
                                        tmp +=     '</div>';
                                        tmp += '</td>';
                                        break;
                                    }
                                    break;
                                case (regCheckbox.test(thClass)):
                                    tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                                    break;
                                }
                                break;
                            }
                        });
                        tmp += '</tr>';
                        
                        $(tableBD).append(tmp);
                    }
                    if ($(tableHD).length > 0)
                        $(tableHD + ' tr th').addClass('ui-state-default');
                    genTableAction(tID);
                    $('.tooltipAccordion').accordion({
                        collapsible:true, 
                        active:false, 
                        autoHeight: false
                    });
                }
            });
        });
        break;
    case 'service':
        $.ajax({
            url: 'cgi-bin/common_service_list.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                dataObj.common_service_list = $.extend({}, data);
                var tID         = 'service';
                var tableID = '#table-' + tID;
                var guiID     = 'guiServiceT';
                var guiLen    = 'guiServiceTNum';
                var tableBD = tableID + ' > tbody';
                var tableHD = tableID + ' > thead';
                if ($(tableBD).length == 0)
                    $(tableID).append('<tbody>');
                for (var i=0, len=parseInt(data[ guiLen ]); i<len; i++)
                {
                    var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';

                    $(tableID + ' tr th').each(function(index) {
                        // each col
                        var thID = $(this).attr('id');
                        var thClass = $(this).attr('class');
                        switch(thClass == undefined)
                        {
                        case true:
                            // no class
                            tmp += '<td id="' + thID + '-' + i + '">'; 
                            switch( thID )
                            {
                            case 'num':
                                tmp += (i+1).toString();
                                break;
                            case 'type':
                                tmp += cgiRef[ tID ][ thID ][ data[ guiID ][ i ][ thID ] ];
                                break;
                            default:
                                tmp += data[ guiID ][ i ][ thID ];
                            }
                            tmp += '</td>';
                            break;
                        case false:
                            regObj = thClass.match(regRowAction);
                            switch(true)
                            {
                            case (regObj != null):
                                $(this).addClass('rowAction BT'+regObj.length);
                                tmp += '<td class="buttonTD">';
                                for (var x in regObj){
                                    switch(regDigit.test(x))
                                    {
                                    case true:
                                        tmp += '<button id="' + regObj[x] + '-' + tID + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                        break;
                                    }
                                }
                                tmp += '</td>';
                                break;
                            case (regCheckbox.test(thClass)):
                                tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                                break;
                            }
                            break;
                        }
                    });
                    tmp += '</tr>';
                    
                    $(tableBD).append(tmp);
                }
                if ($(tableHD).length > 0)
                    $(tableHD + ' tr th').addClass('ui-state-default');
                genTableAction(tID);
            }
        }).done( function() {
            // for member list, have to wait untill get services
            $.ajax({
                url: 'cgi-bin/common_gService_list.cgi',
                dataType: 'json',
                success: function(data) {
                    dataObj.group_service = $.extend({}, data);
                    dataObj.common_gService_list = $.extend({}, data);
                    var tID         = 'group_service';
                    var tableID = '#table-' + tID;
                    var guiID     = 'guiGServiceT';
                    var guiLen    = 'guiGServiceTNum';
                    var tableBD = tableID + ' > tbody';
                    var tableHD = tableID + ' > thead';
                    if ($(tableBD).length == 0)
                        $(tableID).append('<tbody>');
                    for (var i=0, len=parseInt(data[ guiLen ]); i<len; i++)
                    {
                        var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
                        $(tableID + ' tr th').each(function(index) {
                            // each col
                            var thID = $(this).attr('id');
                            var thClass = $(this).attr('class');
                            switch(thClass == undefined)
                            {
                            case true:
                                // no class
                                tmp += '<td id="' + thID + '-' + i + '">'; 
                                switch( thID )
                                {
                                case 'groupNum':
                                    tmp += (i+1).toString();
                                    break;
                                }
                                tmp += '</td>';
                                break;
                            case false:
                                regObj = thClass.match(regRowAction);
                                switch(true)
                                {
                                case (regObj != null):
                                    $(this).addClass('rowAction BT'+regObj.length);
                                    tmp += '<td class="buttonTD">';
                                    for (var x in regObj){
                                        switch(regDigit.test(x))
                                        {
                                        case true:
                                            tmp += '<button id="' + regObj[x] + '-' + tID + '-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                            break;
                                        }
                                    }
                                    tmp += '</td>';
                                    break;
                                case (regTooltip.test(thClass)):
                                    switch(thID)
                                    {
                                    case 'groupName':
                                        tmp += '<td id="' + thID + '-' + i +'" colspan="4" class="alignLeft">';
                                        tmp +=     '<div class="tooltipAccordion">';
                                        tmp +=        '<h4><a href="#">' + data[ guiID ][ i ].name + '</a></h4>';
                                        tmp +=        '<div id="div-' + thID + '-' + i + '">';
                                        tmp +=            tooltipTable( tID, thID + '-' + i, data[ guiID ][ i ].idList);
                                        tmp +=        '</div>';
                                        tmp +=     '</div>';
                                        tmp += '</td>';
                                        break;
                                    }
                                    break;
                                case (regCheckbox.test(thClass)):
                                    tmp += '<td class="checkTD"><input type="checkbox" value="' + i + '" /></td>';
                                    break;
                                }
                                break;
                            
                            }
                        });
                        
                        tmp += '</tr>';
                        $(tableBD).append(tmp);
                    }
                    if ($(tableHD).length > 0)
                        $(tableHD + ' tr th').addClass('ui-state-default');
                    genTableAction(tID);
                    $('.tooltipAccordion').accordion({
                        collapsible:true, 
                        active:false, 
                        autoHeight: false
                    });
                }
            });    
        });
        break;
    }
}

function tooltipTable( id, tableID, members ) {
    var tmp;
    if (members) {
        var arr = [];
        switch(id)
        {
        case 'group_service':
            arr = members.split(regSemicolon);
            tmp = '<table id="table-' + tableID + '" class="group_services">';
            
            for (var i=0, len=arr.length; i<len; i++)
            {
                for (var j=0; j < parseInt(dataObj.service.guiServiceTNum); j++)
                {
                    switch( parseInt(arr[i]) == parseInt(dataObj.service.guiServiceT[ j ].gid) )
                    {
                    case true:
                        tmp += '<tr>';
                        tmp += '<td>' + dataObj.service.guiServiceT[ j ].name + '</td>';
                        tmp += '<td>' + cgiRef.service.type[ dataObj.service.guiServiceT[ j ].type ] + '</td>';
                        tmp += '<td>' + dataObj.service.guiServiceT[ j ].param1 + '</td>';
                        tmp += '<td>' + dataObj.service.guiServiceT[ j ].param2 + '</td>';
                        tmp += '</tr>';
                        break;
                    }
                }                
            }
            
            tmp += '</table>';
            break;
        case 'group_address':
            arr = members.split(regSemicolon);
            tmp = '<table id="table-' + tableID + '" class="group_address">';
            
            for (var i=0, len=arr.length; i<len; i++)
            {
                for (var j=0; j < parseInt(dataObj.address.guiAddrTNum); j++)
                {
                    switch( parseInt(arr[i]) == parseInt(dataObj.address.guiAddrT[ j ].gid) )
                    {
                    case true:
                        tmp += '<tr>';
                        tmp += '<td>' + dataObj.address.guiAddrT[ j ].name + '</td>';
                        
                        tmp += '<td>';
                        switch(parseInt( dataObj.address.guiAddrT[ j ].type ))
                        {
                        case 1:
                            tmp += dataObj.address.guiAddrT[ j ].startIp + '/255.255.255.255';
                            break;
                        case 2:
                            tmp += dataObj.address.guiAddrT[ j ].startIp + '/' + dataObj.address.guiAddrT[ j ].netmask;
                            break;
                        case 3:
                            tmp += dataObj.address.guiAddrT[ j ].startIp + '-' + dataObj.address.guiAddrT[ j ].endIp;
                            break;
                        case 4:
                            tmp += dataObj.address.guiAddrT[ j ].mac;
                            break;
                        }
                        tmp += '</td>';
                        tmp += '<td>' + cgiRef.address.type[ dataObj.address.guiAddrT[ j ].type ] + '</td>';
                        tmp += '</tr>';
                        break;
                    }
                }                
            }
            tmp += '</table>';
            break;
        }
    }else
        tmp = "Sorry, no member yet!";
    return tmp;
}

function genAliasTable( id, data ) {
    var tableID = '#table-ip_alias';
    var tableBD = tableID + ' > tbody';
    var tableHD = tableID + ' > thead';
    var len = 0;
    var cnt = 0;
    var reg;
    cgiIpAlias = [];
    if ($(tableBD).length == 0)
        $(tableID).append('<tbody>');
    
    if (data && regIpAlias.test(data.address)) {
        var arrObj = {};
        arrObj.address = data.address.split(regSemicolon);
        arrObj.netmask = data.netmask.split(regSemicolon);
        len = arrObj.address.length;
        
        for (var i=0; i < len; i++) {
            cgiIpAlias.push( {'address': arrObj.address[ i ], 'netmask': arrObj.netmask[ i ]} );
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
            $(tableID + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                switch(thClass == undefined)
                {
                case true:
                    // no class
                    tmp += '<td id="' + thID + '-' + i + '">';
                    tmp += arrObj[ thID.replace('ipAliasT-','') ][ i ];
                    tmp += '</td>';
                    break;
                case false:
                    regObj = thClass.match(regRowAction);

                    if (regObj != null) {
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                tmp += '<button id="' + regObj[x] + '-ip_alias-' + i + '" class="' + regObj[x] +    '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';

                    }
                    break;
                }
            });
            tmp += '</tr>';
            $(tableBD).append(tmp);
        }
    }
    if ($(tableHD).length > 0) 
        $(tableHD + ' tr th').addClass('ui-state-default');
    if ($(tableID).length > 0)
        genTableAction('ip_alias');
}

function genAccessControl(id, data) {
    var tableID = '#table-' + id;
    var tableSBD = '#sub-table-' + id + ' > tbody';
    var tableHD = tableID + ' > thead';
    var len = 0;
    var reg;
    $('.ifAccessControl').hide();
    if (data && parseInt(data.vpnaclTNum) > 0) {
        $('.ifAccessControl').show();

        len = parseInt(data.vpnaclTNum);

        for (var i=0; i < len; i++) {
            var tmp = '<tr class="' + ((i%2==0)? 'odd' : 'even') + '">';
            $(tableID + ' tr th').each(function(index) {
                // each col
                var thID = $(this).attr('id');
                var thClass = $(this).attr('class');
                
                switch($(this).hasClass('selectCol'))
                {
                case true:
                    tmp += '<td class="selectTD">'
                    tmp += '<select id="' + thID + '-' + i + '">';

                    tmp += '</select>';
                    tmp += '</td>';
                    break;
                case false:
                    tmp += '<td class="Fixed200" id="' + thID + '-' + i + '">';
                    tmp += data.vpnaclT[ i ][ thID.replace(id + '-','') ];
                    tmp += '</td>';
                    break;
                }
            });
            tmp += '</tr>';
            $(tableSBD).append(tmp);
            $('#' + id + '-actionType-' + i).append( genSelectOption( id + '-actionType') ).val( data.vpnaclT[ i ].actionType );
        }
        if ($(tableHD).length > 0)
            $(tableHD + ' tr th').addClass('ui-state-default');
    }
    
}

function cgiForm(id) {
    var cgiID;
    switch(id)
    {
    case 'multiwan':
        cgiID = 'multiwan';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                for (var node in data)
                {
                    switch(node)
                    {
                    case 'mode':
                        $('input[name=mode]').each(function() {
                            switch($(this).val() == data[ node ])
                            {
                            case true:
                                $(this).attr('checked', true).trigger('click');
                                break;
                            }
                        });
                        break;
                    default:
                        $('#' + node).val( data[ node ] );
                        break;
                    }
                }

            }
        });
        break;
    case 'routing':
        cgiID = 'routing';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                $('input[name=routeMode]').each( function() {
                    switch( $(this).val() == data.routeMode )
                    {
                    case true:
                        $(this).click();
                        break;
                    }
                });
                $('input[name=protoType]').each( function() {
                    switch( $(this).val() == data.protoType )
                    {
                    case true:
                        $(this).click();
                        break;
                    }
            
                });
            }
        });

        break;
    // antivirus
    case 'general_settings':
        cgiID = 'av_general';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                var tmp = "";
                for (var node in data)
                {
                    
                    switch(node)
                    {
                    case 'selectedZoneNum':
                        break;
                    case 'selectedZonesT':
                        
                        for (var i=0, len=parseInt(cgiList.common_zoneIf_list.guiZoneIfTNum); i < len; i++) 
                        {
                            var pool = true;
                            for (var j=0, jlen=parseInt(data.selectedZonesNum); j<jlen; j++) 
                            {
                                if (parseInt(cgiList.common_zoneIf_list.guiZoneIfT[ i ].gid) == parseInt(data.selectedZonesT[ j ].gid)) {
                                    pool = false;
                                    $('#selectedZonesT').append('<option value="' + cgiList.common_zoneIf_list.guiZoneIfT[ i ].gid + '">' + cgiList.common_zoneIf_list.guiZoneIfT[ i ].name + '</option>');
                                    break;
                                }
                            }
                            if (pool) {
                                $('#selectedZonesTPool').append('<option value="' + cgiList.common_zoneIf_list.guiZoneIfT[ i ].gid + '">' + cgiList.common_zoneIf_list.guiZoneIfT[ i ].name + '</option>');
                            }
                        }
                        break;
                    case 'maxFileSize':
                    case 'httpAct':
                    case 'ftpAct':
                    case 'smtpAct':
                    case 'pop3Act':
                        $('#' + node).val( data[ node ] );
                        break;
                    default:
                        switch( parseInt( data[ node ] ) )
                        {
                        case 1:
                            $('#' + node).attr('checked', true);
                            break;
                        }
                    }
                }
            }
        });
        break;
    case 'http_notification':
        cgiID = 'av_http_notify';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                $('#httpNotify').val(data.httpNotify);
            }
        });
        break;
    case 'email_notification':
        cgiID = 'av_email_notify';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                for (var node in data)
                {
                    switch(node)
                    {
                    case 'mailTag':
                        $('#' + node).val( data[ node ] );
                        
                        break;
                    case 'mailContent':
                        $('#' + node).val( data[ node ] );
                        break;
                    default:
                        $('#' + node).html( data[ node ] );
                    }
                }
            }
            
        });
        break;
    case 'signature':
        cgiID = 'av_sig';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                for (var node in data)
                {
                    switch(node)
                    {
                    case 'autoUpdate':
                    case 'schedule':
                        switch( parseInt( data[ node ] ) )
                        {
                        case 1:
                            $('#' + node).attr('checked', true);
                            break;
                        default:
                            $('.' + node + '-checked').prop('disabled', true);
                        }
                        break;
                    case 'time':
                    case 'day':
                        $('#' + node).val( data[ node ] );
                        break;
                    default:
                        $('#' + node).html( data[ node ] );
                    }
                }
            }
        });
        break;
    // administration
    case 'administrator_settings':
        cgiID = 'adminsetting';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                for (var node in data)
                {
                    switch(node)
                    {
                    case 'setPassword':
                    case 'adminOldPwd':
                    case 'adminNewPwd':
                        break;
                    default:
                    
                        $('#'+node).val(data[node]);
                    }
                }                
            }
        });
        break;
    case 'date_and_time':
        // current time
        cgiID = 'getSystime';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                $('#systime').val(data.systime);
            }
        });

        // systime
        cgiID = 'systime';
        $.ajax({
            url: 'cgi-bin/' + cgiID + '.cgi',
            dataType: 'json',
            success: function(data) {
                dataObj[id] = $.extend({}, data);
                
                for (var node in data)
                {
                    switch(node)
                    {
                    case 'mode':
                    case 'ntpServerType':
                        $('input[name=' + node + ']').each(function(){
                            switch(parseInt( $(this).val() ) == parseInt( data[ node ] ) )
                            {
                            case true:
                                $(this).attr('checked', true).trigger('click');
                                break;    
                            }
                        });
                        break;
                    case 'year':
                    case 'month':
                    case 'day':
                    case 'ntpDefaultServer':
                        break;
                    case 'tzName':
                    case 'hour':
                    case 'minute':
                    case 'second':                    
                        $('#' + node).append( genSelectOption( node ) ).val( data[ node ] ).trigger('change');
                        break;
                    case 'dstEnable':
                        if ( parseInt(data[ node ]) == 1)
                            $('#' + node).attr('checked', true);
                        break;
                    default:
                        $('#' + node).val( data[ node ] );
                    }
                }
                
                var sysDate = data.year + '-' +    data.month + '-' + data.day;
                $('#sysDate').val( sysDate );
                $('#sysDate').datepicker({
                    showOn: "button",
                    buttonImage: "css/images/calendar.gif",
                    buttonImageOnly: true,
                    yearRange: "2012:2025",
                    dateFormat: "yy-mm-dd"
                });

            }
        });
        break;
    }
}

function genTable(id) {
    var tableID = '#table-' + id;
     // if not tbody, create one
    var tableBD = tableID + ' > tbody';
    var tableHD = tableID + ' > thead';

    if ($(tableBD).length == 0)
        $(tableID).append('<tbody>');

    $.ajax({
        url: 'data/' + id + '.txt',
        dataType: 'json',
        success: function(data) {
            // for fake data, data.ajaxData used,
            $.each(data.ajaxData, function(key, value) {
                // each row
                var tmp = '<tr class="' + ((key%2==0)? 'odd' : 'even') + '">';
                $(tableID + ' tr th').each(function(index) {
                    // each col

                    var thID = $(this).attr('id');
                    var thClass = $(this).attr('class');
                
                    switch(thClass == undefined)
                    {
                    case true:
                        // no class
                        tmp += '<td>' + value[ thID ] + '</td>';
                        break;
                    case false:
                        regObj = thClass.match(regRowAction);
                        switch(true)
                        {
                        case (regObj != null):
                        $(this).addClass('rowAction BT'+regObj.length);
                        var cnt = 0;
                        tmp += '<td class="buttonTD">';
                        for (var x in regObj){
                            switch(regDigit.test(x))
                            {
                            case true:
                                cnt++;
                                tmp += '<button id="' + regObj[x] + '-' + id + '" class="' + regObj[x] + '"><span class="ui-icon"    title="' + regObj[x] + '"></span></button>';
                                break;
                            }
                        }
                        tmp += '</td>';
                        break;
                        case (regCheckbox.test(thClass)):
                            tmp += '<td class="checkTD"><input type="checkbox" value="' + key + '" /></td>';
                            break;
                        case (regSelect.test(thClass)):
                            tmp += '<td class="selectTD">'
                            tmp += '<select id="' + thID + key + '">';
                            tmp += genSelectOption(thID);
                            tmp += '</select>';
                            tmp += '</td>';
                            break;
                        }
                        break;
                    }
                });

                tmp += '</tr>';
                $(tableBD).append(tmp);
            });
            if ($(tableHD).length > 0)
                $(tableHD + ' tr th').addClass('ui-state-default');
            genTableAction(id);
        }
    });
}

function genForm(id) {
    $.ajax({
        url: 'data/' + id + '.txt',
        dataType: 'json',
        success: function(data) {
            $('#div-' + id + ' input').each(function() {
                var iID = $(this).attr('id');
                switch($('#' + iID).length > 0)
                {
                case true:
                    $(this).attr( 'value', data[iID] );
                    break;
                }
            });
        }
    });
}

function genList(id) {
    $.ajax({
        url: 'data/' + id + '.txt',
        dataType: 'json',
        success: function(data) {
            $('#table-' + id + ' tr').each(function(index) {
                var thID = $(this).find('th').attr('id');
                var tmp = '<td>' + data[ thID ] + '</td>';
                $(this).append(tmp);
            });
    
        }
    });
    switch($('#div-' + id).length > 0)
    {
        case true:
        $(this).addClass('ui-widget-content');
        break;
    }
}

function cgiSelectOption(id, aimID, thisNo) {
    var cgiID;
    var guiID;
    var tmp;
    var tNum;
    var node;
    var sID;
    var sGid;
    switch(id)
    {
    case 'ipsec_policies-wanId':
        cgiID = 'common_wanIf_list';
        guiID = 'guiS2svpnT';
        node    = 'guiWanIfT';
        tNum    = 'guiWanIfTNum';
        sID     = 'wanId';
        tmp     = '<option value="selectOption">Select WAN</option>';
        break;
    case 'ipsec_policies-localNetworkId': 
        cgiID = 'common_addr_list';
        guiID = 'guiS2svpnT';
        node    = 'guiAddrT';
        tNum    = 'guiAddrTNum';
        sID     = 'localNetworkId';
        tmp     = '<option value="selectOption">Select Local Network</option>';
        tmp     += '<option value="cAddr">Create New Local Network</option>';
        break;     
    case 'ipsec_policies-remoteNetworkId':
        cgiID = 'common_addr_list';
        guiID = 'guiS2svpnT';
        node    = 'guiAddrT';
        tNum    = 'guiAddrTNum';
        sID     = 'remoteNetworkId';
        tmp     = '<option value="selectOption">Select Remote Network</option>';
        tmp     += '<option value="cAddr">Create New Remote Network</option>';
        break;
    case 'ipsec_policies-ikePolicyId':
        cgiID = 'ipsecike';
        guiID = 'guiS2svpnT';
        node    = 'guiIpsecikeT';
        tNum    = 'guiIpsecikeTNum';
        sID     = 'ikePolicyId';
        tmp     = '<option value="selectOption">Select IKE Policy</option>';
        break;
    case 'ipsec_policies-transformPolicyId':
        cgiID = 'ipsectransform';
        guiID = 'guiS2svpnT';
        node    = 'guiIpsectransformT';
        tNum    = 'guiIpsectransformTNum';
        sID     = 'transformPolicyId';
        tmp     = '<option value="selectOption">Select Transform Policy</option>';
        break;
    case 'ports-zoneId':
        cgiID = 'common_zoneIf_list';
        guiID = 'guiPortIfT';
        node    = 'guiZoneIfT';
        tNum    = 'guiZoneIfTNum';
        sID     = 'zoneId';
        tmp     = '';
        break;
    case 'vlan_interfaces-interface':
        cgiID = 'common_portIf_list';
        guiID = 'guiVlanIfT';
        node    = 'guiPortIfT';
        tNum    = 'guiPortIfTNum';
        sID     = 'interface';
        tmp     = '';
        break;
    case 'vlan_interfaces-zone':
        cgiID = 'common_zoneIf_list';
        guiID = 'guiVlanIfT';
        node    = 'guiZoneIfT';
        tNum    = 'guiZoneIfTNum';
        sID     = 'zone';
        tmp     = '';
        break;
    case 'lan-zone':
        cgiID = 'common_zoneIf_list';
        guiID = 'guiLanIfT';
        node    = 'guiZoneIfT';
        tNum    = 'guiZoneIfTNum';
        sID     = 'zone';
        tmp     = '';
        break;
    case 'wanIpIfT-zoneId':
        cgiID = 'common_zoneIf_list';
        guiID = 'wanIpIfT';
        node    = 'guiZoneIfT';
        tNum    = 'guiZoneIfTNum';
        sID     = 'zoneId';
        tmp     = '';
        break;

    }
    
    for (var i=0, len= parseInt(cgiList[ cgiID ][ tNum ]); i < len; i++) 
    {
        tmp += '<option value="' + cgiList[ cgiID ][ node ][ i ].gid + '">' + cgiList[ cgiID ][ node ][ i ].name + '</option>';
        if (thisNo) {
            if ( dataObj[ aimID ][ guiID ][ thisNo ][ sID ] == cgiList[ cgiID ][ node ][ i ].gid )
                sGid = cgiList[ cgiID ][ node ][ i ].gid;
        }
    }
    $('#' + id).append(tmp);
    if (thisNo) 
        $('#' + id).val( sGid );
}

function cgiComboSelectOption(id, val) {
    $('#' + id + ' option').remove();
    var tmp = "";
    switch(id)
    {
    
    case 'sourceAddress':
        tmp = '<option value="selectOption">Select Address</option>';
        tmp += '<option value="cAddr">-- Create New Address --</option>';

        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++) {
            if (parseInt(cgiList.common_addr_list.guiAddrT[ i ].type) < 4)
                tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        }
        tmp += '<option value="cGAddr">-- Create New Group Address --</option>';    
        for (var i=0; i < parseInt(cgiList.common_gAddr_list.guiGAddrTNum); i++)    
            tmp += '<option value="' + cgiList.common_gAddr_list.guiGAddrT[ i ].gid + '">' + cgiList.common_gAddr_list.guiGAddrT[ i ].name + '</option>';
        $('#' + id).append( tmp );
        break;
    case 'destinationAddress':
        tmp = '<option value="selectOption">Select Address</option>';
        tmp += '<option value="cAddr">-- Create New Address --</option>';
        
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++) {
            if (parseInt(cgiList.common_addr_list.guiAddrT[ i ].type) < 4)
                tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        }
        tmp += '<option value="cGAddr">-- Create New Group Address --</option>'; 
        for (var i=0; i < parseInt(cgiList.common_gAddr_list.guiGAddrTNum); i++)    
            tmp += '<option value="' + cgiList.common_gAddr_list.guiGAddrT[ i ].gid + '">' + cgiList.common_gAddr_list.guiGAddrT[ i ].name + '</option>';
        $('#' + id).append( tmp );
        break;
    case 'address_exceptions':
        tmp = '<option value="selectOption">Select Address</option>';
        tmp += '<option value="cAddr">-- Create New Address --</option>';

        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++) {
            if (parseInt(cgiList.common_addr_list.guiAddrT[ i ].type) < 4)
                tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        }
        tmp += '<option value="cGAddr">-- Create New Group Address --</option>';
        for (var i=0; i < parseInt(cgiList.common_gAddr_list.guiGAddrTNum); i++)    
            tmp += '<option value="' + cgiList.common_gAddr_list.guiGAddrT[ i ].gid + '">' + cgiList.common_gAddr_list.guiGAddrT[ i ].name + '</option>';
        if (val) {
            $('#sourceAddress').append( tmp ).val( ( (val.srcAddrType == 0)? val.srcAddrGid : val.srcGAddrGid) ).trigger('change');
            $('#destinationAddress').append( tmp ).val( ( (val.dstAddrType == 0)? val.dstAddrGid : val.dstGAddrGid) ).trigger('change');
        }else {
            $('#sourceAddress').append( tmp );
            $('#destinationAddress').append( tmp );
        }
        break;
    case 'ipsec_policies-localNetworkId':     
    case 'ipsec_policies-remoteNetworkId':
        tmp     = '<option value="selectOption">Select Network</option>';
        tmp     += '<option value="cAddr">Create New Network</option>';
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++) {
            if (parseInt(cgiList.common_addr_list.guiAddrT[ i ].type) < 3)
                tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        }
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'advanced_nat-fromIf':
    case 'advanced_nat-toIf':
        var tmp = '<option value="selectOption">Select Interface</option>';
            
        for (var i=0; i < parseInt(cgiList.common_portIf_list.guiPortIfTNum); i++)
            tmp += '<option value="' + cgiList.common_portIf_list.guiPortIfT[ i ].gid + '">' + cgiList.common_portIf_list.guiPortIfT[ i ].name + '</option>';
        for (var i=0; i < parseInt(cgiList.common_lanIf_list.guiLanIfTNum); i++)
            tmp += '<option value="' + cgiList.common_lanIf_list.guiLanIfT[ i ].gid + '">' + cgiList.common_lanIf_list.guiLanIfT[ i ].name + '</option>';
        for (var i=0; i < parseInt(cgiList.common_vlanIf_list.guiVlanIfTNum); i++)
            tmp += '<option value="' + cgiList.common_vlanIf_list.guiVlanIfT[ i ].gid + '">' + cgiList.common_vlanIf_list.guiVlanIfT[ i ].name + '</option>';
        for (var i=0; i < parseInt(cgiList.common_wanIf_list.guiWanIfTNum); i++)
            tmp += '<option value="' + cgiList.common_wanIf_list.guiWanIfT[ i ].gid + '">' + cgiList.common_wanIf_list.guiWanIfT[ i ].name + '</option>';
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'advanced_nat-originalSrc':
    case 'advanced_nat-originalDst':
    case 'advanced_nat-translatedSrc':
    case 'advanced_nat-translatedDst':
        tmp = '<option value="selectOption">Select Address</option>'
        tmp += '<option value="cAddr">-- Create New Address --</option>';
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++) {
            if (parseInt(cgiList.common_addr_list.guiAddrT[ i ].type) < 4)
                tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        }
        
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val());    
        break;
    case 'advanced_nat-originalService':
    case 'advanced_nat-translatedService':
        tmp = '<option value="selectOption">Select Service</option>';
        tmp += '<option value="cService">-- Create New Service --</option>';
        for (var i=0; i < parseInt(cgiList.common_service_list.guiServiceTNum); i++)
            tmp += '<option value="' + cgiList.common_service_list.guiServiceT[ i ].gid + '">' + cgiList.common_service_list.guiServiceT[ i ].name + '</option>';
            
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'port_forwarding-originalService':
    case 'port_forwarding-translatedService':
    
        tmp = '<option value="selectOption">Select Service</option>';
        tmp += '<option value="cService">-- Create New Service --</option>';
        for (var i=0; i < parseInt(cgiList.common_service_list.guiServiceTNum); i++)
            tmp += '<option value="' + cgiList.common_service_list.guiServiceT[ i ].gid + '">' + cgiList.common_service_list.guiServiceT[ i ].name + '</option>';

        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'port_forwarding-privateIp':
        tmp = '<option value="selectOption">Select Address</option>'
        tmp += '<option value="cAddr">-- Create New Address --</option>';
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++)
            tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val());    
        break;
    case 'port_forwarding-wanIpId':
        tmp = '<option value="selectOption">Select Address</option>'
        tmp += '<option value="cAddr">-- Create New Address --</option>';
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++)
            tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val());    
        break;
    case 'static_nat-publicIp':
        tmp = '<option value="selectOption">Select Address</option>'
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++)
            tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val());    
        break;
    case 'static_nat-privateIp':
        tmp = '<option value="selectOption">Select Address</option>'
        tmp += '<option value="cAddr">-- Create New Address --</option>';
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++)
            tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val());    
        break;
    case 'dynamic_pat-addressId':
        tmp = '<option value="selectOption">Select Address</option>'
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++)
            tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'query-fromZone':
    case 'query-toZone':
        tmp = '<option value="selectOption">Select Zone</option>'
        for (var i=0; i < parseInt(cgiList.common_zoneIf_list.guiZoneIfTNum); i++)
            tmp += '<option value="' + cgiList.common_zoneIf_list.guiZoneIfT[ i ].gid + '">' + cgiList.common_zoneIf_list.guiZoneIfT[ i ].name + '</option>';
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'rules-fromZone':
    case 'rules-toZone':
        tmp = '<option value="selectOption">Select Zone</option>'
        for (var i=0; i < parseInt(cgiList.common_zoneIf_list.guiZoneIfTNum); i++)
            tmp += '<option value="' + cgiList.common_zoneIf_list.guiZoneIfT[ i ].gid + '">' + cgiList.common_zoneIf_list.guiZoneIfT[ i ].name + '</option>';
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'rules-sourceAddress':
    case 'rules-destinationAddress':
        tmp = '<option value="selectOption">Select Source Address</option>';
        tmp += '<option value="cAddr">-- Create New Address --</option>';
        
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++) {
            if (parseInt(cgiList.common_addr_list.guiAddrT[ i ].type) < 4)
                tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        }
        tmp += '<option value="cGAddr">-- Create New Group Address --</option>'; 
        for (var i=0; i < parseInt(cgiList.common_gAddr_list.guiGAddrTNum); i++)    
            tmp += '<option value="' + cgiList.common_gAddr_list.guiGAddrT[ i ].gid + '">' + cgiList.common_gAddr_list.guiGAddrT[ i ].name + '</option>';
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'rules-service':
        tmp = '<option value="selectOption">Select Service</option>';
        tmp += '<option value="cService">-- Create New Service --</option>';
        for (var i=0; i < parseInt(cgiList.common_service_list.guiServiceTNum); i++)
            tmp += '<option value="' + cgiList.common_service_list.guiServiceT[ i ].gid + '">' + cgiList.common_service_list.guiServiceT[ i ].name + '</option>';
        tmp += '<option value="cGService">-- Create New Group Service --</option>';
        for (var i=0; i < parseInt(cgiList.common_gService_list.guiGServiceTNum); i++)
            tmp += '<option value="' + cgiList.common_gService_list.guiGServiceT[ i ].gid + '">' + cgiList.common_gService_list.guiGServiceT[ i ].name + '</option>';
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    case 'rules-schedule':
        tmp = '<option value="selectOption">Select Schedule</option>';
        tmp += '<option value="cSchedule">-- Create New Schedule --</option>'
        for (var i=0; i < parseInt(cgiList.common_time_list.guiTimeTNum); i++)
            tmp += '<option value="' + cgiList.common_time_list.guiTimeT[ i ].gid + '">' + cgiList.common_time_list.guiTimeT[ i ].name + '</option>';
        if (val)
            $('#' + id).append(tmp).val(val);
        else
            $('#' + id).append(tmp).val($('#' + id + ' option:first').val()); 
        break;
    }
}

function cgiRecallSelectOption( id ) {
    var cgi;
    switch( id )
    {
    case 'advanced_nat-originalSrc':
    case 'advanced_nat-originalDst':
    case 'advanced_nat-translaedSrc':
    case 'advanced_nat-translatedDst':
        cgi = 'common_addr_list';
        $.ajax({
            url: 'cgi-bin/' + cgi + '.cgi',
            dataType: 'json',
            success: function(data) {
                cgiList[ cgi ] = data;
            }
        }).done( function() {
            cgiComboSelectOption('advanced_nat-originalSrc');
            cgiComboSelectOption('advanced_nat-originalDst');
            cgiComboSelectOption('advanced_nat-translaedSrc');
            cgiComboSelectOption('advanced_nat-translaedDst');
            
        });
        break;
    case 'advanced_nat-originalService':
    case 'advanced_nat-translatedService':
    
        cgi = 'common_service_list';
        $.ajax({
            url: 'cgi-bin/' + cgi + '.cgi',
            dataType: 'json',
            success: function(data) {
                cgiList[ cgi ] = data;
            }
        }).done( function() {
            for (var j=0; j < parseInt( cgiList[ cgi ].guiServiceTNum ); j++) 
                cgiTypes[ cgiList[ cgi ].guiSerivceT[ j ].gid ] = cgiList[ cgi ].guiServiceT[ j ].type;

            cgiComboSelectOption('advanced_nat-originalService');
            cgiComboSelectOption('advanced_nat-translatedService');
            
        });
        break;
    case 'port_forwarding-privateIp':
        cgi = 'common_addr_list';
        $.ajax({
            url: 'cgi-bin/' + cgi + '.cgi',
            dataType: 'json',
            success: function(data) {
                cgiList[ cgi ] = data;
            }
        }).done( function() {
            cgiComboSelectOption('port_forwarding-privateIp');
            
        });
        break;
    case 'port_forwarding-wanIpId':
        cgi = 'common_addr_list';
        $.ajax({
            url: 'cgi-bin/' + cgi + '.cgi',
            dataType: 'json',
            success: function(data) {
                cgiList[ cgi ] = data;
            }
        }).done( function() {
            
            cgiComboSelectOption('port_forwarding-wanIpId');
            
        });
        break;
    case 'port_forwarding-originalService':
    case 'port_forwarding-translatedService':
        cgi = 'common_service_list';
        $.ajax({
            url: 'cgi-bin/' + cgi + '.cgi',
            dataType: 'json',
            success: function(data) {
                cgiList[ cgi ] = data;
            }
        }).done( function() {
            for (var j=0; j < parseInt( cgiList[ cgi ].guiServiceTNum ); j++) 
                cgiTypes[ cgiList[ cgi ].guiSerivceT[ j ].gid ] = cgiList[ cgi ].guiServiceT[ j ].type;

            cgiComboSelectOption('port_forwarding-originalService');
            cgiComboSelectOption('port_forwarding-translatedService');
            
        });
        break;
    case 'static_nat-privateIp':
        cgi = 'common_addr_list';
        $.ajax({
            url: 'cgi-bin/' + cgi + '.cgi',
            dataType: 'json',
            success: function(data) {
                cgiList[ cgi ] = data;
            }
        }).done( function() {
            cgiComboSelectOption('static_nat-privateIp');
            
        });
        break;
    }
}

function genSelectOption(id) {
    var tmp = "";
    switch(id)
    {
    case 'tzName':
        for (var x in cgiRef.systime.tzName)
            tmp += '<option value="' + cgiRef.systime.tzName[x] + '">' + cgiRef.systime.tzName[x] + '</option>';
        break;
        
    case 'startHour':
    case 'endHour':
    case 'hour':
        for (var i=validator.hour.min; i<=validator.hour.max; i++)
            tmp += '<option value="' + i + '">' + i + '</option>';
        break;
    case 'startMin':
    case 'endMin':
    case 'minute':
    case 'second':
        for (var i=validator.minute.min; i<=validator.minute.max; i++)
            tmp += '<option value="' + i + '">' + i + '</option>';
        break;
    // interface
    case 'ports-speed':
        for (var x in cgiRef.port.speed)
            tmp += '<option value="' + x + '">' + cgiRef.port.speed[x] + '</option>';
        break;
    case 'ports-duplex':
        for (var x in cgiRef.port.duplex)
            tmp += '<option value="' + x + '">' + cgiRef.port.duplex[x] + '</option>';
        break;
    case 'guiDhcpsT-dhcpType':
        for (var x in cgiRef.port.dhcpType)
            tmp += '<option value="' + x + '">' + cgiRef.port.dhcpType[x] + '</option>';
        break;
    case 'guiDhcpsT-type':
        for (var x in cgiRef.lan.type)
            tmp += '<option value="' + x + '">' + cgiRef.lan.type[x] + '</option>';
        break;
    case 'vlan_interfaces-interface':
        for (var x in cgiRef.vlan.interface)
            tmp += '<option value="' + cgiRef.vlan.interface[x] + '">' + cgiRef.vlan.interface[x] + '</option>';
        break;
    case 'vlan_interfaces-dhcpType':
        for (var x in cgiRef.vlan.dhcpType)
            tmp += '<option value="' + x + '">' + cgiRef.vlan.dhcpType[x] + '</option>';
        break;
    case 'wanIpIfT-portId':
        for (var i=0; i < parseInt(cgiList.common_portIf_list.guiPortIfTNum); i++)
            tmp += '<option value="' + cgiList.common_portIf_list.guiPortIfT[ i ].gid + '">' + cgiList.common_portIf_list.guiPortIfT[ i ].name + '</option>';
        for (var i=0; i < parseInt(cgiList.common_vlanIf_list.guiVlanIfTNum); i++)
            tmp += '<option value="' + cgiList.common_vlanIf_list.guiVlanIfT[ i ].gid + '">' + cgiList.common_vlanIf_list.guiVlanIfT[ i ].name + '</option>';
        break;
    case 'wanIpIfT-netDetectPingIpId':
    case 'wanIpIfT-netDetectDnsIpId':
        for (var i=0; i < parseInt(cgiList.common_addr_list.guiAddrTNum); i++)
            tmp += '<option value="' + cgiList.common_addr_list.guiAddrT[ i ].gid + '">' + cgiList.common_addr_list.guiAddrT[ i ].name + '</option>';
        break;
    case 'wanIpIfT-wanProto':
        for (var x in cgiRef.wan.wanProto)
            tmp += '<option value="' + x + '">' + cgiRef.wan.wanProto[x] + '</option>';
        break;
    // networking
    case 'ipsec_policies-remoteGwType':
        for (var x in cgiRef.s2svpn.remoteGwType)
            tmp += '<option value="' + x + '">' + cgiRef.s2svpn.remoteGwType[x] + '</option>';
        break;
    case 'ipsec_policies-dpdaction':
        for (var x in cgiRef.s2svpn.dpdaction)
            tmp += '<option value="' + x + '">' + cgiRef.s2svpn.dpdaction[x] + '</option>';
        break;
    // firewall
    case 'port_forwarding-wan':
        for (var x in cgiRef.portForwarding.wan)
            tmp += '<option value="' + x + '">' + cgiRef.portForwarding.wan[x] + '</option>';
        break;
    case 'static_nat-wanInterface':
        for (var x in cgiRef.staticNat.wanInterface)
            tmp += '<option value="' + x + '">' + cgiRef.staticNat.wanInterface[x] + '</option>';
        break;
    case 'rules-matchAction':
        for (var x in cgiRef.rules.matchAction)
            tmp += '<option value="' + x + '">' + cgiRef.rules.matchAction[x] + '</option>';
        break;
    case 'access_control-actionType':
        tmp = '<option value="0">Deny</option>';
        tmp += '<option value="1">Permit</option>';
        break;
    case 'user-groupId':
        for ( var x in dataObj.group.groupListT )
            tmp += '<option value="' + dataObj.group.groupListT[ x ].gid + '">' + dataObj.group.groupListT[ x ].name + '</option>';
        break;
    case 'group-webLoginPriv':
        for (var x in cgiRef.group.webLoginPriv)
            tmp += '<option value="' + x + '">' + cgiRef.group.webLoginPriv[x] + '</option>';
        break;
    case 'addressType1':
        for (var x in cgiRef.address.type)
            tmp += '<option value="' + x + '">' + cgiRef.address.type[x] + '</option>';
        break;
    case 'addressType2':
        for (var x in cgiRef.address.type2)
            tmp += '<option value="' + x + '">' + cgiRef.address.type2[x] + '</option>';
        break;
    case 'addressType3':
        for (var x in cgiRef.address.type3)
            tmp += '<option value="' + x + '">' + cgiRef.address.type3[x] + '</option>';
        break;
    case 'policy':
        tmp = '<option value="0">Deny</option>';
        tmp += '<option value="1">Permit</option>';
        break;
    default:
        tmp = '<option value="0">Permit</option>';
        tmp += '<option value="1">Deny</option>';
    }
    return tmp;
}

function genChart(id) {
    var tmpObj;
    switch(id)
    {
    case 'resource_utilizations':
        $.ajax({
            url: 'data/' + id + '.txt',
            dataType: 'json',
            success: function(data) {
                $('#table-' + id + ' tr').each(function(index) {
                    var thID = $(this).find('th').attr('id');
                    var tmp = '<td><div class="progressDiv ' + thID + '" style="text-align: center"><span class="progressMsg">' + data[ thID ] + '</span></div></td>';
                    $(this).append(tmp);
                    switch(thID)
                    {
                    case 'cpuUtilization':
                    case 'memoryUtilization':
                        $('.'+thID).progressbar({ value: data[ thID ]*100 });
                        break;
                    default:
                        $('.'+thID).progressbar({ value: 55 });
                        break;
                    }
                });
            }
        });
        break;
    default :
        chartID = '#chart-' + id;
        if (hasChart)
        theChart.destroy();
        hasChart = true;
        yui3.io('data/' + id + '.txt', {
            on: {
                complete: function(id, e) {
                    var json = new yui3.JSON.parse(e.responseText);
                    //console.log(json);
                    theChart = new yui3.Chart({
                        categoryKey: "date",
                        dataProvider: json.ajaxData,
                        horizontalGridlines: true,
                        verticalGridlines: true
                    }).render(chartID);
                }
            }
        });
        break;
    }
}

function genTableAction(id) {
    var tableID = '#table-' + id;
    var divID = '#div-' + id;
    var divConfirm =    $(tableID).parents('.Confirm');
    var tableDiv = $(tableID).parents('.tableDiv');
    switch($(tableID).attr('class') != undefined)
    {
    case true:
        var regObj = $(tableID).attr('class').match(regTableAction);
        switch(regObj != null)
        {
        case true:
            var tmp = '<div class="tableAction table-' + id + '">';
            for (var x in regObj) {
                switch(regDigit.test(x))
                {
                case true:
                    tmp += '<button id="' + regObj[x] + '-' + id + '" class="' + regObj[x] + '">';
                    switch(regObj[x])
                    {
                    case 'Create':
                        switch(id)
                        {
                        case 'vlan_interfaces':
                            tmp += 'Create VLAN';
                            break;
                        default:
                            tmp += 'Add';
                        }
                        break;
                    case 'Remove':
                        tmp += 'Delete';
                        break;
                    case 'Disconnects':
                        tmp += 'Disconnect';
                        break;
                    case 'Forces':
                        tmp += 'Force Logout';
                        break;
                    default:
                        tmp += regObj[x];
                    }
                    tmp += '</button>';
                    break;
                }
            }
            tmp += '</div>';
            $(tableDiv).prepend(tmp);
            break;
        }
        break;
    }
}

function getCgiRef(id) {
    switch(id)
    {
        case 'wan':
            getCgiList('common_addr_list');
            getCgiList('common_portIf_list');
            getCgiList('common_vlanIf_list');    
            getCgiList('common_zoneIf_list');        
            break;
        case 'lan':
            getCgiList('common_portIf_list');
            getCgiList('common_vlanIf_list');
            getCgiList('common_zoneIf_list');
            break;
        case 'ports':
            getCgiList('common_zoneIf_list');
            break;
        case 'vlan_interfaces':
            getCgiList('common_portIf_list');
            getCgiList('common_vlanIf_list');
            getCgiList('common_lanIf_list');
            getCgiList('common_zoneIf_list');
            
        case 'zone':
            getCgiList('common_lanIf_list');
            getCgiList('common_portIf_list');
            getCgiList('common_vlanIf_list');
            break;
        case 'ipsec_policies':
            getCgiList('common_wanIf_list');
            getCgiList('common_addr_list');
            getCgiList('ipsecike');
            getCgiList('ipsectransform');
            break;
        case 'rules':
            getCgiList('common_zoneIf_list');
            getCgiList('common_service_list');
            getCgiList('common_gService_list');
            getCgiList('common_addr_list');
            getCgiList('common_gAddr_list');
            getCgiList('common_time_list');
            break;
        case 'advanced_nat':
            getCgiList('common_portIf_list');
            getCgiList('common_lanIf_list');
            getCgiList('common_vlanIf_list');
            getCgiList('common_wanIf_list');
            getCgiList('common_gService_list');
        case 'port_forwarding':
            getCgiList('common_service_list');
        case 'dynamic_pat':
        case 'static_nat':
            getCgiList('common_addr_list');
            break;
        case 'antivirus':
            getCgiList('common_addr_list');
            getCgiList('common_gAddr_list');
            getCgiList('common_zoneIf_list');
            break;
    }

}

function getCgiList(cgi) {
    $.ajax({
        url: 'cgi-bin/' + cgi + '.cgi',
        dataType: 'json',
        success: function(data) {
            cgiList[ cgi ] = data;
        },
        error: function (xhr, ajaxOptions, thrownError) {
                console.log(cgi + ' @ error ');
                console.log(xhr.status);
                console.log(thrownError);
        }
    }).done( function() {
        cgiGids[ cgi ] = {};
        switch(cgi)
        {
        case 'common_service_list':
            for (var j=0; j < parseInt( cgiList[ cgi ].guiServiceTNum ); j++) 
                cgiTypes[ cgiList[ cgi ].guiServiceT[ j ].gid ] = cgiList[ cgi ].guiServiceT[ j ].type;
            break;
        case 'common_addr_list':
            for (var j=0; j < parseInt( cgiList[ cgi ].guiAddrTNum ); j++)
                cgiHash[ cgiList[ cgi ].guiAddrT[ j ].gid ] = cgiList[ cgi ].guiAddrT[ j ].name;
            break;
        case 'common_portIf_list':
            for (var j=0; j < parseInt( cgiList[ cgi ].guiPortIfTNum ); j++) {
                cgiHash[ cgiList[ cgi ].guiPortIfT[ j ].gid ] = cgiList[ cgi ].guiPortIfT[ j ].name;
                cgiGids[ cgi ][ cgiList[ cgi ].guiPortIfT[ j ].gid ] = cgiList[ cgi ].guiPortIfT[ j ].name;
            }
            break;
        case 'common_lanIf_list':
            for (var j=0; j < parseInt( cgiList[ cgi ].guiLanIfTNum ); j++) 
                cgiHash[ cgiList[ cgi ].guiLanIfT[ j ].gid ] = cgiList[ cgi ].guiLanIfT[ j ].name;
            break;
        case 'common_vlanIf_list':
            for (var j=0; j < parseInt( cgiList[ cgi ].guiVlanIfTNum ); j++) {
                cgiHash[ cgiList[ cgi ].guiVlanIfT[ j ].gid ] = cgiList[ cgi ].guiVlanIfT[ j ].name;
                cgiGids[ cgi ][ cgiList[ cgi ].guiVlanIfT[ j ].gid ] = cgiList[ cgi ].guiVlanIfT[ j ].name;
            }
            break;
        case 'common_zoneIf_list':
            for (var j=0; j < parseInt( cgiList[ cgi ].guiZoneIfTNum ); j++) 
                cgiHash[ cgiList[ cgi ].guiZoneIfT[ j ].gid ] = cgiList[ cgi ].guiZoneIfT[ j ].name;
            break; 
        }
    });
}

function switchSchedule(days, boo) {
    var arr;
    switch(boo)
    {
    case true:
        arr = [];
        while(days > 0) {
            switch(true)
            {
            case (days >= 64):
                days -= 64;
                arr.push(cgiRef[ id ][ thID ]["64"]);
                break;
            case (days >= 32):
                days -= 32;
                arr.push(cgiRef[ id ][ thID ]["32"]);
                break;
            case (days >= 16):
                days -= 16;
                arr.push(cgiRef[ id ][ thID ]["16"]);
                break;
            case (days >= 8):
                days -= 8;
                arr.push(cgiRef[ id ][ thID ]["8"]);
                break;
            case (days >= 4):
                days -= 4;
                arr.push(cgiRef[ id ][ thID ]["4"]);
                break;
            case (days >= 2):
                days -= 2;
                arr.push(cgiRef[ id ][ thID ]["2"]);
                break;
            case (days >= 1):
                days -= 1;
                arr.push(cgiRef[ id ][ thID ]["1"]);
                break;
            }
        }
        break;
    case false:
        arr = [];
        while(days > 0) {
            switch(true)
            {
            case (days >= 64):
                days -= 64;
                arr.push(64);
                break;
            case (days >= 32):
                days -= 32;
                arr.push(32);
                break;
            case (days >= 16):
                days -= 16;
                arr.push(16);
                break;
            case (days >= 8):
                days -= 8;
                arr.push(8);
                break;
            case (days >= 4):
                days -= 4;
                arr.push(4);
                break;
            case (days >= 2):
                days -= 2;
                arr.push(2);
                break;
            case (days >= 1):
                days -= 1;
                arr.push(1);
                break;
            }
        }
        break;
    }
    return arr;
}

ifLogin();

});

</script>

</head>
<!--<body class="cssreset">-->
<body>

<script type="text/javascript">

function launchYUI() {
/* chart */
yui3 = YUI().use('charts', 'io-base', 'json', 'json-parse', 'json-stringify', 'yui');

}

/* ip calc */ 

/* obj */
function calcNWbits(_obj)
{
    sumofbits=0;
    tmpvar = parseInt(_obj.snm_1,10);
    if (isNaN(tmpvar)){
        _obj.result = 'invalid';
        return;
    }
    bitsfromleft=h_countbitsfromleft(tmpvar);
    if (isNaN(bitsfromleft)){
        _obj.result = 'invalid';
        return;
    }
    sumofbits+=bitsfromleft;
    //
    tmpvar = parseInt(_obj.snm_2,10);
    if (isNaN(tmpvar)){
        _obj.result = 'invalid';
        return;
    }
    bitsfromleft=h_countbitsfromleft(tmpvar);
    if (isNaN(bitsfromleft)){
        _obj.result = 'invalid';
        return;
    }
    sumofbits+=bitsfromleft;
    //
    tmpvar = parseInt(_obj.snm_3,10);
    if (isNaN(tmpvar)){
        _obj.result = 'invalid';
        return;
    }
    bitsfromleft=h_countbitsfromleft(tmpvar);
    if (isNaN(bitsfromleft)){
        _obj.result = 'invalid';
        return;
    }
    sumofbits+=bitsfromleft;
    //
    tmpvar = parseInt(_obj.snm_4,10);
    if (isNaN(tmpvar)){
        _obj.result = 'invalid';
        return;
    }
    bitsfromleft=h_countbitsfromleft(tmpvar);
    if (isNaN(bitsfromleft)){
        _obj.result = 'invalid';
        return;
    }
    sumofbits+=bitsfromleft;
    _obj.result = sumofbits;
}

function calcNWmask(_obj)
{
    tmpvar = parseInt(_obj.bits,10);
    if (isNaN(tmpvar) || tmpvar > 32 || tmpvar < 0){
        _obj.snm_1 = 'ERR';
        _obj.snm_2="";
        _obj.snm_3="";
        _obj.snm_4="";
        return(1);
    }
    _obj.snm_1=0;
    _obj.snm_2=0;
    _obj.snm_3=0;
    _obj.snm_4=0;
    if (tmpvar >= 8){
        _obj.snm_1 = 255;
        tmpvar-=8;
    }else{
        _obj.snm_1 = h_fillbitsfromleft(tmpvar);
        return(0);
    }
    if (tmpvar >= 8){
        _obj.snm_2 = 255;
        tmpvar-=8;
    }else{
        _obj.snm_2 = h_fillbitsfromleft(tmpvar);
        return(0);
    }
    if (tmpvar >= 8){
        _obj.snm_3 = 255;
        tmpvar-=8;
    }else{
        _obj.snm_3 = h_fillbitsfromleft(tmpvar);
        return(0);
    }
    _obj.snm_4 = h_fillbitsfromleft(tmpvar);
    return(0);
}

function calcNWmaskForm2(_obj)
{
    var rt=0;
    _obj.hex_1="";
    _obj.hex_2="";
    _obj.hex_3="";
    _obj.hex_4="";
    rt=calcNWmask(_obj);
    if (rt !=0 ){
        // error
        return(1);
    }
    tmpvar=_obj.snm_1;
    _obj.hex_1 = h_paddto2(h_from10toradix(tmpvar,16));
    tmpvar=_obj.snm_2;
    _obj.hex_2 = h_paddto2(h_from10toradix(tmpvar,16));
    tmpvar=_obj.snm_3;
    _obj.hex_3 = h_paddto2(h_from10toradix(tmpvar,16));
    tmpvar=_obj.snm_4;
    _obj.hex_4 = h_paddto2(h_from10toradix(tmpvar,16));
    
    return _obj;
}

function calcBinBits(_obj)
{
    _obj.bits_1="";
    _obj.bits_2="";
    _obj.bits_3="";
    _obj.bits_4="";
    //
    tmpvar = parseInt(_obj.ip_1,10);
    if (isNaN(tmpvar) || tmpvar < 0 || tmpvar > 255){
        _obj.bits_1 = 'ERR';
        return;
    }
    _obj.bits_1 = h_paddto8(h_from10toradix(tmpvar,2));
    _obj.hex_1 = h_paddto2(h_from10toradix(tmpvar,16));
    //
    tmpvar = parseInt(_obj.ip_2,10);
    if (isNaN(tmpvar) || tmpvar < 0 || tmpvar > 255){
        _obj.bits_2 = 'ERR';
        return;
    }
    _obj.bits_2 = h_paddto8(h_from10toradix(tmpvar,2));
    _obj.hex_2 = h_paddto2(h_from10toradix(tmpvar,16));
    //
    tmpvar = parseInt(_obj.ip_3,10);
    if (isNaN(tmpvar)    || tmpvar < 0 || tmpvar > 255){
        _obj.bits_3 = 'ERR';
        return;
    }
    _obj.bits_3 = h_paddto8(h_from10toradix(tmpvar,2));
    _obj.hex_3 = h_paddto2(h_from10toradix(tmpvar,16));
    //
    tmpvar = parseInt(_obj.ip_4,10);
    if (isNaN(tmpvar) || tmpvar < 0 || tmpvar > 255){
        _obj.bits_4 = 'ERR';
        return;
    }
    _obj.bits_4 = h_paddto8(h_from10toradix(tmpvar,2));
    _obj.hex_4 = h_paddto2(h_from10toradix(tmpvar,16));
    return _obj;
}

function calcNBFL(_obj) {
    var rt=0;
    tmpvar = parseInt(_obj.ip_1,10);
    if (isNaN(tmpvar) || tmpvar > 255 || tmpvar < 0){
        _obj.numofaddr = 'ERR';
        return(1);
    }
    tmpvar = parseInt(_obj.ip_2,10);
    if (isNaN(tmpvar) || tmpvar > 255 || tmpvar < 0){
        _obj.numofaddr = 'ERR';
        return(1);
    }
    tmpvar = parseInt(_obj.ip_3,10);
    if (isNaN(tmpvar) || tmpvar > 255 || tmpvar < 0){
        _obj.numofaddr = 'ERR';
        return(1);
    }
    tmpvar = parseInt(_obj.ip_4,10);
    if (isNaN(tmpvar) || tmpvar > 255 || tmpvar < 0){
        _obj.numofaddr = 'ERR';
        return(1);
    }
    rt=calcNWmask(_obj);
    if (rt !=0 ){
        // error
        return(1);
    }
    tmpvar=parseInt(_obj.bits,10);
    if (tmpvar <0){
        _obj.numofaddr = 'ERR';
        return(1);
    }
    if (tmpvar >32){
        _obj.numofaddr = 'ERR';
        return(1);
    }
    if (tmpvar == 31){
        _obj.numofaddr = "two";
        _obj.firstadr_1 = _obj.ip_1 & _obj.snm_1;
        _obj.firstadr_2 = _obj.ip_2 & _obj.snm_2;
        _obj.firstadr_3 = _obj.ip_3 & _obj.snm_3;
        _obj.firstadr_4 = _obj.ip_4 & _obj.snm_4;
        //
        _obj.lastadr_1 = _obj.ip_1 | (~ _obj.snm_1 & 0xff);
        _obj.lastadr_2 = _obj.ip_2 | (~ _obj.snm_2 & 0xff);
        _obj.lastadr_3 = _obj.ip_3 | (~ _obj.snm_3 & 0xff);
        _obj.lastadr_4 = _obj.ip_4 | (~ _obj.snm_4 & 0xff);
        return(1);
    }
    if (tmpvar == 32){
        _obj.numofaddr = "one";
        _obj.firstadr_1 = _obj.ip_1;
        _obj.firstadr_2 = _obj.ip_2;
        _obj.firstadr_3 = _obj.ip_3;
        _obj.firstadr_4 = _obj.ip_4;
        
        _obj.lastadr_1 =    _obj.firstadr_1;
        _obj.lastadr_2 =    _obj.firstadr_2;
        _obj.lastadr_3 =    _obj.firstadr_3;
        _obj.lastadr_4 =    _obj.firstadr_4;

        return(1);
    }
    _obj.numofaddr = Math.pow(2,32 - tmpvar) - 2;
    //
    _obj.bcast_1 = _obj.ip_1 | (~ _obj.snm_1 & 0xff);
    _obj.bcast_2 = _obj.ip_2 | (~ _obj.snm_2 & 0xff);
    _obj.bcast_3 = _obj.ip_3 | (~ _obj.snm_3 & 0xff);
    _obj.bcast_4 = _obj.ip_4 | (~ _obj.snm_4 & 0xff);
    //
    _obj.nwadr_1 = _obj.ip_1 & _obj.snm_1;
    _obj.nwadr_2 = _obj.ip_2 & _obj.snm_2;
    _obj.nwadr_3 = _obj.ip_3 & _obj.snm_3;
    _obj.nwadr_4 = _obj.ip_4 & _obj.snm_4;
    //
    _obj.firstadr_1 = _obj.nwadr_1;
    _obj.firstadr_2 = _obj.nwadr_2;
    _obj.firstadr_3 = _obj.nwadr_3;
    _obj.firstadr_4 = parseInt(_obj.nwadr_4) + 1;
    //
    _obj.lastadr_1 = _obj.bcast_1;
    _obj.lastadr_2 = _obj.bcast_2;
    _obj.lastadr_3 = _obj.bcast_3;
    _obj.lastadr_4 = parseInt(_obj.bcast_4) - 1;
    return(0);
}

function calcNeeded(_obj){
    tmpvar = parseInt(_obj.numofaddr,10);
    if (isNaN(tmpvar) || tmpvar > 0xfffffffe || tmpvar < 1){
        _obj.bits="ERR";
        _obj.snm_1="";
        _obj.snm_2="";
        _obj.snm_3="";
        _obj.snm_4="";
        _obj.maxaddr="";
        return;
    }
    expval=parseInt(Math.log(tmpvar)/Math.log(2)) + 1;
    maxaddrval=Math.pow(2,expval);
    if (maxaddrval - tmpvar < 2){
        expval+=1;
    }
    _obj.maxaddr= Math.pow(2,expval) - 2;
    _obj.bits=32 - expval;
    calcNWmask(_obj);
}
    
//--------------------------
function calcAmount(_obj){
    tmpvar = parseInt(_obj.bits,10);
    if (isNaN(tmpvar) || tmpvar > 30 || tmpvar < 0){
        _obj.numofaddr = 'ERR';
        _obj.maxaddr="";
        _obj.snm_1="";
        _obj.snm_2="";
        _obj.snm_3="";
        _obj.snm_4="";
        return;
    }
    _obj.maxaddr=Math.pow(2,32 - tmpvar);
    _obj.numofaddr=Math.pow(2,32 - tmpvar)- 2;
    calcNWmask(_obj);
}

function calcIpInvert(_obj){
    _obj.invert_1="";
    _obj.invert_2="";
    _obj.invert_3="";
    _obj.invert_4="";
    //
    tmpvar = parseInt(_obj.ip_1,10);
    if (isNaN(tmpvar) ){
        _obj.invert_1 = 'NaN';
        return;
    }
    _obj.invert_1 = 0xff & ~ tmpvar;
    //
    tmpvar = parseInt(_obj.ip_2,10);
    if (isNaN(tmpvar) ){
        _obj.invert_2 = 'NaN';
        return;
    }
    _obj.invert_2 = 0xff & ~ tmpvar;
    //
    tmpvar = parseInt(_obj.ip_3,10);
    if (isNaN(tmpvar) ){
        _obj.invert_3 = 'NaN';
        return;
    }
    _obj.invert_3 = 0xff & ~ tmpvar;
    //
    tmpvar = parseInt(_obj.ip_4,10);
    if (isNaN(tmpvar) ){
        _obj.invert_4 = 'NaN';
        return;
    }
    _obj.invert_4 = 0xff & ~ tmpvar;
}

function convertnum_hex(_obj){
    _obj.dec_1="";
    _obj.bin_1="";
    //
    tmpvar=_obj.num.replace(/0x/i,"");
    _obj.num=tmpvar;
    tmpvar = parseInt(_obj.num,16);
    if (isNaN(tmpvar) ){
        _obj.dec_1 = 'NaN';
        _obj.bin_1 = 'NaN';
        return;
    }
    _obj.dec_1 = tmpvar;
    _obj.bin_1 = h_from10toradix(tmpvar,2);
}

function convertnum_bin(_obj){
    _obj.dec_1="";
    _obj.hex_1="";
    //
    tmpvar = parseInt(_obj.num,2);
    if (isNaN(tmpvar) ){
        _obj.dec_1 = 'NaN';
        _obj.hex_1 = 'NaN';
        return;
    }
    _obj.dec_1 = tmpvar;
    _obj.hex_1 = h_from10toradix(tmpvar,16);
}

function convertnum_dec(_obj){
    _obj.bin_1="";
    _obj.hex_1="";
    //
    tmpvar = parseInt(_obj.num,10);
    if (isNaN(tmpvar) ){
        _obj.bin_1 = 'NaN';
        _obj.hex_1 = 'NaN';
        return;
    }
    _obj.hex_1 = h_from10toradix(tmpvar,16);
    _obj.bin_1 = h_from10toradix(tmpvar,2);
}

function dot2hex(_obj){
    _obj.ip_1="";
    _obj.ip_2="";
    _obj.ip_3="";
    _obj.ip_4="";
    _obj.bits_1="";
    _obj.bits_2="";
    _obj.bits_3="";
    _obj.bits_4="";
    tmpvar=_obj.hex.replace(/0x/i,"");
    _obj.hex=tmpvar.substr(0,8);
    //
    tmpvar = parseInt(tmpvar,16);
    if (isNaN(tmpvar)){
        _obj.ip_1 = 'ERR';
        return;
    }
    _obj.hex = h_paddto8(_obj.hex);
    _obj.ip_1 = parseInt(_obj.hex.substr(0,2),16);
    _obj.bits_1=h_paddto8(h_from10toradix(_obj.ip_1,2));
    _obj.ip_2 = parseInt(_obj.hex.substr(2,2),16);
    _obj.bits_2=h_paddto8(h_from10toradix(_obj.ip_2,2));
    _obj.ip_3 = parseInt(_obj.hex.substr(4,2),16);
    _obj.bits_3=h_paddto8(h_from10toradix(_obj.ip_3,2));
    _obj.ip_4 = parseInt(_obj.hex.substr(6,2),16);
    _obj.bits_4=h_paddto8(h_from10toradix(_obj.ip_4,2));
}

/* form use */
function h_initArray() {
    this.length = h_initArray.arguments.length;
    for (var i = 0; i < this.length; i++)
        this[i] = h_initArray.arguments[i];
}
    
function h_from10toradix(value,radix){
    var retval = '';
    var ConvArray = new h_initArray(0,1,2,3,4,5,6,7,8,9,'A','B','C','D','E','F');
    var intnum;
    var tmpnum;
    var i = 0;

    intnum = parseInt(value,10);
    if (isNaN(intnum)){
        retval = 'NaN';
    }else{
        if (intnum < 1){
            retval ="0";
        }else{
            retval = "";
        }
        while (intnum > 0.9){
            i++;
            tmpnum = intnum;
            // cancatinate return string with new digit:
            retval = ConvArray[tmpnum % radix] + retval;    
            intnum = Math.floor(tmpnum / radix);
            if (i > 100){
                // break infinite loops
                retval = 'NaN';
                break;
            }
        }
    }
    return retval;
}

function h_paddto2(str) {
    while(str.length <2){
        str= "0" + str;
    }
    return(str);
}

function h_paddto8(str) {
    while(str.length <8){
        str= "0" + str;
    }
    return(str);
}

//--------------------------

function h_countbitsfromleft(num)
{
    if (num == 255 ){
        return(8);
    }
    i = 0;
    bitpat=0xff00; 
    while (i < 8){
        if (num == (bitpat & 0xff)){
            return(i);
        }
        bitpat=bitpat >> 1;
        i++;
    }
    return(Number.NaN);
}

//--------------------------

function h_fillbitsfromleft(num)
{
    if (num >= 8 ){
        return(255);
    }
    bitpat=0xff00; 
    while (num > 0){
        bitpat=bitpat >> 1;
        num--;
    }
    return(bitpat & 0xff);
}

//--------------------------


</script>

</body>
</html>

